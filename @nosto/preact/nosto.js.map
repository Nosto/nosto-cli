{
  "version": 3,
  "sources": ["../src/index.ts", "../src/config.ts", "../../node_modules/@nosto/nosto-js/dist/settings-DN0V2st5.js", "../../node_modules/@nosto/nosto-js/dist/index.es.js", "../src/api/nosto.ts", "../src/hooks/useConfig.ts", "../../node_modules/@nosto/search-js/dist/index.es-B8mbAxS4.js", "../../node_modules/@nosto/search-js/dist/logger-DVwg4Wor.js", "../../node_modules/@nosto/search-js/dist/deepMerge-CZwCJzEe.js", "../../node_modules/@nosto/search-js/dist/unique-m1TIDWdl.js", "../../node_modules/@nosto/search-js/dist/parseNumber-QA48nJLp.js", "../../node_modules/@nosto/search-js/dist/pick-DReBictn.js", "../../node_modules/@nosto/search-js/dist/utils/utils.es.js", "../src/utils/pipe.ts", "../src/utils/isPlainObject.ts", "../src/utils/ensureArray.ts", "../src/urlEncoding/createMapperOptions.tsx", "../src/urlEncoding/url.ts", "../src/helpers/storage.ts", "../src/helpers/errorHandling.ts", "../src/helpers/dom.ts", "../src/helpers/searchFallback.ts", "../../node_modules/@nosto/search-js/dist/configContext-GuZOIX3o.js", "../../node_modules/@nosto/search-js/dist/useLoadMore-Der8Cglb.js", "../../node_modules/@nosto/search-js/dist/search-BrR80UbS.js", "../../node_modules/@nosto/search-js/dist/jsxRuntime.module-Bzuv3cXw.js", "../../node_modules/@nosto/search-js/dist/InfiniteScrollWithObserver-DYKAh87P.js", "../src/actions.ts", "../../node_modules/@nosto/search-js/dist/preact/common.es.js", "../src/hooks/useStore.ts", "../../node_modules/@nosto/search-js/dist/preact/hooks.es.js", "../src/hooks/useActions.ts", "../src/hooks/useAppStateSelector.ts", "../src/hooks/useAppState.ts", "../src/hooks/usePagination.ts", "../src/hooks/useProductFilters.ts", "../src/hooks/useRangeSelector.ts", "../src/hooks/useRange.ts", "../src/hooks/useFacet.ts", "../src/hooks/useSelectedFiltersCount.ts", "../src/hooks/useSort.ts", "../src/hooks/useSizeOptions.ts", "../src/hooks/useFacets.ts", "../src/hooks/useResponse.ts", "../src/hooks/useSimplePagination.ts", "../src/hooks/useLoadMore.ts", "../src/hooks/useDispatchEventOnLoad.ts", "../src/hooks/useCurrencyFormatting.ts", "../../node_modules/@nosto/search-js/dist/currencies/currencies.es.js", "../src/state.tsx", "../../node_modules/@nosto/search-js/dist/preact/serp.es.js", "../../node_modules/@nosto/search-js/dist/BaseElement-IyqEeIiJ.js", "../../node_modules/@nosto/search-js/dist/baseConfig-Bafl02NY.js", "../../node_modules/@nosto/search-js/dist/preact/category.es.js", "../../node_modules/@nosto/search-js/dist/preact/autocomplete.es.js", "../src/autocomplete/initAutocomplete.tsx", "../src/helpers/resolveCssSelector.ts", "../src/helpers/input.ts", "../src/autocomplete/components/AutocompleteElement.tsx", "../src/helpers/ga.ts", "../src/autocomplete/components/Context.ts", "../src/autocomplete/components/HistoryElement.tsx", "../src/components/ErrorBoundary.tsx", "../src/utils/debounce.ts", "../src/helpers/selectors.ts", "../src/helpers/ensureNumbers.ts", "../src/serp/render.tsx", "../src/utils/wait.ts", "../src/serp/index.tsx", "../src/urlEncoding/expandMapping.ts", "../src/urlEncoding/flattenMapping.ts", "../src/urlEncoding/createMapper.ts", "../src/urlEncoding/utils/valueEncoding.ts", "../src/urlEncoding/mappers/filterEncoding.ts", "../src/urlEncoding/mappers/compressFilterParameters.ts", "../src/urlEncoding/mappers/compressSortParameters.ts", "../src/urlEncoding/mappers/mapOffsetToPage.ts", "../src/urlEncoding/defaultMappers.ts", "../src/fullConfig.ts", "../src/setup.tsx", "../src/autocomplete/components/KeywordInCategory.tsx", "../src/autocomplete/components/Keywords.tsx", "../src/autocomplete/components/KeywordsInCategory.tsx", "../src/autocomplete/components/KeywordWrapper.tsx", "../src/components/AbstractSlider.tsx", "../src/helpers/classjoin.ts", "../src/components/utils.ts", "../src/components/Marks.tsx", "../src/components/Steps.tsx", "../src/components/Handle.tsx", "../src/components/MultiSlider.tsx", "../src/components/Track.tsx", "../src/components/RangeSlider.tsx", "../src/components/InfiniteScroll.tsx", "../src/components/SerpElement.tsx", "../src/helpers/attribution.ts", "../src/sorting.ts", "../src/formatting/formatting.ts", "../src/utils/groupBy.ts", "../../node_modules/@nosto/search-js/dist/thumbnails/thumbnails.es.js"],
  "sourcesContent": ["/* eslint-disable barrel-files/avoid-re-export-all */\n/* eslint-disable barrel-files/avoid-barrel-files */\nexport * from \"./hooks\"\nexport * from \"./api/types\"\nexport { speechToTextSupported, useSpeechToText } from \"@nosto/search-js/preact/hooks\"\nexport { createStore, StoreContext, type State } from \"./state\"\nexport { SearchPageProvider } from \"@nosto/search-js/preact/serp\"\nexport { CategoryPageProvider } from \"@nosto/search-js/preact/category\"\nexport { AutocompletePageProvider } from \"@nosto/search-js/preact/autocomplete\"\nexport { init } from \"./setup\"\nexport type { Config, FullConfig } from \"./config\"\nexport * from \"./autocomplete\"\nexport * from \"./components\"\nexport { reportClick } from \"./helpers/attribution\"\nexport type { CssSelector } from \"./helpers/resolveCssSelector\"\nexport { pick } from \"@nosto/search-js/utils\"\nexport { waitForElement, type DelayOptions } from \"./utils/wait\"\nexport { default as mapOffsetToPage } from \"./urlEncoding/mappers/mapOffsetToPage\"\nexport { default as compressFilterParameters } from \"./urlEncoding/mappers/compressFilterParameters\"\nexport { default as compressSortParameters } from \"./urlEncoding/mappers/compressSortParameters\"\nexport * from \"./urlEncoding/types\"\nexport { createSortOption, type SortOption } from \"./sorting\"\nexport * from \"./formatting/formatting\"\nexport { default as groupBy, type GroupsType } from \"./utils/groupBy\"\nexport { thumbnailDecorator, shopifyThumbnailDecorator } from \"@nosto/search-js/thumbnails\"\nexport { priceDecorator } from \"@nosto/search-js/currencies\"\n", "import { ComponentType, createContext } from \"preact\"\nimport { PageType, QueryProvider, SearchQuery } from \"./api\"\nimport { tagging } from \"./api/nosto\"\nimport { MapperOptions } from \"./urlEncoding/types\"\nimport { CssSelector } from \"./helpers/resolveCssSelector\"\nimport { HitDecorator } from \"@nosto/search-js\"\nimport { AutocompleteOptions } from \"./autocomplete\"\nimport { SerpConfig } from \"@nosto/search-js/preact/serp\"\n\nexport const defaultConfig = {\n    autocompleteMinLength: 2,\n    historyEnabled: true,\n    historySize: 5,\n    serpUrlMapping: {\n        name: \"name\",\n        query: \"query\",\n        \"product.personalizationBoost\": \"aff\",\n        segments: \"segments\",\n        customRules: \"customRules\",\n        explain: \"explain\",\n        time: \"time\",\n        products: \"products\",\n        keywords: \"keywords\"\n    },\n    defaultCurrency: \"EUR\",\n    serpPathRedirect: false,\n    categoryId: () => tagging.categoryId(),\n    categoryPath: () => tagging.categoryPath(),\n    variationId: () => tagging.variation(),\n    // FIXME this default implementation relies on a deprecated config property\n    categoryQuery(this: Config) {\n        return {\n            products: {\n                categoryId: this.categoryId!(),\n                categoryPath: this.categoryPath!(),\n                size: this.serpSize,\n                from: 0\n            }\n        }\n    },\n    isCategoryPage: () => tagging.pageType() === \"category\",\n    compressUrlParameters: false,\n    debounceDelay: 300,\n    persistentSearchCache: false,\n    memoryCache: false,\n    preservePageScroll: false,\n    queryModifications: query => query,\n    hitDecorators: [],\n    retries: 3,\n    retryInterval: 500,\n    speechToTextEnabled: false\n} satisfies Partial<Config>\n\n/**\n * User provided configuration\n */\nexport interface Config {\n    /**\n     * CSS selector for each input element to bind search events like input change and form submit.\n     */\n    inputCssSelector?: string\n\n    /**\n     * CSS selector for autocomplete dropdown render.\n     * Leave undefined for default use (After input element)\n     */\n    dropdownCssSelector?: CssSelector\n\n    /**\n     * CSS selector for search page rendering.\n     */\n    contentCssSelector?: string\n\n    /**\n     * CSS selector for category content rendering\n     */\n    categoryCssSelector?: string\n\n    /**\n     * Determine if current page is category\n     * Example: return location.pathname.includes('category')\n     */\n    isCategoryPage?: () => boolean\n\n    /**\n     * Default category page query parameters. Supplied as an object or a function that returning search query\n     * Functional version can be use for building complex category queries. It's more flexible and provides access to other config parameters.\n     * @example\n     * as object:\n     *\n     * categoryQuery: {\n     *   products: {\n     *      facets: [\"*\"],\n     *      fields: [\"variantId\", \"availability\", ....]\n     *      ...\n     *   }\n     * }\n     *\n     * @example\n     * as function:\n     *\n     * categoryQuery() {\n     *   return {\n     *      products: {\n     *         facets: [\"*\"],\n     *         fields: [\"variantId\", \"availability\", ....]\n     *         variationId: this.variationId()\n     *         ...\n     *      }\n     *   }\n     * }\n     */\n    categoryQuery?: QueryProvider\n\n    /**\n     * returns current category id\n     * @deprecated no need to provide this as the builtin logic is usually more reliable\n     */\n    categoryId?: () => string | undefined\n    /**\n     * returns current category path\n     * @deprecated no need to provide this as the builtin logic is usually more reliable\n     */\n    categoryPath?: () => string | undefined\n    /**\n     * return current variation id, can be supplying for supplying multi-currency and B2B variations\n     * @deprecated no need to provide this as the builtin logic is usually more reliable\n     */\n    variationId?: () => string | undefined\n    /**\n     * Category root component\n     */\n    categoryComponent?: ComponentType\n    /**\n     * CSS selector for form to unbind it.\n     */\n    formCssSelector: string\n    /**\n     * Form unbind delay after how long it should delay, default is unbinding without delay ms\n     */\n    formUnbindDelay?: number\n    /**\n     * Merchant ID.\n     */\n    merchant: string\n    /**\n     * Merchant's default Currency.\n     */\n    defaultCurrency: string\n\n    /**\n     * Default search page query parameters. Supplied as an object or a function that returning search query\n     * Functional version can be use for building complex search queries. It's more flexible and provides access to other config parameters.\n     * @example\n     * as object:\n     *\n     * serpQuery: {\n     *   products: {\n     *      facets: [\"*\"],\n     *      fields: [\"variantId\", \"availability\", ....]\n     *      ...\n     *   }\n     * }\n     *\n     * @example\n     * as function:\n     *\n     * serpQuery() {\n     *   return {\n     *      products: {\n     *         facets: [\"*\"],\n     *         fields: [\"variantId\", \"availability\", ....]\n     *         variationId: this.variationId()\n     *         ...\n     *      }\n     *   }\n     * }\n     */\n    serpQuery?: QueryProvider\n\n    /**\n     * Preact search page main component.\n     */\n    serpComponent?: ComponentType\n\n    /**\n     * Search page path, renders in any page if not specified\n     */\n    serpPath?: string\n\n    /**\n     * Indicates if search should redirect to search page or just rewrite history\n     *\n     * In case a function is provided, it will be called with the query object and autocomplete options.\n     */\n    serpPathRedirect?: boolean | ((query: SearchQuery, options: AutocompleteOptions | undefined) => void)\n\n    /**\n     * Preact autocomplete main component\n     */\n    autocompleteComponent?: ComponentType\n\n    /**\n     * Default autocomplete page query parameters. Supplied as an object or a function that returning search query\n     * Functional version can be use for building complex autocomplete queries. It's more flexible and provides access to other config parameters.\n     * @example\n     * as object:\n     *\n     * autocompleteQuery: {\n     *   products: {\n     *      facets: [\"*\"],\n     *      fields: [\"variantId\", \"availability\", ....]\n     *      ...\n     *   }\n     * }\n     *\n     * @example\n     * as function:\n     *\n     * autocompleteQuery() {\n     *   return {\n     *      products: {\n     *         facets: [\"*\"],\n     *         fields: [\"variantId\", \"availability\", ....]\n     *         variationId: this.variationId()\n     *         ...\n     *      }\n     *   }\n     * }\n     */\n    autocompleteQuery?: QueryProvider\n\n    /**\n     * Minimal input length to render autocomplete\n     *\n     * @default 2\n     */\n    autocompleteMinLength?: number\n\n    /**\n     * Front end URL both ways mapping, to convert URL param values and keep the request keys\n     * {\n     *    query: 'q' - will map query param to appear as q in URL\n     *    product.filters: 'ff' - will map to ff.0.field.0: 'brand' and so on..\n     *    product.size: 'size' - will map to size: 24\n     * }\n     */\n    serpUrlMapping?: Record<string, string>\n\n    /**\n     * @hidden Custom URL parameters encodings and decoding. Used for backward compatibility\n     */\n    customUrlMappings?: {\n        encode(query: unknown, options: MapperOptions): unknown\n        decode(query: unknown, options: MapperOptions): unknown\n    }[]\n\n    /**\n     * Indicates if URL parameters should be compressed.\n     * If enabled, default range separator is '~'.\n     *\n     * @example\n     * as boolean\n     *\n     * compressUrlParameters: true\n     *\n     * @example\n     * as object\n     * compressUrlParameters: {\n     *   filterRangeSeparator: \"~\"\n     * }\n     *\n     * @default false\n     */\n    compressUrlParameters: boolean | Partial<MapperOptions>\n\n    /**\n     * Indicates if history should be enabled\n     *\n     * @default true\n     */\n    historyEnabled?: boolean\n\n    /**\n     * History component\n     */\n    historyComponent?: ComponentType\n\n    /**\n     * Speech to text component\n     */\n    speechToTextComponent?: ComponentType<{\n        /**\n         * Callback to be called when speech to text input is submitted\n         */\n        onSubmit: (value: string) => void\n    }>\n\n    /**\n     * Indicates if speech to text should be enabled\n     *\n     * @default false\n     */\n    speechToTextEnabled?: boolean\n\n    /**\n     * History size\n     *\n     * @default 5\n     */\n    historySize?: number\n\n    /**\n     *  Number of search results to be displayed on the SERP\n     *\n     * @hidden is provided under the same name in default-design defaultConfig\n     * @deprecated use default design's defaultConfig instead\n     */\n    serpSize?: number\n\n    /**\n     * Enabled fallback for serp & category pages when service is unavailable\n     * By default, it will restore the native content.\n     *\n     * If set to 'legacy', it will force a page reload and disable the search for the current session.\n     *\n     * @default false\n     */\n    fallback?: boolean | \"legacy\"\n\n    /**\n     * Number of retries for search request.\n     * Retries won't be applied for autocomplete requests.\n     *\n     * @default 3\n     */\n    retries?: number\n\n    /**\n     * Interval between retries in milliseconds\n     *\n     * @default 500\n     */\n    retryInterval?: number\n\n    /**\n     * Enable search fallback when service is unavailable (overwrites global `fallback` option).\n     *\n     * By default it will redirect to original page by disabling new page.\n     * If custom function is provided, it will be called with query object.\n     *\n     * It's important that this path does not have same path as search page.\n     *\n     * @example\n     * ```\n     * serpFallback: (query) => {\n     *  location.replace(`/search?q=${query.query}`)\n     * }\n     * ```\n     */\n    serpFallback?: (query: SearchQuery) => void\n\n    /**\n     * Enable category fallback when service is unavailable (overwrites global `fallback` option).\n     *\n     * By default it will redirect to original page by disabling new page.\n     * If custom function is provided, it will be called with query object.\n     *\n     * It's important that this path does not have same path as search page.\n     *\n     * @example\n     * ```\n     * categoryFallback: (query) => {\n     *  location.replace(`/categories/${query.products.categoryId}`)\n     * }\n     * ```\n     */\n    categoryFallback?: (query: SearchQuery) => void\n\n    /**\n     * Debounce delay for search input\n     */\n    debounceDelay?: number\n\n    /**\n     * Delay serp page rendering given until given async function resolves\n     * Default function waitForElement can be imported from \"@nosto/preact\"\n     *\n     * @example To wait for Magento script to load\n     * ```\n     * import { waitForElement } from \"@nosto/preact\"\n     *\n     * init({\n     * ...\n     * serpRenderDelay: () => {\n     *  return waitForElement({\n     *      selector: 'script[type=\"text/x-magento-init\"]',\n     *  })\n     * }\n     * ```\n     */\n    serpRenderDelay?: () => Promise<void>\n\n    /**\n     * Enable persistent caching for search results.\n     *\n     * If enabled, the search results will be restored from cache when returning to the search page,\n     * from example, from a product page.\n     *\n     * The cache is stored in the browser's session storage.\n     */\n    persistentSearchCache?: boolean\n\n    /**\n     * Enable in-memory caching for autocomplete results.\n     *\n     * If enabled, the autocomplete results will be cached in memory,\n     * and the same results will be returned for the same query without making a new request.\n     */\n    memoryCache?: boolean\n\n    /**\n     * Preserve page scroll position when navigating back to search page.\n     *\n     * If enabled, it's highly recommended to also enabled `persistentSearchCache` for best user experience.\n     */\n    preservePageScroll?: boolean\n\n    /**\n     * Custom function, when provided, can be used to modify search query before sending it to the server.\n     * A default implementation is provided in the config that returns the query without any modification.\n     * Note: The query parameter itself should not be touched, but instead a new object should be returned in case modifications are needed.\n     * @param query SearchQuery\n     * @param pageType PageType | undefined\n     * @default queryModifications: query => query\n     * @example\n     * ```\n     * (query, pageType) => {\n     *   return {\n     *     ...query,\n     *     products: {\n     *       ...query.products,\n     *       filter: [\n     *         ...(query.products?.filter ?? []),\n     *         { field: \"availability\", value: [\"InStock\"] }\n     *       ]\n     *     }\n     *   }\n     * }\n     * ```\n     */\n    queryModifications?: (query: SearchQuery, pageType: PageType | undefined) => SearchQuery\n\n    /**\n     * Hit decorators are used to modify the products hits before they are rendered.\n     */\n    hitDecorators?: HitDecorator[]\n}\n\ntype MakeRequired<T, K extends keyof T> = Omit<T, K> & Required<Pick<T, K>>\n\n/**\n * Full configuration used internally in the Search application\n * @interface\n */\nexport type FullConfig = MakeRequired<Config, keyof typeof defaultConfig> &\n    Pick<SerpConfig, \"onBeforeSearch\" | \"onSearchError\" | \"search\">\n\n// @ts-expect-error type mismatch\nexport const ConfigContext = createContext<FullConfig>(defaultConfig)\n\ndeclare global {\n    interface Window {\n        nostoTemplatesFileResolver?: (path: string) => string\n    }\n}\n\n/**\n * When importing static resources (e.g. images), import will return relative url.\n * To use that url to load image, you need to resolve that to absolute url using `resolveStaticFile`.\n *\n * Uses `window.nostoTemplatesFileResolver` callback to format url.\n *\n * @example\n * ```\n * import url from './images/image.jpeg'\n *\n * console.log(resolveStaticFile(url))\n * ```\n */\nexport function resolveStaticFile(path: string): string {\n    const relativePath = path[0] === \"/\" ? path.slice(1) : path\n\n    if (window.nostoTemplatesFileResolver) {\n        return window.nostoTemplatesFileResolver(relativePath)\n    }\n    const src = document.currentScript instanceof HTMLScriptElement ? document.currentScript.src : \"\"\n    return new URL(relativePath, src).toString()\n}\n\nexport function resolveQuery(config: Partial<Config>, queryField: \"serpQuery\" | \"categoryQuery\" | \"autocompleteQuery\") {\n    const field = config[queryField]\n    if (typeof field === \"function\") {\n        return field.bind(config)()\n    }\n    return field\n}\n", "function o() {\n  window.nostojs = window.nostojs ?? function(n) {\n    (window.nostojs.q = window.nostojs.q ?? []).push(n);\n  };\n}\nasync function s(n) {\n  return window.nostojs(n);\n}\nlet t = null;\ntypeof window < \"u\" && (o(), s((n) => {\n  t = n.internal.getSettings();\n}));\nfunction i() {\n  return t;\n}\nfunction e(n) {\n  t = n;\n}\nexport {\n  i as g,\n  o as i,\n  s as n,\n  e as s\n};\n", "import { i as b } from \"./settings-DN0V2st5.js\";\nimport { g as T, n as U } from \"./settings-DN0V2st5.js\";\nfunction C() {\n  return typeof window.nosto < \"u\";\n}\nfunction N() {\n  return window.nosto;\n}\nconst h = {\n  production: \"https://connect.nosto.com/\",\n  staging: \"https://connect.staging.nosto.com/\",\n  local: \"https://connect.nosto.com/\"\n};\nfunction l(r) {\n  return h[r ?? \"production\"];\n}\nfunction k({ merchantId: r, env: o, options: n, shopifyInternational: e, scriptLoader: a }) {\n  var i, m;\n  const t = document.querySelector(\"script[nosto-language], script[nosto-market-id]\"), c = String((e == null ? void 0 : e.marketId) || \"\"), d = (e == null ? void 0 : e.language) || \"\", w = (t == null ? void 0 : t.getAttribute(\"nosto-language\")) !== d || (t == null ? void 0 : t.getAttribute(\"nosto-market-id\")) !== c;\n  if (!t || w) {\n    const s = document.querySelector(\"#nosto-sandbox\");\n    (i = t == null ? void 0 : t.parentNode) == null || i.removeChild(t), (m = s == null ? void 0 : s.parentNode) == null || m.removeChild(s);\n    const u = new URL(\"/script/shopify/market/nosto.js\", l(o));\n    u.searchParams.append(\"merchant\", r), u.searchParams.append(\"market\", c), u.searchParams.append(\"locale\", d.toLowerCase());\n    const f = {\n      ...n == null ? void 0 : n.attributes,\n      \"nosto-language\": d,\n      \"nosto-market-id\": c\n    };\n    return (a ?? g)(u.toString(), { ...n, attributes: f });\n  }\n  return Promise.resolve();\n}\nfunction v(r) {\n  if (r.shopifyInternational)\n    return k(r);\n  const { merchantId: o, env: n, options: e, scriptLoader: a } = r, t = a ?? g, c = new URL(`/include/${o}`, l(n));\n  return t(c.toString(), e);\n}\nfunction g(r, o) {\n  return new Promise((e, a) => {\n    const t = document.createElement(\"script\");\n    t.src = r, t.async = !0, t.type = \"text/javascript\", t.onload = () => e(), t.onerror = () => a(), Object.entries((o == null ? void 0 : o.attributes) ?? {}).forEach(([c, d]) => t.setAttribute(c, d)), (o == null ? void 0 : o.position) === \"head\" ? document.head.appendChild(t) : document.body.appendChild(t);\n  });\n}\nasync function L(r, o, n) {\n  var e;\n  if (!((e = window.Nosto) != null && e.addSkuToCart))\n    throw new Error(\"Nosto addSkuToCart function is not available\");\n  await window.Nosto.addSkuToCart(r, o, n);\n}\ntypeof window < \"u\" && b();\nexport {\n  L as addSkuToCart,\n  N as getNostoWindow,\n  T as getSettings,\n  v as init,\n  b as initNostoStub,\n  C as isNostoLoaded,\n  U as nostojs\n};\n", "import { nostojs } from \"@nosto/nosto-js\"\nimport { Config } from \"../config\"\n\nfunction notImplemented(): string | undefined {\n    throw new Error(\"Not implemented\")\n}\n\nexport const tagging = {\n    categoryId: notImplemented,\n    categoryPath: notImplemented,\n    pageType: notImplemented,\n    variation: notImplemented\n}\n\nnostojs(api => {\n    tagging.categoryId = () => api.pageTagging().categoryIds?.[0]\n    tagging.categoryPath = () => api.pageTagging().categories?.[0]\n    tagging.pageType = () => api.pageTagging().pageType\n    tagging.variation = () => api.pageTagging().variation\n})\n\nexport function registerSearchTermsProvider(config: Pick<Config, \"serpUrlMapping\" | \"inputCssSelector\">) {\n    nostojs(api => {\n        api.internal.setTaggingProvider(\n            \"searchTerms\",\n            () => {\n                const params = new URLSearchParams(window.location.search)\n                const queryValue = params.get(config.serpUrlMapping?.query || \"\")\n                return queryValue ? [queryValue] : undefined\n            },\n            { priority: true }\n        )\n    })\n}\n", "import { ConfigContext } from \"../config\"\nimport { useContext } from \"preact/hooks\"\n\n/**\n * Preact hook that import current config to the component.\n *\n * **Should always be at the top of the component!**\n *\n * @example\n * ```jsx\n * import { useConfig } from '@nosto/preact'\n *\n * export default () => {\n *     const { serpPath } = useConfig()\n *\n *     return <div>\n *         Default search page path {serpPath}\n *     </div>\n * }\n * ```\n *\n * @group Hooks\n */\nexport function useConfig() {\n    return useContext(ConfigContext)\n}\n", "function t() {\n  window.nostojs = window.nostojs ?? function(o) {\n    (window.nostojs.q = window.nostojs.q ?? []).push(o);\n  };\n}\nasync function u(o) {\n  return window.nostojs(o);\n}\nlet i = null;\ntypeof window < \"u\" && (t(), u((o) => {\n  i = o.internal.getSettings();\n}));\nfunction a() {\n  return i;\n}\nasync function d(o, w, s) {\n  var n;\n  if (!((n = window.Nosto) != null && n.addSkuToCart))\n    throw new Error(\"Nosto addSkuToCart function is not available\");\n  await window.Nosto.addSkuToCart(o, w, s);\n}\ntypeof window < \"u\" && t();\nexport {\n  d as L,\n  a as i,\n  u as s\n};\n", "import { s as u } from \"./index.es-B8mbAxS4.js\";\nconst i = (r) => String(r) === \"[object Object]\";\nfunction s(r) {\n  if (!i(r))\n    return !1;\n  const e = r.constructor;\n  if (e === void 0)\n    return !0;\n  const t = e.prototype;\n  return !(!i(t) || !t.hasOwnProperty(\"isPrototypeOf\"));\n}\nfunction f(r, e) {\n  if (r === e)\n    return !0;\n  if (r instanceof Date && e instanceof Date)\n    return r.getTime() === e.getTime();\n  if (Array.isArray(r) && Array.isArray(e))\n    return r.length !== e.length ? !1 : r.every((t, n) => f(t, e[n]));\n  if (s(r) && s(e)) {\n    const t = Object.entries(r);\n    return t.length !== Object.keys(e).length ? !1 : t.every(([n, c]) => f(c, e[n]));\n  }\n  return !1;\n}\nfunction o(r) {\n  return (...e) => {\n    u((t) => {\n      (t.internal.context.mode.isPreview() ? console[r] : t.internal.logger[r])(...e);\n    });\n  };\n}\nconst a = {\n  debug: o(\"debug\"),\n  info: o(\"info\"),\n  warn: o(\"warn\"),\n  error: o(\"error\")\n};\nexport {\n  s as a,\n  f as i,\n  a as l\n};\n", "import { a as u } from \"./logger-DVwg4Wor.js\";\nfunction o(...e) {\n  return f(...e);\n}\nfunction f(...e) {\n  return e.reduce((n, r) => c(n, r));\n}\nfunction c(e, n) {\n  return u(e) && u(n) ? Object.entries(n).reduce(\n    (r, [i, t]) => (r[i] = c(r[i], t), r),\n    { ...e }\n  ) : u(e) ? e : n;\n}\nexport {\n  f as a,\n  o as d\n};\n", "var s = \" daum[ /]| deusu/| yadirectfetcher|(?:^|[^g])news(?!sapphire)|(?<! (?:channel/|google/))google(?!(app|/google| pixel))|(?<! cu)bots?(?:\\\\b|_)|(?<!(?:lib))http|(?<![hg]m)score|(?<!cam)scan|@[a-z][\\\\w-]+\\\\.|\\\\(\\\\)|\\\\.com\\\\b|\\\\btime/|\\\\||^<|^[\\\\w \\\\.\\\\-\\\\(?:\\\\):%]+(?:/v?\\\\d+(?:\\\\.\\\\d+)?(?:\\\\.\\\\d{1,10})*?)?(?:,|$)|^[^ ]{50,}$|^\\\\d+\\\\b|^\\\\w*search\\\\b|^\\\\w+/[\\\\w\\\\(\\\\)]*$|^active|^ad muncher|^amaya|^avsdevicesdk/|^biglotron|^bot|^bw/|^clamav[ /]|^client/|^cobweb/|^custom|^ddg[_-]android|^discourse|^dispatch/\\\\d|^downcast/|^duckduckgo|^email|^facebook|^getright/|^gozilla/|^hobbit|^hotzonu|^hwcdn/|^igetter/|^jeode/|^jetty/|^jigsaw|^microsoft bits|^movabletype|^mozilla/\\\\d\\\\.\\\\d\\\\s[\\\\w\\\\.-]+$|^mozilla/\\\\d\\\\.\\\\d\\\\s\\\\(compatible;?(?:\\\\s\\\\w+\\\\/\\\\d+\\\\.\\\\d+)?\\\\)$|^navermailapp|^netsurf|^offline|^openai/|^owler|^php|^postman|^python|^rank|^read|^reed|^rest|^rss|^snapchat|^space bison|^svn|^swcd |^taringa|^thumbor/|^track|^w3c|^webbandit/|^webcopier|^wget|^whatsapp|^wordpress|^xenu link sleuth|^yahoo|^yandex|^zdm/\\\\d|^zoom marketplace/|^{{.*}}$|analyzer|archive|ask jeeves/teoma|audit|bit\\\\.ly/|bluecoat drtr|browsex|burpcollaborator|capture|catch|check\\\\b|checker|chrome-lighthouse|chromeframe|classifier|cloudflare|convertify|crawl|cypress/|dareboost|datanyze|dejaclick|detect|dmbrowser|download|evc-batch/|exaleadcloudview|feed|firephp|functionize|gomezagent|grab|headless|httrack|hubspot marketing grader|hydra|ibisbrowser|infrawatch|insight|inspect|iplabel|ips-agent|java(?!;)|library|linkcheck|mail\\\\.ru/|manager|measure|neustar wpm|node|nutch|offbyone|onetrust|optimize|pageburst|pagespeed|parser|perl|phantomjs|pingdom|powermarks|preview|proxy|ptst[ /]\\\\d|retriever|rexx;|rigor|rss\\\\b|scrape|server|sogou|sparkler/|speedcurve|spider|splash|statuscake|supercleaner|synapse|synthetic|tools|torrent|transcoder|url|validator|virtuoso|wappalyzer|webglance|webkit2png|whatcms/|xtate/\", i = /bot|crawl|http|lighthouse|scan|search|spider/i, t;\nfunction c() {\n  if (t instanceof RegExp)\n    return t;\n  try {\n    t = new RegExp(s, \"i\");\n  } catch {\n    t = i;\n  }\n  return t;\n}\nfunction d(e) {\n  return !!e && c().test(e);\n}\nfunction u() {\n  return d(navigator.userAgent);\n}\nfunction m(...e) {\n  if (!e.every((r) => r == null))\n    return e.filter((r) => Array.isArray(r)).reduce((r, a) => r.concat(a), []);\n}\nconst n = \"nosto.search.\";\nfunction l(e) {\n  var a;\n  const r = `${n}${e}`;\n  (a = window.performance) == null || a.mark(`${r}.start`);\n}\nfunction p(e) {\n  var a, o;\n  const r = `${n}${e}`;\n  (a = window.performance) == null || a.mark(`${r}.end`), (o = window.performance) == null || o.measure(r, `${r}.start`, `${r}.end`);\n}\nfunction h(e) {\n  return l(e), () => p(e);\n}\nfunction w(e) {\n  return Array.from(new Set(e));\n}\nexport {\n  h as a,\n  u as i,\n  m,\n  w as u\n};\n", "function e(r) {\n  if (typeof r == \"number\")\n    return r;\n  if (typeof r != \"string\")\n    return;\n  const t = Number(r);\n  return isNaN(t) ? void 0 : t;\n}\nexport {\n  e as p\n};\n", "function t(r, ...c) {\n  return c.reduce(\n    (e, n) => (e[n] = r[n], e),\n    {}\n  );\n}\nexport {\n  t as p\n};\n", "import { d as A } from \"../deepMerge-CZwCJzEe.js\";\nimport { i as y, a as L, m as h, u as t } from \"../unique-m1TIDWdl.js\";\nimport { i as b, a as j, l as B } from \"../logger-DVwg4Wor.js\";\nimport { p as O } from \"../parseNumber-QA48nJLp.js\";\nimport { p as U } from \"../pick-DReBictn.js\";\nfunction k(s) {\n  s.setAttribute(\"autocomplete\", \"off\");\n}\nfunction E(s, { onClick: a, onFocus: c, onInput: o, onKeyDown: i, onSubmit: f }, { form: u = s.form ?? void 0, nativeSubmit: p } = {}) {\n  const d = [];\n  function r(e, l, v) {\n    e.addEventListener(l, v), d.push(() => e.removeEventListener(l, v));\n  }\n  return (i || f) && r(s, \"keydown\", (e) => {\n    i == null || i(s.value, e.key), i && (e.key === \"ArrowDown\" || e.key === \"ArrowUp\") ? e.preventDefault() : f && e.key === \"Enter\" && (s.value !== \"\" && !e.repeat && f(s.value), p || e.preventDefault());\n  }), f && u && (r(u, \"submit\", (e) => {\n    p || e.preventDefault(), f(s.value);\n  }), u.querySelectorAll(\"[type=submit]\").forEach((e) => {\n    r(e, \"click\", (l) => {\n      p || l.preventDefault(), f(s.value);\n    });\n  })), a && r(s, \"click\", () => a(s.value)), c && r(s, \"focus\", () => c(s.value)), o && r(s, \"input\", () => o(s.value)), {\n    destroy() {\n      d.forEach((e) => e());\n    }\n  };\n}\nexport {\n  E as bindInput,\n  A as deepMerge,\n  k as disableNativeAutocomplete,\n  y as isBot,\n  b as isEqual,\n  j as isPlainObject,\n  B as logger,\n  L as measure,\n  h as mergeArrays,\n  O as parseNumber,\n  U as pick,\n  t as unique\n};\n", "export default function (...fns: ((value: unknown) => unknown)[]) {\n    return (value: unknown) => fns.reduce((prev, fn) => fn(prev), value)\n}\n", "const isObject = (v: unknown): v is object => String(v) === \"[object Object]\"\n\nexport default function isPlainObject<T = Record<string, unknown>>(value: unknown): value is T {\n    if (!isObject(value)) {\n        return false\n    }\n    const constructor = value.constructor\n    if (constructor === undefined) {\n        return true\n    }\n    const prototype = constructor.prototype\n    if (!isObject(prototype)) {\n        return false\n    }\n    // eslint-ignore-next-line no-prototype-builtins\n    if (!prototype.hasOwnProperty(\"isPrototypeOf\")) {\n        return false\n    }\n    return true\n}\n", "import { MaybeArray } from \"./types\"\n\nexport default function ensureArray<T>(value: MaybeArray<T>): T[] {\n    return Array.isArray(value) ? value : [value]\n}\n", "import { FullConfig } from \"../config\"\nimport { MapperOptions } from \"./types\"\n\nconst defaultOptions: MapperOptions = {\n    filterRangeSeparator: \"~\"\n}\n\nexport function createMapperOptions(config: FullConfig) {\n    if (typeof config.compressUrlParameters !== \"object\") {\n        return defaultOptions\n    }\n\n    return {\n        ...defaultOptions,\n        ...config.compressUrlParameters\n    }\n}\n\nexport function createMockMapperOptions(overrides: Partial<MapperOptions> = {}) {\n    return {\n        ...defaultOptions,\n        ...overrides\n    }\n}\n", "import { SearchQuery, SearchOptions } from \"../api\"\nimport { FullConfig } from \"../config\"\nimport { Store } from \"../state\"\nimport pipe from \"../utils/pipe\"\nimport isPlainObject from \"../utils/isPlainObject\"\nimport ensureArray from \"../utils/ensureArray\"\nimport { createMapperOptions } from \"./createMapperOptions\"\n\nexport function mapParams(data: object, mapping: object) {\n    return Object.entries(mapping)\n        .sort((a, b) => b[0].split(\".\").length - a[0].split(\".\").length)\n        .reduce<[object, object]>(\n            ([parsed, source], [mapFrom, mapTo]) => {\n                const value = objectGetByKey(source, mapFrom)\n                // tslint:disable-next-line:no-null-keyword\n                if (value != null) {\n                    return [\n                        // @ts-expect-error type mismatch\n                        objectSetByKey(parsed, mapTo, value),\n                        objectDeleteByKey(source, mapFrom)\n                    ]\n                }\n                return [parsed, source]\n            },\n            [{}, data]\n        )[0]\n}\n\nexport function unmapParams(data: object, mapping: Record<string, string>) {\n    if (Object.keys(mapping || {}).length > 0) {\n        return mapParams(\n            data,\n            Object.entries(mapping).reduce(\n                (prev, [key, value]) =>\n                    Object.assign(Object.assign({}, prev), {\n                        [value]: key\n                    }),\n                {}\n            )\n        )\n    }\n    return data\n}\n\nexport function paramsToQueryString(params: Record<string, unknown>): string {\n    const searchParams = new URLSearchParams()\n    Object.entries(params).forEach(([key, values]) => {\n        ensureArray(values)\n            .filter(v => v != null)\n            .forEach(v => {\n                searchParams.append(key, String(v))\n            })\n    })\n    return searchParams.toString()\n}\n\nexport function queryStringToParams(query: string): Record<string, string[]> {\n    const searchParams = new URLSearchParams(query)\n    const params: Record<string, string[]> = {}\n    searchParams.forEach((value, key) => {\n        if (!params[key]) params[key] = []\n        params[key]!.push(value)\n    })\n    return params\n}\n\nexport function paramsToJson(params: Record<string, unknown>) {\n    const data = Object.entries(params)\n        .map(([k, v]) => ({\n            key: k,\n            values: ensureArray(v)\n        }))\n        .sort((a, b) => {\n            return a.key < b.key ? -1 : a.key > b.key ? 1 : 0\n        })\n    return multikeyToJson(\n        // @ts-expect-error type mismatch\n        data.map(v => ({\n            key: decodeKey(v.key),\n            values: v.values\n        }))\n    )\n}\n\nexport function jsonToParams(data: Record<string, unknown>, knownKeys: string[] = []): Record<string, unknown> {\n    return Object.assign({}, ...Object.entries(data).map(([k, v]) => makeParams([k], v, knownKeys)))\n}\n\nexport function updateUrlState(newUrl: string, title: string = document.title): void {\n    const fullUrl = getFullUrl(newUrl)\n    if (!compareUrl(window.location.href, fullUrl)) {\n        window.history.pushState(undefined, title, fullUrl)\n    }\n}\n\nexport function bindUrlStateChange(callback: (event: PopStateEvent) => void): void {\n    // Prevent popstate on page load\n    setTimeout(() => {\n        window.addEventListener(\"popstate\", callback)\n    }, 30)\n}\n\nexport function compareUrl(url: string, otherUrl: string): boolean {\n    return getFullUrl(url) === getFullUrl(otherUrl)\n}\n\nexport function getFullUrl(url: string): string {\n    return new URL(url.endsWith(\"?\") ? url.slice(0, -1) : url, window.location.href).href\n}\n\nexport function getSearchUrl(\n    context: {\n        store: Store\n        config: FullConfig\n    },\n    query: SearchQuery,\n    options?: SearchOptions\n): string {\n    const mapperOptions = createMapperOptions(context.config)\n    const encoder = pipe(\n        ...(context.config.customUrlMappings?.map(m => {\n            // Wrap encoder to include mapperOptions\n            return (query: unknown) => m.encode(query, mapperOptions)\n        }) ?? [])\n    )\n\n    const paramsWithoutDefault = deepRemove(encoder(query), encoder(context.store.getInitialState().query))\n\n    const params = jsonToParams(\n        {\n            ...(options?.customParams ?? {}),\n            // @ts-expect-error type mismatch\n            ...mapParams(paramsWithoutDefault, context.config.serpUrlMapping)\n        },\n        // apply array mapping only to known keys\n        Object.values(context.config.serpUrlMapping)\n    )\n\n    return `${\n        context.store.getInitialState()?.pageType === \"search\"\n            ? (context.config.serpPath ?? location.pathname)\n            : location.pathname\n    }?${paramsToQueryString(params)}`\n}\n\nconst KEY_SEPARATOR = \".\"\nconst KEY_SEPARATOR_ENCODED = \"::\"\n\ninterface MultiKeyItem {\n    key: string[]\n    values: Record<string, Record<string, unknown>>[]\n}\n\ninterface GroupedMultiKeyItems {\n    [key: string]: MultiKeyItem[]\n}\n\nfunction isInteger(a: string): boolean {\n    return /^\\+?(0|[1-9]\\d*)$/.test(a)\n}\n\nfunction multikeyToJson(data: MultiKeyItem[]): Record<string, unknown> | object {\n    if (!data.length) {\n        return {}\n    }\n    const first = data[0]\n    if (first!.key.length === 0) {\n        if (first!.values.length === 1) {\n            return first!.values[0]!\n        }\n        return first!.values\n    }\n    if (isInteger(first!.key[0]!)) {\n        return Object.values(deeperMultikey(data))\n    }\n    return deeperMultikey(data)\n}\n\nfunction deeperMultikey(data: MultiKeyItem[]): Record<string, unknown> {\n    const grouped = data.reduce<GroupedMultiKeyItems>((r, x) => {\n        const k = x.key[0]\n        return {\n            ...r,\n            [k!]: [...(r[k!] || []), x]\n        }\n    }, {})\n    return Object.assign(\n        {},\n        ...Object.keys(grouped).map(key => ({\n            [key]: multikeyToJson(cutFirstKey(grouped[key]!))\n        }))\n    )\n}\n\nfunction cutFirstKey(data: MultiKeyItem[]): MultiKeyItem[] {\n    return data.map(v => ({\n        key: v.key.slice(1),\n        values: v.values\n    }))\n}\n\nfunction makeParams(keys: string[], value: unknown, knownKeys: string[]): Record<string, unknown> {\n    if (isPlainObject(value)) {\n        return Object.assign({}, ...Object.entries(value).map(([k, v]) => makeParams([...keys, k], v, knownKeys)))\n    }\n    if (value instanceof Array && (knownKeys.includes(keys[0]!) || value.some(v => v instanceof Object))) {\n        return Object.assign({}, ...value.map((v, i) => makeParams([...keys, i.toString()], v, knownKeys)))\n    }\n    return {\n        [encodeKey(keys)]: value\n    }\n}\n\nfunction encodeKey(keys: string[]): string {\n    return keys.map(k => k.split(KEY_SEPARATOR).join(KEY_SEPARATOR_ENCODED)).join(KEY_SEPARATOR)\n}\n\nfunction decodeKey(key: string): string[] {\n    return key.split(KEY_SEPARATOR).map(k => k.split(KEY_SEPARATOR_ENCODED).join(KEY_SEPARATOR))\n}\n\nexport function objectDeleteByKey(obj: object, key: string) {\n    obj = objectClone(obj)\n    // tslint:disable-next-line:one-variable-per-declaration\n    let i, index, len, pointer, subkey: string\n    pointer = obj\n    const subkeys = key.split(\".\")!\n    for (index = i = 0, len = subkeys.length; i < len; index = ++i) {\n        subkey = subkeys[index]!\n        subkey = decodeURIComponent(subkey)\n        if (isPlainObject(pointer) && subkey in pointer) {\n            if (index + 1 === subkeys.length) {\n                delete pointer[subkey]\n            } else {\n                pointer = pointer[subkey]\n            }\n        } else {\n            break\n        }\n    }\n    return obj\n}\n\nexport function objectGetByKey(obj: object, key: string, defaultValue?: unknown) {\n    // tslint:disable-next-line:one-variable-per-declaration\n    let i, index, len, pointer, subkey: string, value\n    pointer = obj\n    const subkeys = key.split(\".\")\n    value = void 0\n    for (index = i = 0, len = subkeys.length; i < len; index = ++i) {\n        subkey = subkeys[index]!\n        subkey = decodeURIComponent(subkey)\n        if (isPlainObject(pointer) && subkey in pointer) {\n            pointer = pointer[subkey]\n            value = pointer\n        } else {\n            value = defaultValue\n            break\n        }\n    }\n    return value\n}\n\nfunction objectClone<T>(obj: T): T\n// eslint-disable-next-line no-redeclare\nfunction objectClone(obj: unknown): unknown {\n    if (obj instanceof Array) {\n        return obj.map(v => objectClone(v))\n    }\n    if (isPlainObject(obj)) {\n        return Object.entries(obj).reduce(\n            (prev, [key, value]) =>\n                Object.assign(Object.assign({}, prev), {\n                    [objectClone(key)]: objectClone(value)\n                }),\n            {}\n        )\n    }\n    return obj\n}\n\nexport function objectSetByKey(obj: Record<string, unknown>, key: string, value: unknown) {\n    obj = objectClone(obj)\n    // tslint:disable-next-line:one-variable-per-declaration\n    let i, index, len, pointer: Record<string, unknown>, subkey: string\n    pointer = obj\n    const subkeys = key.split(\".\")\n    for (index = i = 0, len = subkeys.length; i < len; index = ++i) {\n        subkey = subkeys[index]!\n        subkey = decodeURIComponent(subkey)\n        if (index + 1 !== subkeys.length) {\n            if (!(subkey in pointer)) {\n                pointer[subkey] = {}\n            }\n            if (!isPlainObject(pointer[subkey])) {\n                pointer[subkey] = {}\n            }\n            // @ts-expect-error type mismatch\n            pointer = pointer[subkey]\n        } else {\n            pointer[subkey] = value\n        }\n    }\n    return obj\n}\n\nexport function deepCompare(a: unknown, b: unknown) {\n    return JSON.stringify(a) === JSON.stringify(b)\n}\n\nexport function deepRemove<T>(value: T, removeValue: unknown): T\n// eslint-disable-next-line no-redeclare\nexport function deepRemove(value: Record<string, unknown>, removeValue: unknown) {\n    if (isPlainObject(value) && isPlainObject(removeValue)) {\n        const result: Record<string, unknown> = {}\n        Object.keys(value).forEach(key => {\n            if (!deepCompare(value[key], removeValue[key])) {\n                result[key] = deepRemove(value[key], removeValue[key])\n            }\n        })\n        return result\n    }\n    return value\n}\n", "import { logger } from \"@nosto/search-js/utils\"\n\ntype Key = `nosto:search-templates:${string}`\n\nfunction setStorage(name: Key, value: unknown, storage: Storage) {\n    const stringValue = JSON.stringify(value)\n    try {\n        storage.setItem(name, stringValue)\n    } catch (error) {\n        logger.warn(error)\n    }\n}\n\nfunction getStorage<T>(name: Key, storage: Storage) {\n    let dataString\n    try {\n        dataString = storage.getItem(name)\n    } catch (error) {\n        logger.warn(error)\n        return undefined\n    }\n    if (!dataString) {\n        return undefined\n    }\n    try {\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return JSON.parse(dataString) as T\n    } catch (error) {\n        logger.warn(`cannot parse JSON- ${error} (${dataString})`)\n        return undefined\n    }\n}\n\nfunction removeStorage(name: Key, storage: Storage) {\n    try {\n        storage.removeItem(name)\n    } catch (error) {\n        logger.warn(error)\n    }\n}\n\nexport function setLocalStorageItem(name: Key, value: unknown) {\n    setStorage(name, value, localStorage)\n}\n\nexport function setSessionStorageItem(name: Key, value: unknown) {\n    setStorage(name, value, sessionStorage)\n}\n\nexport function getLocalStorageItem<T>(name: Key) {\n    return getStorage<T>(name, localStorage)\n}\n\nexport function getSessionStorageItem<T>(name: Key) {\n    return getStorage<T>(name, sessionStorage)\n}\n\nexport function removeLocalStorageItem(name: Key) {\n    removeStorage(name, localStorage)\n}\n\nexport function removeSessionStorageItem(name: Key) {\n    removeStorage(name, sessionStorage)\n}\n", "import { getSessionStorageItem, setSessionStorageItem } from \"./storage\"\n\nexport const ERROR_TIMEOUT = 600 // 10 minutes\n\nconst key = \"nosto:search-templates:error\"\n\nexport function setErrorSession() {\n    const errorTimestamp = getErrorSession()\n    const currentTimestamp = getCurrentTimestamp()\n    if (!errorTimestamp || currentTimestamp > errorTimestamp) {\n        setSessionStorageItem(key, currentTimestamp + ERROR_TIMEOUT)\n        return true\n    }\n    return false\n}\n\nfunction getErrorSession() {\n    const errorTimestamp = getSessionStorageItem<number>(key)\n    return errorTimestamp ? +errorTimestamp : undefined\n}\n\nexport function getCurrentTimestamp() {\n    return Math.floor(new Date().getTime() / 1000)\n}\n\nexport function isErrorSession() {\n    const errorTimestamp = getErrorSession()\n    return errorTimestamp && getCurrentTimestamp() < errorTimestamp\n}\n", "export async function DOMReady(): Promise<void> {\n    return new Promise(resolve => {\n        if (document.readyState !== \"loading\") {\n            resolve()\n        } else {\n            window.addEventListener(\"DOMContentLoaded\", () => {\n                resolve()\n            })\n        }\n    })\n}\n\nexport type DOMTarget = string | Element\n\nexport function findAll<T extends Element>(selector: DOMTarget, filterType?: { new (): T }): T[] {\n    const elements = typeof selector === \"string\" ? Array.from(document.querySelectorAll(selector)) : [selector]\n    return elements.filter((v): v is T => (filterType ? v instanceof filterType : true))\n}\n\nexport function parents(target: DOMTarget, selector?: string): Element[] {\n    let parentList: Element[] = []\n    findAll(target).forEach(element => {\n        const parent = element.parentNode\n        if (parent !== document && parent instanceof Element) {\n            parentList.push(parent)\n            parentList = parentList.concat(parents(parent))\n        }\n    })\n    return parentList.filter(element => selector === undefined || matches(element, selector))\n}\n\nexport function matches(target: DOMTarget, selector: string): boolean {\n    const matchesFunc =\n        Element.prototype.matches ||\n        // @ts-expect-error proprietary field\n        Element.prototype.msMatchesSelector ||\n        Element.prototype.webkitMatchesSelector\n    return findAll(target).some(element => matchesFunc.call(element, selector))\n}\n\nexport function bindClickOutside([element, input]: HTMLElement[], callback: () => void) {\n    const onClick = (event: MouseEvent) => {\n        const target = event.target\n\n        if (target instanceof HTMLElement && element) {\n            if (target !== element && target !== input && !parents(target).includes(element)) {\n                callback()\n            }\n        }\n    }\n\n    document.addEventListener(\"click\", onClick)\n\n    return {\n        destroy: () => {\n            document.removeEventListener(\"click\", onClick)\n        }\n    }\n}\n\nexport function unhideNativeContent(cssSelector: string | undefined) {\n    if (!cssSelector) {\n        return\n    }\n    const target = document.querySelector(cssSelector)\n    if (!target) {\n        return\n    }\n    target.classList.remove(\"ns-content-hidden\")\n}\n\nexport function cloneNode<T extends Node>(node: T, deep: boolean): T {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    return node.cloneNode(deep) as T\n}\n\nconst scrollPosStorageKey = \"nosto:search-templates:scrollPos\"\n\nexport function savePageScroll() {\n    window.sessionStorage.setItem(scrollPosStorageKey, window.scrollY.toString())\n}\n\nexport function restoreSavedScroll() {\n    const savedScrollPosition = window.sessionStorage.getItem(scrollPosStorageKey)\n    if (!savedScrollPosition) {\n        return\n    }\n\n    const scrollTo = Math.floor(parseFloat(savedScrollPosition))\n    const interval = window.setInterval(() => {\n        const maxScrollable = document.documentElement.scrollHeight - window.innerHeight\n        if (maxScrollable >= scrollTo) {\n            window.scrollTo(0, scrollTo)\n            window.sessionStorage.removeItem(scrollPosStorageKey)\n            window.clearInterval(interval)\n        }\n    }, 10)\n\n    /**\n     * Defensive block in case scroll position couldn't be restored shortly after page load.\n     */\n    window.setTimeout(() => {\n        window.clearInterval(interval)\n        console.warn(\"Scroll position couldn't be restored in 5 seconds, something may be wrong.\")\n    }, 5000)\n}\n", "import { cloneNode } from \"./dom\"\n\nexport const serpContentClassName = \"nosto-serp-content\"\nexport const serpContentNativeClassName = \"nosto-serp-content-native\"\n\nexport const searchFormClassName = \"nosto-search-form\"\nexport const searchFormNativeClassName = \"nosto-search-form-native\"\n\n/**\n * Extracts all native content from the nosto search render target.\n * The copy will be restored in case of Nosto search being unavailable.\n */\nexport function extractNativeContent(element: Element): void {\n    element.classList.add(serpContentClassName)\n\n    const nativeContentContainer = document.createElement(\"div\")\n    nativeContentContainer.style.display = \"none\"\n    nativeContentContainer.classList.add(serpContentNativeClassName)\n    while (element.firstChild) {\n        const child = element.firstChild\n        element.removeChild(child)\n        nativeContentContainer.appendChild(child)\n    }\n\n    // Element will always have a parent node\n    element.parentNode!.appendChild(nativeContentContainer)\n}\n\n/**\n * Replaces the matching elements (via query selector) with a deep copy,\n * removing any attached event listeners in the process.\n *\n * The original elements are saved to be restored in case of Nosto search being unavailable.\n */\nexport async function extractNativeForm(selector: string, delay?: number) {\n    if (delay) {\n        await new Promise(resolve => setTimeout(resolve, delay))\n    }\n    document.querySelectorAll<HTMLElement>(selector).forEach(el => {\n        const newElement = cloneNode(el, true)\n\n        newElement.classList.add(searchFormClassName)\n        el.parentNode?.insertBefore(newElement, el)\n\n        el.id = \"\"\n        el.className = \"\"\n        el.style.display = \"none\"\n        el.classList.add(searchFormNativeClassName)\n    })\n}\n\nexport function restoreNativeContent() {\n    const target = document.querySelector(`.${serpContentClassName}`)\n    const nativeContentElement = document.querySelector(`.${serpContentNativeClassName}`)\n    if (!target || !nativeContentElement) {\n        return\n    }\n\n    while (target.firstChild) {\n        target.removeChild(target.firstChild)\n    }\n    while (nativeContentElement.firstChild) {\n        const child = nativeContentElement.firstChild\n        nativeContentElement.removeChild(child)\n        target.appendChild(child)\n    }\n    nativeContentElement.remove()\n}\n\nexport function restoreNativeForm() {\n    const unboundForms = document.querySelectorAll<HTMLElement>(`.${searchFormClassName}`)\n    const nativeForms = document.querySelectorAll<HTMLElement>(`.${searchFormNativeClassName}`)\n    unboundForms.forEach((form, index) => {\n        const nativeForm = nativeForms[index]\n        if (!nativeForm) {\n            return\n        }\n\n        nativeForm.style.display = form.style.display\n        nativeForm.id = form.id\n        form.classList.remove(searchFormClassName)\n        nativeForm.className = form.className\n        form.remove()\n    })\n}\n", "import { createContext as c } from \"preact\";\nimport { a as u } from \"./deepMerge-CZwCJzEe.js\";\nimport { i as x } from \"./logger-DVwg4Wor.js\";\nimport { useContext as h } from \"preact/hooks\";\nfunction w(t, i = {}) {\n  const a = /* @__PURE__ */ new Map();\n  let o = u(t, i ?? {});\n  const f = u(t, i);\n  function l(e) {\n    o = e(o);\n    for (const n of a.values())\n      n(o);\n  }\n  function C(e) {\n    l((n) => ({ ...n, ...e }));\n  }\n  function g() {\n    return o;\n  }\n  function p() {\n    return structuredClone(f);\n  }\n  function d(e, n) {\n    let s;\n    a.set(n, (S) => {\n      const r = e(S);\n      x(r, s) || (s = r, n(r));\n    });\n  }\n  function m(e) {\n    a.delete(e);\n  }\n  return {\n    updateState: C,\n    getState: g,\n    getInitialState: p,\n    onChange: d,\n    clearOnChange: m\n  };\n}\nconst b = {\n  loading: !0,\n  query: {},\n  response: {},\n  initialized: !1\n};\nfunction E(t = {}) {\n  return w(b, t);\n}\nconst y = c(E()), q = c(null), z = () => {\n  const t = h(q);\n  if (!t)\n    throw new Error(\"useConfig must be used within a ConfigProvider\");\n  return t;\n};\nexport {\n  q as C,\n  y as S,\n  w as a,\n  E as c,\n  b as d,\n  z as u\n};\n", "import { S as C, u as F } from \"./configContext-GuZOIX3o.js\";\nimport { useContext as v, useState as P, useEffect as M, useMemo as T, useCallback as d } from \"preact/hooks\";\nimport { s as I } from \"./search-BrR80UbS.js\";\nimport { u as q, a as p, m as Q, i as U } from \"./unique-m1TIDWdl.js\";\nimport { d as f } from \"./deepMerge-CZwCJzEe.js\";\nimport { l as A, i as z } from \"./logger-DVwg4Wor.js\";\nfunction B(e, t) {\n  return {\n    ...t,\n    products: {\n      facets: e === \"autocomplete\" ? void 0 : [\"*\"],\n      fields: E,\n      ...t.products\n    },\n    ...t.keywords ? {\n      keywords: {\n        ...t.keywords,\n        fields: q([...K, ...t.keywords.fields ?? []]),\n        highlight: t.keywords.highlight ?? {\n          preTag: \"<strong>\",\n          postTag: \"</strong>\"\n        }\n      }\n    } : {}\n  };\n}\nconst E = [\n  \"productId\",\n  \"url\",\n  \"name\",\n  \"imageUrl\",\n  \"imageHash\",\n  \"thumbUrl\",\n  \"description\",\n  \"brand\",\n  \"variantId\",\n  \"availability\",\n  \"price\",\n  \"priceText\",\n  \"categoryIds\",\n  \"categories\",\n  \"customFields.key\",\n  \"customFields.value\",\n  \"priceCurrencyCode\",\n  \"datePublished\",\n  \"listPrice\",\n  \"unitPricingBaseMeasure\",\n  \"unitPricingUnit\",\n  \"unitPricingMeasure\",\n  \"googleCategory\",\n  \"gtin\",\n  \"ageGroup\",\n  \"gender\",\n  \"condition\",\n  \"alternateImageUrls\",\n  \"ratingValue\",\n  \"reviewCount\",\n  \"inventoryLevel\",\n  \"skus.id\",\n  \"skus.name\",\n  \"skus.price\",\n  \"skus.listPrice\",\n  \"skus.priceText\",\n  \"skus.url\",\n  \"skus.imageUrl\",\n  \"skus.inventoryLevel\",\n  \"skus.customFields.key\",\n  \"skus.customFields.value\",\n  \"skus.availability\",\n  \"pid\",\n  \"onDiscount\",\n  \"extra.key\",\n  \"extra.value\",\n  \"saleable\",\n  \"available\",\n  \"tags1\",\n  \"tags2\",\n  \"tags3\"\n], K = [\"keyword\", \"_redirect\"];\nasync function b(e, t, r) {\n  var l, n, m, h, k, S, w;\n  const o = p(\"newSearch\"), i = e.config.pageType, c = i === \"search\" ? \"serp\" : i, a = f(e.store.getInitialState().query, t), s = f(e.config.search, r, {\n    track: c,\n    redirect: i !== \"autocomplete\",\n    isKeyword: !!(r != null && r.isKeyword),\n    usePersistentCache: e.config.pageType !== \"autocomplete\" && e.config.persistentSearchCache,\n    useMemoryCache: e.config.pageType === \"autocomplete\" && e.config.memoryCache\n  });\n  (n = (l = e.config).onBeforeSearch) == null || n.call(l, e, s), e.store.updateState({\n    query: a,\n    loading: !0,\n    initialized: !0\n  });\n  const u = e.config.queryModifications(\n    {\n      ...a,\n      products: {\n        ...a.products,\n        // Apply filter merging to avoid overwriting base filters\n        filter: Q((h = (m = e.store.getInitialState().query) == null ? void 0 : m.products) == null ? void 0 : h.filter, (k = t.products) == null ? void 0 : k.filter)\n      }\n    },\n    i\n  );\n  try {\n    const g = await I(B(e.config.pageType, u), s);\n    e.store.updateState({\n      response: g,\n      loading: !1\n    });\n  } catch (g) {\n    A.error(\"Search action failed\", g), (w = (S = e.config).onSearchError) == null || w.call(S, g, u, s, i);\n  }\n  o();\n}\nasync function y(e, t, r) {\n  const o = p(\"updateSearch\"), i = f(e.store.getState().query, { products: { from: 0 } }, t);\n  await b(e, i, r), o();\n}\nfunction L(e = D) {\n  const t = v(C), [r, o] = P(e(t.getState()));\n  return t.onChange(e, o), M(() => () => t.clearOnChange(o), [t]), r;\n}\nconst D = (e) => e;\nasync function N(e, t, r) {\n  var a;\n  const o = p(\"replaceFilter\"), i = (a = e.store.getState().query.products) == null ? void 0 : a.filter, c = r !== void 0 ? [{ field: t, [typeof r == \"object\" ? \"range\" : \"value\"]: [r] }] : [];\n  await y(e, {\n    products: {\n      filter: [...(i == null ? void 0 : i.filter((s) => s.field !== t)) ?? [], ...c]\n    }\n  }), o();\n}\nasync function O(e, t, r, o) {\n  var u, l;\n  const i = p(\"toggleProductFilter\"), c = (u = e.store.getState().query.products) == null ? void 0 : u.filter, a = c == null ? void 0 : c.find((n) => n.value instanceof Array && n.field === t), s = a != null && a.value ? {\n    ...a,\n    value: [...a.value.filter((n) => !z(n, r)), ...o ? [r] : []]\n  } : o ? {\n    field: t,\n    value: [r]\n  } : void 0;\n  await y(e, {\n    products: {\n      filter: [...(c == null ? void 0 : c.filter((n) => n !== a)) ?? [], ...(l = s == null ? void 0 : s.value) != null && l.length ? [s] : []]\n    }\n  }), i();\n}\nfunction j() {\n  const e = F(), t = v(C), r = T(\n    () => ({\n      config: e,\n      store: t\n    }),\n    [e, t]\n  ), o = d(\n    (s, u) => b(r, s, u),\n    [r]\n  ), i = d(\n    (s, u) => y(r, s, u),\n    [r]\n  ), c = d(\n    (s, u, l) => O(r, s, u, l),\n    [r]\n  ), a = d(\n    (s, u) => N(r, s, u),\n    [r]\n  );\n  return {\n    newSearch: o,\n    updateSearch: i,\n    toggleProductFilter: c,\n    replaceFilter: a\n  };\n}\nfunction G({ from: e, size: t, pageSize: r }) {\n  return U() ? {\n    products: { from: e + r }\n  } : {\n    products: { size: t + r }\n  };\n}\nfunction X(e = 24) {\n  const { from: t, size: r } = L((c) => {\n    var a, s;\n    return {\n      from: ((a = c.query.products) == null ? void 0 : a.from) ?? 0,\n      size: ((s = c.query.products) == null ? void 0 : s.size) ?? 0\n    };\n  }), { updateSearch: o } = j();\n  return {\n    loadMore: d(async () => {\n      await o(G({ from: t, size: r, pageSize: e }));\n    }, [t, r, e, o])\n  };\n}\nexport {\n  L as a,\n  X as b,\n  j as c,\n  G as g,\n  b as n,\n  y as u\n};\n", "import { s as N } from \"./index.es-B8mbAxS4.js\";\nimport { l, i as R } from \"./logger-DVwg4Wor.js\";\nasync function T(t, { hitDecorators: e, ...n }, s) {\n  var o, i;\n  const r = await s(t, n);\n  if (!((i = (o = r.products) == null ? void 0 : o.hits) != null && i.length) || !(e != null && e.length))\n    return r;\n  const c = (a) => e.reduce((u, f) => f(u), a);\n  return {\n    ...r,\n    products: {\n      ...r.products,\n      hits: r.products.hits.map(c)\n    }\n  };\n}\nfunction z(t, e, n) {\n  const s = JSON.stringify(e);\n  try {\n    n.setItem(t, s);\n  } catch (r) {\n    l.warn(r);\n  }\n}\nfunction O(t, e) {\n  try {\n    const n = e.getItem(t);\n    if (n)\n      return JSON.parse(n);\n  } catch (n) {\n    l.warn(n);\n  }\n}\nfunction E(t, e) {\n  z(t, e, sessionStorage);\n}\nfunction J(t) {\n  return O(t, sessionStorage);\n}\nconst b = \"nosto:search-js:cache\", k = 60 * 1e3;\nfunction I(t, e) {\n  E(b, { query: t, result: e, created: Date.now() });\n}\nfunction M(t) {\n  const e = J(b);\n  if (!e || !V(e))\n    return null;\n  const n = C(e.query);\n  return !R(C(t), n) || Date.now() - e.created > k ? null : e.result;\n}\nfunction C(t) {\n  const e = {\n    ...t,\n    time: void 0,\n    products: {\n      ...t.products,\n      size: void 0\n    }\n  };\n  return JSON.parse(JSON.stringify(e));\n}\nfunction V(t) {\n  return typeof t == \"object\" && t !== null && \"query\" in t && \"result\" in t && \"created\" in t;\n}\nasync function W(t, { usePersistentCache: e, ...n }, s) {\n  if (!e)\n    return s(t, n);\n  const r = await j(t, n, s);\n  return I(t, r), r;\n}\nasync function j(t, e, n) {\n  var h, g, m, S, w, y;\n  const { from: s = 0, size: r = 0 } = t.products || {}, c = M(t);\n  if (!c)\n    return await n(t, e);\n  const o = ((h = c == null ? void 0 : c.products) == null ? void 0 : h.size) ?? 0, i = ((g = c == null ? void 0 : c.products) == null ? void 0 : g.hits) ?? [];\n  if (r === o)\n    return c;\n  if (r < o)\n    return {\n      ...c,\n      products: {\n        ...c.products,\n        size: r,\n        hits: i.slice(0, r),\n        total: ((m = c.products) == null ? void 0 : m.total) || 0\n      }\n    };\n  const a = r - i.length, u = s > 0 ? s + 1 : r - a, f = {\n    ...t,\n    products: {\n      ...t.products,\n      from: u,\n      size: a\n    }\n  }, p = await n(f, e);\n  return {\n    ...c,\n    products: {\n      ...c.products,\n      size: r,\n      hits: [...((S = c.products) == null ? void 0 : S.hits) || [], ...((w = p.products) == null ? void 0 : w.hits) || []],\n      total: ((y = p.products) == null ? void 0 : y.total) || 0\n    }\n  };\n}\nconst x = 3e4, d = /* @__PURE__ */ new Map();\nfunction A(t, e) {\n  const n = d.get(t);\n  if (!n) return;\n  const s = Date.now() - n.created > x, r = R(e, n.query);\n  if (s || !r) {\n    d.delete(t);\n    return;\n  }\n  return n.result;\n}\nfunction K(t, e, n) {\n  d.set(t, {\n    query: e,\n    result: n,\n    created: Date.now()\n  });\n}\nasync function L(t, e, n) {\n  if (!e.useMemoryCache)\n    return n(t, e);\n  const s = JSON.stringify(t), r = A(s, t);\n  if (r) return r;\n  const c = await n(t, e);\n  return K(s, t, c), c;\n}\nfunction P(t) {\n  return new Promise((e) => setTimeout(e, t));\n}\nasync function _(t, { maxRetries: e = 0, retryInterval: n = 0, ...s }, r) {\n  let c = 0;\n  for (; ; )\n    try {\n      return await r(t, s);\n    } catch (o) {\n      if (c >= e)\n        throw o;\n      if (!F(o))\n        throw l.info(\"Skipping retry logic for\", o), o;\n      c++, await P(n);\n    }\n}\nfunction F(t) {\n  return !t || typeof t != \"object\" ? !1 : !(\"status\" in t) || G(t.status);\n}\nfunction G(t) {\n  return typeof t == \"number\" && (t < 400 || t >= 500);\n}\nasync function v(t, e = {}) {\n  const n = await new Promise(N);\n  return H(n.search, _, L, W, T)(t, e);\n}\nfunction H(t, ...e) {\n  return e.reduce((n, s) => (r, c) => s(r, c, n), t);\n}\nexport {\n  v as s\n};\n", "import { options as i } from \"preact\";\nvar v = 0;\nfunction t(f, _, u, c, l, p) {\n  _ || (_ = {});\n  var n, o, r = _;\n  if (\"ref\" in r) for (o in r = {}, _) o == \"ref\" ? n = _[o] : r[o] = _[o];\n  var e = { type: f, props: r, key: u, ref: n, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: --v, __i: -1, __u: 0, __source: l, __self: p };\n  if (typeof f == \"function\" && (n = f.defaultProps)) for (o in n) r[o] === void 0 && (r[o] = n[o]);\n  return i.vnode && i.vnode(e), e;\n}\nexport {\n  t as u\n};\n", "import { u as f } from \"./jsxRuntime.module-Bzuv3cXw.js\";\nimport { a, b as l } from \"./useLoadMore-Der8Cglb.js\";\nimport { p as d } from \"./pick-DReBictn.js\";\nimport { useRef as m, useEffect as b } from \"preact/hooks\";\nimport { Fragment as v } from \"preact\";\nfunction w(o, i) {\n  var n, e, r;\n  const t = ((n = i.products) == null ? void 0 : n.total) ?? 0, c = ((e = o.products) == null ? void 0 : e.from) ?? 0, s = ((r = o.products) == null ? void 0 : r.size) ?? 0;\n  return t > 0 && t > c + s;\n}\nfunction E() {\n  return !!(window.IntersectionObserver && window.IntersectionObserverEntry && \"intersectionRatio\" in window.IntersectionObserverEntry.prototype);\n}\nfunction M({ children: o, pageSize: i }) {\n  const t = m(null), { query: c, response: s } = a((e) => d(e, \"query\", \"response\")), { loadMore: n } = l(i);\n  return b(() => {\n    let e, r;\n    return w(c, s) && (e = t.current, r = new IntersectionObserver((p) => {\n      const u = p[0];\n      u != null && u.isIntersecting && n();\n    }), e && r.observe(e)), () => {\n      e && r.unobserve(e);\n    };\n  }, [s]), /* @__PURE__ */ f(v, { children: [\n    o,\n    /* @__PURE__ */ f(\"div\", { ref: t, style: { height: \"1px\" } })\n  ] });\n}\nexport {\n  M as I,\n  w as h,\n  E as i\n};\n", "import { Store } from \"./state\"\nimport { SearchQuery, SearchOptions } from \"./api/types\"\nimport { deepMerge, measure } from \"@nosto/search-js/utils\"\nimport { FullConfig } from \"./config\"\nimport { getFullUrl, getSearchUrl } from \"./urlEncoding/url\"\nimport { setErrorSession } from \"./helpers/errorHandling\"\nimport { restoreNativeContent, restoreNativeForm } from \"./helpers/searchFallback\"\nimport { newSearch as baseNewSearch, updateSearch as baseUpdateSearch } from \"@nosto/search-js/preact/legacy\"\n\nexport type FallbackConfig = Pick<FullConfig, \"isCategoryPage\" | \"categoryFallback\" | \"serpFallback\" | \"fallback\">\n\ntype ActionContext = {\n    store: Store\n    config: FullConfig\n}\n\n/**\n * Fallback predicate for Search API errors\n *\n *  Request aborted           -> no fallback\n *  status: 200               -> no fallback\n *  status: 400 (Bad request) -> no fallback\n *\n *  status: 408 (Timeout)     -> fallback\n *  Network Error             -> fallback\n *  status 502 (Bad Gateway)  -> fallback\n *  status 403 (Forbidden)    -> fallback\n *  search for this merchant is not ready yet, status 403 -> fallback\n *  some services are unavailable, response may be incomplete, status 500 -> fallback\n *  timeout exceeded          -> fallback\n */\nexport function shouldFallback(error: unknown) {\n    if (!error) {\n        return false\n    } else if (error.toString().includes(\"Request aborted\")) {\n        return false\n    } else if (typeof error === \"object\" && \"status\" in error && typeof error.status === \"number\") {\n        return ![200, 400].includes(error.status)\n    }\n    return true\n}\n\nexport async function newSearch(context: ActionContext, query: SearchQuery, options?: SearchOptions): Promise<void> {\n    return baseNewSearch(\n        {\n            config: {\n                ...context.config,\n                pageType: context.store.getState().pageType!\n            },\n            store: context.store\n        },\n        query,\n        options\n    )\n}\n\nexport async function updateSearch(context: ActionContext, query: SearchQuery, options?: SearchOptions): Promise<void> {\n    const fullOptions = deepMerge({ customParams: context.store.getState().customParams }, options)\n    return baseUpdateSearch(\n        {\n            config: {\n                ...context.config,\n                pageType: context.store.getState().pageType!\n            },\n            store: context.store\n        },\n        query,\n        fullOptions\n    )\n}\n\nexport function simulateUpdateSearch(\n    context: ActionContext,\n    query: SearchQuery,\n    options?: SearchOptions\n): {\n    url: URL\n} {\n    const fullQuery = deepMerge(context.store.getState().query, { products: { from: 0 } }, query)\n    const fullOptions = deepMerge({ customParams: context.store.getState().customParams }, options)\n\n    return {\n        url: new URL(getFullUrl(getSearchUrl(context, fullQuery, fullOptions)))\n    }\n}\n\nexport function handleFallback(config: FallbackConfig, fullQuery: SearchQuery) {\n    const end = measure(\"handleFallback\")\n    const { isCategoryPage, categoryFallback, serpFallback } = config\n\n    if (isCategoryPage() && categoryFallback) {\n        categoryFallback(fullQuery)\n        return\n    } else if (serpFallback) {\n        serpFallback(fullQuery)\n        return\n    }\n\n    const isErrorSet = setErrorSession()\n    if (isErrorSet) {\n        if (config.fallback === \"legacy\") {\n            location.reload()\n        } else {\n            restoreNativeContent()\n            restoreNativeForm()\n        }\n    }\n    end()\n}\n", "import { i as l } from \"../unique-m1TIDWdl.js\";\nimport { u as r } from \"../jsxRuntime.module-Bzuv3cXw.js\";\nimport { b as p, a as m } from \"../useLoadMore-Der8Cglb.js\";\nimport { p as u } from \"../pick-DReBictn.js\";\nimport { h as d, i as f, I as S } from \"../InfiniteScrollWithObserver-DYKAh87P.js\";\nimport { Fragment as h } from \"preact\";\nimport { S as O, a as W, c as A, d as B } from \"../configContext-GuZOIX3o.js\";\nfunction M({ pageSize: e }) {\n  const { loadMore: o } = p(e);\n  return /* @__PURE__ */ r(\"button\", { onClick: o, children: \"More results\" });\n}\nfunction b({ children: e, loadMoreComponent: o, pageSize: t }) {\n  const { loading: n, query: s, response: i } = m((c) => u(c, \"loading\", \"query\", \"response\")), a = !n && d(s, i);\n  return /* @__PURE__ */ r(h, { children: [\n    e,\n    a && (o ? /* @__PURE__ */ r(o, { pageSize: t }) : /* @__PURE__ */ r(M, { pageSize: t }))\n  ] });\n}\nconst q = !l() && f() ? S : b;\nexport {\n  q as InfiniteScroll,\n  b as InfiniteScrollWithLink,\n  O as StoreContext,\n  W as createExtendableStore,\n  A as createStore,\n  B as defaultState\n};\n", "import { StoreContext } from \"@nosto/search-js/preact/common\"\nimport { useContext } from \"preact/hooks\"\nimport { Store } from \"../state\"\n\n/**\n * Use the store context\n *\n * @group Hooks\n */\nexport function useStore() {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    return useContext(StoreContext) as Store\n}\n", "import { a as y, c as x } from \"../useLoadMore-Der8Cglb.js\";\nimport { b as fe } from \"../useLoadMore-Der8Cglb.js\";\nimport { a as P } from \"../logger-DVwg4Wor.js\";\nimport { useState as L, useCallback as S, useMemo as b, useEffect as O, useRef as T } from \"preact/hooks\";\nimport { s as C } from \"../index.es-B8mbAxS4.js\";\nimport { p as M } from \"../parseNumber-QA48nJLp.js\";\nfunction W(e) {\n  const o = y((t) => t.response);\n  return e && Array.isArray(e) || e && P(e) ? e : o;\n}\nfunction Y(e, o) {\n  var d;\n  const t = ((d = e.data) == null ? void 0 : d.filter((n) => n.selected).length) ?? 0, { active: r } = {\n    active: t > 0,\n    ...o\n  }, [s, a] = L(r), { toggleProductFilter: c } = x(), u = S(() => {\n    a(!s);\n  }, [s]);\n  return {\n    /** Active value */\n    active: s,\n    /** Selected filters count */\n    selectedFiltersCount: t,\n    /** Toggle active function */\n    toggleActive: u,\n    /** Toggle product filter function */\n    toggleProductFilter: c\n  };\n}\nfunction ee() {\n  const { loading: e, facets: o } = y((t) => {\n    var r, s;\n    return {\n      loading: t.loading,\n      facets: ((s = (r = t.response) == null ? void 0 : r.products) == null ? void 0 : s.facets) ?? []\n    };\n  });\n  return {\n    /** Loading state */\n    loading: e,\n    /** Array of facets*/\n    facets: o\n  };\n}\nfunction k(e, o) {\n  const t = o - e;\n  return !isNaN(t) && t > 0 ? new Array(o - e).fill(void 0).map((r, s) => s + e) : [];\n}\nfunction te(e) {\n  const { query: o, products: t } = y((r) => ({\n    query: r.query,\n    products: r.response.products\n  }));\n  return b(() => {\n    var F, w, A;\n    if (!t)\n      return {\n        totalPages: 0,\n        resultsFrom: 0,\n        resultsTo: 0,\n        pages: []\n      };\n    const r = ((F = o.products) == null ? void 0 : F.from) ?? 0, s = (e == null ? void 0 : e.width) ?? 1 / 0, a = Math.max(Math.floor(s - 1) / 2, 1), c = t.size > 0 ? Math.floor(r / t.size) + 1 : 1, u = t.size > 0 ? Math.ceil(t.total / t.size) : 0, d = (R) => R >= c - a && R <= c + a, n = r + 1, l = Math.min(r + t.total, t.total), i = {\n      from: r,\n      page: c,\n      current: !0\n    }, f = (R) => ({\n      from: (R - 1) * t.size,\n      page: R,\n      current: R === c\n    }), p = c > 1 ? f(c - 1) : void 0, g = c < u ? f(c + 1) : void 0, v = c - a - 1 > 1 ? f(1) : void 0, m = c + a + 1 < u ? f(u) : void 0, h = k(1, u + 1).filter(d).map(f);\n    return !v && ((w = h[0]) == null ? void 0 : w.page) === 2 && h.unshift(f(1)), !m && ((A = h[h.length - 1]) == null ? void 0 : A.page) === u - 1 && h.push(f(u)), {\n      totalPages: u,\n      resultsFrom: n,\n      resultsTo: l,\n      current: i,\n      prev: p,\n      next: g,\n      first: v,\n      last: m,\n      pages: h\n    };\n  }, [o, t, e == null ? void 0 : e.width]);\n}\nfunction ne() {\n  const [e, o] = L([]), [t, r] = L([]);\n  return O(() => {\n    C(async (s) => {\n      const { products: a, segments: c } = await s.getSearchSessionParams();\n      o(c ?? []), r((a == null ? void 0 : a.personalizationBoost) ?? []);\n    });\n  }, []), {\n    segments: e,\n    boost: t\n  };\n}\nfunction q() {\n  const { facets: e } = y((n) => {\n    var l;\n    return {\n      facets: ((l = n.response.products) == null ? void 0 : l.facets) ?? []\n    };\n  }), { replaceFilter: o, toggleProductFilter: t } = x(), r = S(\n    (n) => {\n      const l = e == null ? void 0 : e.find((i) => i.type === \"stats\" && i.field === n);\n      if (l && \"min\" in l && \"max\" in l)\n        return l;\n    },\n    [e]\n  ), s = S(\n    (n) => {\n      var l;\n      return ((l = e == null ? void 0 : e.find((i) => i.field === n)) == null ? void 0 : l.name) ?? n;\n    },\n    [e]\n  ), a = S((n) => \"field\" in n && (n.value instanceof Array || n.range instanceof Array), []), c = S((n) => {\n    var l;\n    return {\n      ...n,\n      range: (l = n.range) == null ? void 0 : l.map((i) => ({\n        gt: i.gt ? Number(i.gt) : i.gt,\n        gte: i.gte ? Number(i.gte) : i.gte,\n        lt: i.lt ? Number(i.lt) : i.lt,\n        lte: i.lte ? Number(i.lte) : i.lte\n      }))\n    };\n  }, []), u = S(\n    (n) => (n.value ?? []).map((i) => ({\n      value: i,\n      field: n.field,\n      name: s(n.field),\n      filter: c(n),\n      remove: () => {\n        t(n.field, i, !1);\n      }\n    })),\n    [c, s, t]\n  ), d = S(\n    (n) => (n.range ?? []).map((i) => {\n      var g, v;\n      const f = i.gte ?? i.gt ?? ((g = r(n.field)) == null ? void 0 : g.min), p = i.lte ?? i.lt ?? ((v = r(n.field)) == null ? void 0 : v.max);\n      if (f !== void 0 && p !== void 0)\n        return {\n          value: `${f} - ${p}`,\n          field: n.field,\n          name: s(n.field),\n          filter: c(n),\n          remove: () => {\n            o(n.field, void 0);\n          }\n        };\n    }).filter(Boolean),\n    [c, r, s, o]\n  );\n  return {\n    selectFilters: a,\n    toValueFilter: u,\n    toRangeFilter: d\n  };\n}\nfunction j() {\n  const { filter: e } = y((u) => {\n    var d;\n    return {\n      filter: ((d = u.query.products) == null ? void 0 : d.filter) ?? []\n    };\n  }), { updateSearch: o } = x(), { selectFilters: t, toValueFilter: r, toRangeFilter: s } = q(), a = b(() => e ? e.filter(t).flatMap((u) => \"value\" in u ? r(u) : \"range\" in u ? s(u) : []).filter(Boolean) : [], [e, t, s, r]), c = S(() => {\n    o({\n      products: {\n        filter: []\n      }\n    });\n  }, [o]);\n  return {\n    /** Selected filters array. */\n    filters: a,\n    /** Should remove all selected filters. */\n    removeAll: c\n  };\n}\nfunction V(e) {\n  var i, f, p;\n  const { replaceFilter: o } = x(), { query: t, products: r } = y((g) => ({\n    query: g.query,\n    products: g.response.products\n  })), s = (i = r == null ? void 0 : r.facets) == null ? void 0 : i.find((g) => g.id === e);\n  if (!s)\n    return {\n      min: 0,\n      max: 0,\n      range: [0, 0],\n      updateRange: () => {\n      }\n    };\n  const a = (p = (f = t.products) == null ? void 0 : f.filter) == null ? void 0 : p.find((g) => g.field === s.field), c = a != null && a.range ? a.range[0] : void 0, u = typeof c == \"object\" && (\"gte\" in c || \"lte\" in c) ? [M(c.gte), M(c.lte)] : [void 0, void 0], d = \"min\" in s ? Math.floor(s.min) : 0, n = \"max\" in s ? Math.ceil(s.max) : 0, l = ([g, v]) => {\n    const m = g !== void 0 ? Math.floor(g) : void 0, h = v !== void 0 ? Math.ceil(v) : void 0, F = m !== void 0, w = h !== void 0;\n    (d === m || !F) && (n === h || !w) ? o(s.field, void 0) : (d === m || !F) && w ? o(s.field, {\n      lte: h.toString()\n    }) : (n === h || !w) && F ? o(s.field, {\n      gte: m.toString()\n    }) : F && w && o(s.field, {\n      gte: m.toString(),\n      lte: h.toString()\n    });\n  };\n  return {\n    /** Min value */\n    min: d,\n    /** Max value */\n    max: n,\n    /** Range value */\n    range: [u[0] ?? d, u[1] ?? n],\n    /** Update range function */\n    updateRange: l\n  };\n}\nfunction re(e, o) {\n  const { min: t, max: r, range: s, updateRange: a } = V(e), { filters: c } = j(), u = b(() => {\n    var v;\n    const i = c.find((m) => {\n      var h;\n      return (h = m == null ? void 0 : m.filter) == null ? void 0 : h.range;\n    });\n    let f = null;\n    if (i) {\n      const m = (v = i.filter.range) == null ? void 0 : v[0];\n      f = [M(m == null ? void 0 : m.gte), M(m == null ? void 0 : m.lte)];\n    }\n    const p = [];\n    let g = Math.floor(t / o) * o;\n    for (; g < r; ) {\n      const m = g + o, h = f && f[0] === g && f[1] === m;\n      p.push({\n        min: g,\n        max: m,\n        selected: h\n      }), g = m;\n    }\n    return p;\n  }, [c, t, r, o]), d = (i) => {\n    a([i, s[1]]);\n  }, n = (i) => {\n    a([s[0], i]);\n  }, l = t !== s[0] || r !== s[1];\n  return {\n    /** Minimum value */\n    min: t,\n    /** Maximum value */\n    max: r,\n    /** Range value */\n    range: s,\n    /** Update range function */\n    updateRange: a,\n    /** Ranges */\n    ranges: u,\n    /** Handle min change */\n    handleMinChange: d,\n    /** Handle max change */\n    handleMaxChange: n,\n    /** Is selected */\n    isSelected: l\n  };\n}\nfunction se() {\n  const { products: e, keywords: o } = y((t) => t.response);\n  return {\n    /** Array of products */\n    products: e ?? { hits: [], total: 0 },\n    /** Array of keywords */\n    keywords: o ?? { hits: [], total: 0 }\n  };\n}\nfunction oe() {\n  const e = y((t) => {\n    var r;\n    return (r = t.query.products) == null ? void 0 : r.filter;\n  });\n  return b(() => e ? e.reduce((t, r) => t + (Array.isArray(r.value) ? r.value.length : 1), 0) : 0, [e]);\n}\nfunction z(e) {\n  return e && !Number.isNaN(e) ? e : 0;\n}\nfunction ie(e, o) {\n  const { from: t, size: r, total: s } = y((n) => {\n    var l, i, f, p, g;\n    return {\n      from: z(((l = n.query.products) == null ? void 0 : l.from) ?? 0),\n      size: z(((f = (i = n.response) == null ? void 0 : i.products) == null ? void 0 : f.size) ?? 0),\n      total: z(((g = (p = n.response) == null ? void 0 : p.products) == null ? void 0 : g.total) ?? 0)\n    };\n  }), { updateSearch: a } = x(), c = t + r, u = [...e].reverse().filter((n) => n + o < s);\n  return {\n    /** from value */\n    from: t,\n    /** to value */\n    to: c,\n    /** total value */\n    total: s,\n    /** size value */\n    size: r,\n    /** Array of size options */\n    sizeOptions: u,\n    /** Should be called when size is changed */\n    handleSizeChange: (n) => {\n      a({\n        products: {\n          size: M(n)\n        }\n      });\n    }\n  };\n}\nfunction B(e, o) {\n  return e.length !== o.length ? !1 : e.every((t) => o.find((r) => t.field === r.field && t.order === r.order));\n}\nfunction ce(e) {\n  var a, c;\n  const o = y((u) => u.query), { updateSearch: t } = x();\n  return {\n    /** Active sort */\n    activeSort: ((a = e.find((u) => {\n      var d;\n      return B(u.value.sort, ((d = o.products) == null ? void 0 : d.sort) || []);\n    })) == null ? void 0 : a.id) ?? ((c = e[0]) == null ? void 0 : c.id),\n    /** Set sort function */\n    setSort: (u) => {\n      const d = e.find((n) => n.id === u);\n      d && t({\n        products: {\n          sort: d.value.sort\n        }\n      });\n    }\n  };\n}\nconst X = window.SpeechRecognition || window.webkitSpeechRecognition, D = !!(X && typeof X == \"function\");\nfunction E() {\n  return {\n    listening: !1,\n    startListening: () => {\n    },\n    stopListening: () => {\n    }\n  };\n}\nfunction U({\n  language: e = \"en-US\",\n  interimResults: o = !1,\n  onResult: t,\n  onError: r\n} = {}) {\n  const [s, a] = L(!1), c = T(null), u = S(() => {\n    const n = new X();\n    n.lang = e, n.interimResults = o, n.onstart = () => a(!0), t && (n.onresult = (l) => {\n      var f, p;\n      const { transcript: i } = (p = (f = l.results) == null ? void 0 : f[0]) == null ? void 0 : p[0];\n      t(i);\n    }), r && (n.onerror = (l) => r(l.error)), n.onend = () => a(!1), c.current = n, n.start();\n  }, [e, o, r, t]), d = S(() => {\n    var n;\n    (n = c.current) == null || n.stop();\n  }, [c]);\n  return {\n    listening: s,\n    startListening: u,\n    stopListening: d\n  };\n}\nconst ae = D ? U : E;\nfunction _(e, o) {\n  if (!e.length || !o.length) return [];\n  const t = o.reduce((r, s) => (r[s] = {}, r), {});\n  return e.forEach((r) => {\n    var s;\n    (s = r.customFields) == null || s.forEach(({ key: a, value: c }) => {\n      const u = a.toLowerCase();\n      o.includes(u) && (t[u][c] = t[u][c] || [], t[u][c].push(r));\n    });\n  }), Object.entries(t).filter((r) => Object.keys(r[1]).length).map(([r, s]) => ({\n    field: r,\n    options: Object.entries(s).map(([a, c]) => ({\n      value: a,\n      skus: c,\n      unavailable: !1,\n      selected: !1\n    }))\n  }));\n}\nfunction $(e, o) {\n  return e.length ? e.map(({ field: t, options: r }) => ({\n    field: t,\n    options: r.map((s) => {\n      var u;\n      const a = !((u = s.skus) != null && u.some((d) => Object.entries(o).every(([n, l]) => {\n        var f, p;\n        return n === t ? !0 : ((p = (f = d.customFields) == null ? void 0 : f.find((g) => g.key.toLowerCase() === n)) == null ? void 0 : p.value) === l;\n      }))), c = o[t] === s.value;\n      return {\n        ...s,\n        unavailable: a,\n        selected: c\n      };\n    })\n  })) : [];\n}\nconst N = [\"4XS\", \"3XS\", \"2XS\", \"XXS\", \"XS\", \"S\", \"M\", \"L\", \"XL\", \"XXL\", \"2XL\", \"XXXL\", \"3XL\", \"4XL\"];\nfunction I(e) {\n  if (N.includes(e))\n    return 1e3 + N.indexOf(e);\n  const o = parseFloat(e);\n  return isNaN(o) ? e : o;\n}\nfunction Z(e, o) {\n  return [...o].sort((t, r) => {\n    const [s, a] = [t.value, r.value].map(I);\n    return s < a ? -1 : 1;\n  });\n}\nfunction ue(e = [], o = []) {\n  const [t, r] = L({}), s = b(() => _(e, o).map(({ field: n, options: l }) => ({\n    field: n,\n    options: Z(n, l)\n  })), [e, o]), a = b(() => $(s, t), [s, t]), c = S((d, n) => {\n    r((l) => {\n      const i = { ...l };\n      return i[d] === n ? delete i[d] : i[d] = n, i;\n    });\n  }, []), u = b(() => Object.keys(t).filter((l) => t[l]).length === 0 ? [] : a.filter(({ field: l }) => t[l]).map(({ field: l, options: i }) => {\n    const f = t[l], p = i.find((g) => g.value === f);\n    return (p == null ? void 0 : p.skus) ?? [];\n  }).reduce((l, i) => l.filter((f) => i.includes(f))), [a, t]);\n  return { swatches: a, toggleOption: c, matchedSkus: u };\n}\nexport {\n  D as speechToTextSupported,\n  x as useActions,\n  W as useDecoratedSearchResults,\n  Y as useFacet,\n  ee as useFacets,\n  fe as useLoadMore,\n  y as useNostoAppState,\n  te as usePagination,\n  ne as usePersonalization,\n  j as useProductFilters,\n  V as useRange,\n  re as useRangeSelector,\n  se as useResponse,\n  oe as useSelectedFiltersCount,\n  ie as useSizeOptions,\n  ce as useSort,\n  ae as useSpeechToText,\n  ue as useSwatches\n};\n", "import { useConfig } from \"./useConfig\"\nimport { newSearch, simulateUpdateSearch, updateSearch } from \"../actions\"\nimport { useStore } from \"./useStore\"\nimport { useActions as useBaseActions } from \"@nosto/search-js/preact/hooks\"\nimport { SearchQuery, SearchOptions } from \"../api\"\nimport type { InputSearchRangeFilter } from \"@nosto/nosto-js/client\"\n\n/**\n * Preact hook that import current actions to the component.\n * Actions should be used to modify state, making new searches, etc.\n *\n * **Should always be at the top of the component!**\n *\n * @example\n * ```jsx\n * import { useActions } from '@nosto/preact'\n *\n * export default () => {\n *     const { newSearch } = useActions()\n *\n *     return <button onClick={() => {\n *         newSearch({\n *             query: {\n *                 query: \"samsung\"\n *             }\n *         })\n *     }}>\n *         Search for \"samsung\"\n *     </button>\n * }\n * ```\n *\n * @group Hooks\n */\nexport function useActions() {\n    const context = {\n        config: useConfig(),\n        store: useStore()\n    }\n\n    const { toggleProductFilter, replaceFilter } = useBaseActions()\n\n    return {\n        updateSearch(query: SearchQuery, options?: SearchOptions) {\n            return updateSearch(context, query, options)\n        },\n        newSearch(query: SearchQuery, options?: SearchOptions) {\n            return newSearch(context, query, options)\n        },\n        toggleProductFilter(field: string, value: string, active: boolean) {\n            return toggleProductFilter(field, value, active)\n        },\n        replaceFilter(field: string, value: InputSearchRangeFilter | string | undefined) {\n            return replaceFilter(field, value)\n        },\n        simulateUpdateSearch(query: SearchQuery, options?: SearchOptions) {\n            return simulateUpdateSearch(context, query, options)\n        }\n    }\n}\n", "import { useEffect, useState } from \"preact/hooks\"\nimport { State } from \"../state\"\nimport { useStore } from \"./useStore\"\n\n/**\n * Preact hook that imports a part of current state to the component.\n *\n * This hook is preferred over useAppState.\n * Unlike useAppState, useAppStateSelector will only trigger a component render when the selected value changes.\n *\n * @example\n * ```jsx\n * import { useAppStateSelector } from '@nosto/preact'\n *\n * export default () => {\n *     const query = useAppStateSelector(state => state.query)\n *\n *     return <div>\n *         Searching for {query.query}\n *     </div>\n * }\n * ```\n *\n * @group Hooks\n */\nexport function useAppStateSelector<Selected>(selector: (state: State) => Selected): Selected {\n    const store = useStore()\n    const [slice, setSlice] = useState(selector(store.getState()))\n    store.onChange(selector, setSlice)\n    useEffect(() => {\n        return () => store.clearOnChange(setSlice)\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n    return slice\n}\n", "import { useAppStateSelector } from \"./useAppStateSelector\"\n\n/**\n * Preact hook that import current state to the component.\n *\n * **Should always be at the top of the component!**\n *\n * See also: [useAppStateSelector](./useAppStateSelector.ts)\n *\n * @example\n * ```jsx\n * import { useAppState } from '@nosto/preact'\n *\n * export default () => {\n *     const { query } = useAppState()\n *\n *     return <div>\n *         Searching for {query.query}\n *     </div>\n * }\n * ```\n *\n * @group Hooks\n * @deprecated Use `useAppStateSelector` instead.\n */\nexport function useAppState() {\n    return useAppStateSelector(state => state)\n}\n", "import { usePagination as useBasePagination } from \"@nosto/search-js/preact/hooks\"\n\nexport type Page = {\n    from: number\n    page: number\n    current: boolean\n}\n\n/**\n * Preact hook that import pagination state to the component.\n *\n * **Should always be at the top of the component!**\n *\n * @example\n * ```jsx\n * import { usePagination } from '@nosto/preact'\n *\n * export default () => {\n *     const { pages } = usePagination()\n *\n *     return pages.map((page) => <li>\n *         {page.current ? <span>{page.page}</span> : <a>\n *             {page.page}\n *         </a>}\n *     </li>)\n * }\n * ```\n *\n * @group Hooks\n */\nexport function usePagination(options?: { width?: number }): {\n    totalPages: number\n    resultsFrom: number\n    resultsTo: number\n    current?: Page\n    prev?: Page\n    next?: Page\n    first?: Page\n    last?: Page\n    pages: Page[]\n} {\n    return useBasePagination(options)\n}\n", "import { InputSearchFilter } from \"@nosto/nosto-js/client\"\nimport { useProductFilters as useBaseProductFilters } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * Preact hook that import product facets state to the component.\n *\n * **Should always be at the top of the component!**\n * @example\n * ```jsx\n * import { useProductFilters, useActions } from '@nosto/preact'\n *\n * export default () => {\n *     const { filters } = useProductFilters()\n *     const { toggleProductFilter } = useActions()\n *\n *     return filters.map((filter) => <li>\n *         <button\n *              title=\"Remove Filter\"\n *              onClick={(e) => {\n *                  e.preventDefault()\n *                  toggleProductFilter(\n *                      filter.field,\n *                      filter.value,\n *                      false\n *                  )\n *              }}\n *          >\n *             {filter.filter}: {filter.value}{' '}\n *             <span>&#10005;</span>\n *          </button>\n *     </li>)\n * }\n * ```\n *\n * @group Hooks\n */\nexport function useProductFilters(): {\n    /** Selected filters array. */\n    filters: (\n        | {\n              value: string\n              field: string\n              name: string\n              filter: {\n                  range:\n                      | {\n                            gt: string | number | undefined\n                            gte: string | number | undefined\n                            lt: string | number | undefined\n                            lte: string | number | undefined\n                        }[]\n                      | undefined\n                  all?: InputSearchFilter[]\n                  any?: InputSearchFilter[]\n                  excludeFacets?: string[]\n                  field?: string\n                  hasValue?: boolean\n                  not?: InputSearchFilter[]\n                  prefix?: string[]\n                  value?: string[]\n              }\n              remove: () => void\n          }\n        | undefined\n    )[]\n    /** Should remove all selected filters. */\n    removeAll: () => void\n} {\n    return useBaseProductFilters()\n}\n", "import { useRangeSelector as useBaseRangeSelector } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * Get range selector state\n * @param id - Id of the range Selector\n * @example\n * ```jsx\n * import { useRangeCheckboxes } from \"@nosto/preact\"\n * import { useState } from \"preact/hooks\"\n * import RadioButton from \"./elements/RadioButton\"\n * import RangeInput from \"./elements/RangeInput\"\n *\n * export default function RangeSelector({ facet }) {\n *     const {\n *         min,\n *         max,\n *         range,\n *         ranges,\n *         updateRange,\n *         handleMinChange,\n *         handleMaxChange,\n *         isSelected,\n *     } = useRangeSelector(facet.id, 100)\n *\n *     return (\n *         <li>\n *             <div>\n *                 <ul>\n *                     {ranges.map(({ min, max, selected }, index) => {\n *                         return (\n *                             <li>\n *                                 <RadioButton\n *                                     key={index}\n *                                     value={`${min} - ${max}`}\n *                                     selected={selected}\n *                                     onChange={() => updateRange([min, max])}\n *                                 />\n *                             </li>\n *                         )\n *                     })}\n *                     <div>\n *                         <div>\n *                             <label htmlFor={`ns-${facet.id}-min`}>\n *                                 Min.\n *                             </label>\n *                             <RangeInput\n *                                 id={`ns-${facet.id}-min`}\n *                                 min={min}\n *                                 max={max}\n *                                 range={range}\n *                                 value={range[0] ?? min}\n *                                 onChange={e => handleMinChange(parseFloat(e.currentTarget.value) || min)}\n *                             />\n *                         </div>\n *                         <div>\n *                             <label htmlFor={`ns-${facet.id}-max`}>\n *                                 Max.\n *                             </label>\n *                             <RangeInput\n *                                 id={`ns-${facet.id}-max`}\n *                                 min={min}\n *                                 max={max}\n *                                 range={range}\n *                                 value={range[1] ?? max}\n *                                 onChange={e => handleMaxChange(parseFloat(e.currentTarget.value) || max)}\n *                             />\n *                         </div>\n *                     </div>\n *                 </ul>\n *             </div>\n *         </li>\n *     )\n * }\n *\n *```\n *\n * @group Hooks\n */\nexport function useRangeSelector(\n    id: string,\n    rangeSize: number\n): {\n    /** Minimum value */\n    min: number\n    /** Maximum value */\n    max: number\n    /** Range value */\n    range: number[]\n    /** Update range function */\n    updateRange: ([from, to]: [number | undefined, number | undefined]) => void\n    /** Ranges */\n    ranges: {\n        min: number\n        max: number\n        selected: boolean | null\n    }[]\n    /** Handle min change */\n    handleMinChange: (value: number) => void\n    /** Handle max change */\n    handleMaxChange: (value: number) => void\n    /** Is selected */\n    isSelected: boolean\n} {\n    return useBaseRangeSelector(id, rangeSize)\n}\n", "import { useRange as useBaseRange } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * A hook that returns range information and functions to update the range.\n * `useRangeSlider` is an alias of `useRange`, maintained for backward compatibility with older implementations that uses sliders.\n *\n * @param id - The identifier for the specific range facet.\n * @returns An object containing range information and functions to update the range.\n *\n * @example\n * General usage with `useRange`:\n * ```jsx\n * import { useRange } from \"./useRange\";\n * import { useState } from \"react\";\n *\n * const Component = ({ facetId }) => {\n *   const { min, max, range, updateRange } = useRange(facetId);\n *\n *   return (\n *     <div>\n *       Current Range: {range[0]} to {range[1]}\n *       <button onClick={() => updateRange([min, max])}>Reset Range</button>\n *     </div>\n *   );\n * };\n * ```\n *\n * Usage with `useRangeSlider` for slider components (backward compatibility):\n * ```jsx\n * import { RangeSlider, useRangeSlider } from \"@nosto/preact\"\n * import { useState } from \"preact/hooks\"\n * import RangeInput from \"./elements/RangeInput\"\n *\n * const RangeFacet = ({ facet }) => {\n *   const { min, max, range, updateRange } = useRangeSlider(facet.id);\n *\n *   return (\n *     <li>\n *       <div>\n *         <div>\n *           <label>Min.</label>\n *           <RangeInput\n *             min={min}\n *             max={max}\n *             value={range[0]}\n *             onChange={e => updateRange([parseFloat(e.currentTarget.value) || undefined, range[1]])}\n *           />\n *           <label>Max.</label>\n *           <RangeInput\n *             min={min}\n *             max={max}\n *             value={range[1]}\n *             onChange={e => updateRange([range[0], parseFloat(e.currentTarget.value) || undefined])}\n *           />\n *         </div>\n *         <RangeSlider id={facet.id} />\n *       </div>\n *     </li>\n *   );\n * };\n * ```\n */\n\nexport function useRange(id: string): {\n    /** Min value */\n    min: number\n    /** Max value */\n    max: number\n    /** Range value */\n    range: number[]\n    /** Update range function */\n    updateRange: ([from, to]: [number | undefined, number | undefined]) => void\n} {\n    return useBaseRange(id)\n}\n", "import type { SearchTermsFacet } from \"@nosto/nosto-js/client\"\nimport { useFacet as useBaseFacet, UseFacetOptions } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * Preact hook that import facet state to the component.\n * @param facet\n * @example\n * ```jsx\n * import { useFacet } from '@nosto/preact'\n *\n * export default () => {\n *     const { active, selectedFiltersCount, toggleActive, toggleProductFilter } = useFacet(facet)\n *     return (\n *         <li class={`ns-sidebar-dropdown ${active ? \"ns-active\" : \"\"}`}>\n *             <span\n *                 onClick={toggleActive}\n *             >\n *                 <span>{facet.name}</span>\n *                 {selectedFiltersCount > 0 && (\n *                     <span>{selectedFiltersCount}</span>\n *                 )}\n *             </span>\n *             <div>\n *                 <ul>\n *                     {facet.data?.map(value => (\n *                         <li key={value.value}>\n *                             <label>\n *                                 {value.value}\n *                                 <input\n *                                     type=\"checkbox\"\n *                                     checked={value.selected}\n *                                     onChange={e => {\n *                                         e.preventDefault()\n *                                         toggleProductFilter(\n *                                             facet.field,\n *                                             value.value,\n *                                             !value.selected\n *                                         )\n *                                     }}\n *                                 />\n *                             </label>\n *                             <span>{value.count}</span>\n *                         </li>\n *                     ))}\n *                 </ul>\n *             </div>\n *         </li>\n *     );\n * }\n * ```\n * @group Hooks\n */\nexport function useFacet(\n    facet: SearchTermsFacet,\n    options?: UseFacetOptions\n): {\n    active: boolean\n    selectedFiltersCount: number\n    toggleActive: () => void\n    toggleProductFilter: (field: string, value: string, active: boolean) => Promise<void>\n} {\n    return useBaseFacet(facet, options)\n}\n", "import { useSelectedFiltersCount as useBaseSelectedFiltersCount } from \"@nosto/search-js/preact/hooks\"\n/**\n * @group Hooks\n * @returns The number of selected filters.\n * @example\n * ```jsx\n * import { useSelectedFiltersCount } from '@nosto/preact'\n * export default () => {\n *    const selectedFiltersCount = useSelectedFiltersCount()\n *    return (\n *        <div>\n *            {selectedFiltersCount} filters selected\n *        </div>\n *    )\n * }\n * ```\n */\nexport function useSelectedFiltersCount(): number {\n    return useBaseSelectedFiltersCount()\n}\n", "import { useSort as useBaseSort } from \"@nosto/search-js/preact/hooks\"\nimport { SortOption } from \"../sorting\"\n\n/**\n * Preact hook that import sort state to the component.\n * @param sortOptions\n * @example\n * ```jsx\n * import { useSort } from '@nosto/preact'\n * import { sortOptions } from '../config'\n *\n * export default () => {\n *    const { activeSort, setSort } = useSort(sortOptions)\n *\n *    const handleSortChange = (event) => {\n *        setSort(event.target.value)\n *    }\n *\n *    return (\n *        <div>\n *            <select\n *                value={activeSort}\n *                onChange={e => setSort(e.target.value)}\n *            >\n *                {sortOptions.map(option => (\n *                    <option key={option.id} value={option.id}>\n *                        {option.value.name}\n *                    </option>\n *                ))}\n *            </select>\n *        </div>\n *    )\n * }\n * ```\n * @group Hooks\n */\nexport function useSort(sortOptions: SortOption[]): {\n    /** Active sort */\n    activeSort: string\n    /** Set sort function */\n    setSort: (sortId: string) => void\n} {\n    return useBaseSort(sortOptions)\n}\n", "import { useSizeOptions as useBaseSizeOptions } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * Preact hook that import size options to the component.\n * @param sizes\n * @param serpSize\n * @example\n * ```jsx\n * import { useSizeOptions } from \"@nosto/preact\"\n * import { defaultConfig, sizes } from \"../config\"\n *\n * export default () => {\n *    const { from, to, size, total, handleSizeChange, sizeOptions } = useSizeOptions(sizes, defaultConfig.serpSize)\n *\n * return (\n *  <div>\n *    <div>\n *      {from} - {total < to ? total : to} of {total} items\n *    </div>\n *     {sizeOptions.length > 0 && (\n *      <div>\n *        <select\n *          value={size}\n *          onChange={e => handleSizeChange(e.target.value)}\n *        >\n *          {sizeOptions.map(v => (\n *            <option value={v}>{v} items per page</option>\n *          ))}\n *        </select>\n *      </div>\n *    )}\n *  </div>\n *  )\n * }\n * ```\n * @group Hooks\n */\nexport function useSizeOptions(\n    sizes: number[],\n    serpSize: number\n): {\n    /** from value */\n    from: number\n    /** to value */\n    to: number\n    /** total value */\n    total: number\n    /** size value */\n    size: number\n    /** Array of size options */\n    sizeOptions: number[]\n    /** Should be called when size is changed */\n    handleSizeChange: (size: number) => void\n} {\n    return useBaseSizeOptions(sizes, serpSize)\n}\n", "import { SearchFacet } from \"@nosto/nosto-js/client\"\nimport { useFacets as useBaseFacets } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * Preact hook that import facets to the component.\n * @example\n * ```jsx\n * import { useFacets } from '@nosto/preact'\n * import { defaultConfig } from \"../config\"\n *\n * export default () => {\n *   const { loading, facets } = useFacets()\n *\n *   return (\n *     <div style={loading ? \"opacity: 0.3;\" : \"\"}>\n *       <div>\n *         <ul>\n *           {facets.map(facet => {\n *             switch (facet.type) {\n *               case \"terms\":\n *                 return <Facet facet={facet} />\n *               case \"stats\":\n *                 return <RangeFacet facet={facet} />\n *               default:\n *                 return null\n *             }\n *           })}\n *         </ul>\n *       </div>\n *     </div>\n *   )\n * }\n * ```\n * @group Hooks\n *\n */\nexport function useFacets(): { loading: boolean; facets: SearchFacet[] } {\n    return useBaseFacets()\n}\n", "import type { SearchKeywords, SearchProducts } from \"@nosto/nosto-js/client\"\nimport { useResponse as useBaseResponse } from \"@nosto/search-js/preact/hooks\"\n\n/**\n * Preact hook that imports response data to the component.\n * @example\n * ```jsx\n * import { useResponse } from '@nosto/preact'\n * import { defaultConfig } from \"../config\"\n *\n * export default () => {\n *   const { products, keywords } = useResponse()\n *   return (\n *     <div>\n *       <div>\n *         {keywords.hits.length > 0 && (\n *           <div>\n *             <div>\n *               Keywords\n *             </div>\n *             <div>\n *               <Keywords\n *                 hits={keywords.hits}\n *                 keywordComponent={Keyword}\n *                 elementComponent={Element}\n *                 keywordInCategoryComponent={KeywordInCategory}\n *               />\n *             </div>\n *             {!products.hits.length && <SubmitButton />}\n *           </div>\n *         )}\n *         {products.hits.length > 0 && (\n *           <div>\n *             <div>\n *               Products\n *             </div>\n *             <div>\n *               {products.hits.map(hit => {\n *                 return (\n *                   <AutocompleteElement hit={hit}>\n *                     <div\n *                       data-url={hit.url}\n *                       data-nosto-element=\"product\"\n *                     >\n *                       <img\n *                         src={hit.imageUrl ?? productImagePlaceholder}\n *                         alt={hit.name}\n *                       />\n *                       <div>\n *                         {hit.brand && (\n *                           <div>{hit.brand}</div>\n *                         )}\n *                         <div>\n *                           {hit.name}\n *                         </div>\n *                         <div>\n *                           <span>{formatCurrency(hit.price)}</span>\n *                           {hit.listPrice && hit.listPrice > hit.price && (\n *                             <span>\n *                               {formatCurrency(hit.listPrice)}\n *                             </span>\n *                           )}\n *                         </div>\n *                       </div>\n *                     </div>\n *                   </AutocompleteElement>\n *                 )\n *               })}\n *             </div>\n *             <SubmitButton />\n *           </div>\n *         )}\n *       </div>\n *     </div>\n *   )\n * }\n * ```\n * @group Hooks\n *\n */\nexport function useResponse(): { products: SearchProducts; keywords: SearchKeywords } {\n    return useBaseResponse()\n}\n", "import { useActions } from \"./useActions\"\nimport { useAppStateSelector } from \"./useAppStateSelector\"\nimport { pick } from \"@nosto/search-js/utils\"\n\n/**\n * @hidden\n * Preact hook that import simplified pagination to the component.\n * @example\n *\n * ```jsx\n * import { useSimplePagination } from \"@nosto/preact\"\n * import { Icon } from \"./elements\"\n *\n * export default () => {\n *  const { hasPrev, hasNext, goToPrev, goToNext } = useSimplePagination()\n *\n *     return (\n *         <ul class=\"ns-d-flex ns-flex-wrap ns-justify-content-center ns-list-unstyled ns-m-0 ns-p-0 ns-my-2 ns-mx-0\">\n *             {hasPrev && (\n *                 <a\n *                     onClick={goToPrev}\n *                     disabled={!hasPrev}\n *                     class=\"ns-page-link ns-d-block ns-previous ns-relative ns-text-undecorated ns-clickable ns-py-2 ns-px-4 ns-color-black ns-border-radius-3\"\n *                 >\n *                     <Icon name=\"arrow\" />\n *                </a>\n *             )}\n *              //TO DO: use lower level element for page link\n *             {hasNext && (\n *                 <a\n *                     onClick={goToNext}\n *                     disabled={!hasNext}\n *                     class=\"ns-page-link ns-d-block ns-next ns-relative ns-text-undecorated ns-clickable ns-py-2 ns-px-4 ns-color-black ns-border-radius-3\"\n *                 >\n *                     <Icon name=\"arrow\" />\n *                 </a>\n *             )}\n *         </ul>\n *     )\n * }\n * ```\n * @group Hooks\n */\n\nexport function useSimplePagination(): {\n    hasPrev: boolean\n    hasNext: boolean\n    goToPrev: () => void\n    goToNext: () => void\n} {\n    const { query, response } = useAppStateSelector(state => pick(state, \"query\", \"response\"))\n    const { updateSearch } = useActions()\n\n    //TO DO: use hasMoreResults field from response which is not yet implemented\n    const hasNextPage = true\n\n    if (!response?.products) {\n        return {\n            hasPrev: false,\n            hasNext: false,\n            goToPrev: () => {},\n            goToNext: () => {}\n        }\n    }\n\n    const from = query.products?.from ?? 0\n    const pageSize = response.products.size!\n\n    const hasPrev = from > 0\n    const hasNext = hasNextPage || response.products.hits.length >= pageSize\n\n    const goToPrev = () => {\n        if (hasPrev) {\n            const newFrom = Math.max(0, from - pageSize)\n            updateSearch({ products: { from: newFrom } })\n            scrollTo(0, 0)\n        }\n    }\n\n    const goToNext = () => {\n        if (hasNext) {\n            const newFrom = from + pageSize\n            updateSearch({ products: { from: newFrom } })\n            scrollTo(0, 0)\n        }\n    }\n\n    return {\n        hasPrev,\n        hasNext,\n        goToPrev,\n        goToNext\n    }\n}\n", "import { useActions } from \"./useActions\"\nimport { useLoadMore as useBaseLoadMore, useNostoAppState } from \"@nosto/search-js/preact/hooks\"\nimport { getNextPageQuery } from \"@nosto/search-js/preact/legacy\"\n\n/**\n * Hook for loading more results by specified pageSize value\n * @example\n * ```jsx\n *  function LoadMoreButton({ pageSize }) {\n *     const { loadMore, href } = useLoadMore(pageSize)\n *\n *     return (\n *         <a\n *              class=\"ns-load-more-button ns-act-btn ns-act-btn-light\"\n *              onClick={loadMore}\n *              href={href}\n *          >\n *              More results\n *         </a>\n *    )\n * }\n * ```\n * @param pageSize - number of additional products to load (default=24)\n * @group Hooks\n */\nexport function useLoadMore(pageSize = 24) {\n    const { from, size } = useNostoAppState(state => ({\n        from: state.query.products?.from ?? 0,\n        size: state.query.products?.size ?? 0\n    }))\n    const { simulateUpdateSearch } = useActions()\n\n    const { loadMore: loadMoreBase } = useBaseLoadMore(pageSize)\n    const href = simulateUpdateSearch(getNextPageQuery({ from, size, pageSize })).url.toString()\n\n    // Backward compatibility with prevent default, since search-js does not have that\n    function loadMore(event?: MouseEvent) {\n        event?.preventDefault()\n        loadMoreBase()\n    }\n\n    return {\n        loadMore,\n        href\n    }\n}\n", "import { useEffect } from \"preact/hooks\"\nimport { useAppStateSelector } from \"./useAppStateSelector\"\n\n/**\n * A hook that dispatches an event on component load/update.\n * @example\n * useDispatchEventOnLoad(\"nosto:ns-serp\", { sectionId: \"ns-serp\" });\n *\n * return (\n *     <div\n *         class=\"ns-serp ns-d-flex ns-flex-column ns-flex-md-row ns-font-inherit ns-p-4 ns-my-0 ns-mx-auto\"\n *         data-nosto-element=\"search\"\n *     >\n *         // Your content here\n *     </div>\n * );\n * @param type - event name\n * @param payload - event payload\n * @param context - event target, default window\n * @group Hooks\n */\nexport function useDispatchEventOnLoad(\n    type: string,\n    payload: Record<string, string> = {},\n    context: EventTarget = window\n) {\n    const products = useAppStateSelector(state => state.response.products)\n\n    useEffect(() => {\n        const event = new CustomEvent(type, {\n            detail: payload\n        })\n\n        context.dispatchEvent(event)\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [products])\n}\n", "import { useCallback, useMemo } from \"preact/hooks\"\nimport { getCurrencyFormatting } from \"@nosto/search-js/currencies\"\nimport { useConfig } from \"./useConfig\"\n\n/**\n * Preact hook that formats prices based on supplied currency with a fallback to the default currency.\n *\n * @example\n * ```jsx\n * import { useCurrencyFormatting } from '@nosto/preact'\n *\n * export default () => {\n *     const { format } = useCurrencyFormatting()\n *\n *     return (\n *\n *          <div class=\"product product-title\">\n *               <span class=\"correct\">\n *                   {product.name}\n *               </span>\n *           </div>\n *\n *           ...\n *\n *          <div class=\"product price product-price\">\n *              <span>{format(product.listPrice, product.priceCurrencyCode || \"EUR\")}</span>\n *          </div>\n *     )\n * }\n * ```\n *\n * @group Hooks\n */\nexport function useCurrencyFormatting() {\n    const { defaultCurrency } = useConfig()\n    const currencyFormatting = useMemo(getCurrencyFormatting, [])\n\n    const format = useCallback(\n        (value: number, currency?: string) => {\n            return currencyFormatting.formatCurrency(value, currency ?? defaultCurrency)\n        },\n        [currencyFormatting, defaultCurrency]\n    )\n    return { format }\n}\n", "import { s as y } from \"../index.es-B8mbAxS4.js\";\nconst p = {\n  defaultCurrency: \"EUR\",\n  defaultLocale: \"en-US\",\n  /** @hidden  */\n  currencySettings: {}\n}, d = {\n  EUR: \"de-DE\",\n  GBP: \"en-GB\",\n  USD: \"en-US\",\n  AUD: \"en-AU\",\n  CAD: \"en-CA\",\n  //India, Afghanistan, Bangladesh, Bhutan, Myanmar, Nepal, and Pakistan uses lakhs and crores notation\n  INR: \"en-IN\",\n  AFN: \"en-IN\",\n  BDT: \"en-IN\",\n  BTN: \"en-IN\",\n  MMK: \"en-IN\",\n  NPR: \"en-IN\",\n  PKR: \"en-IN\"\n};\nfunction g(i = {}) {\n  const o = {\n    ...p,\n    ...i\n  };\n  i.currencySettings || y((c) => {\n    o.currencySettings = c.internal.getSettings().currencySettings ?? {};\n  });\n  function a(c, n) {\n    const { defaultCurrency: t, currencySettings: r, defaultLocale: u } = o, s = n ?? t, f = d[s] ?? u;\n    if (s in r) {\n      const e = r[s], l = new Intl.NumberFormat(f, {\n        useGrouping: !!e.groupingSeparator,\n        minimumFractionDigits: e.decimalPlaces,\n        maximumFractionDigits: e.decimalPlaces\n      }).formatToParts(c).map((m) => m.type === \"group\" ? e.groupingSeparator : m.type === \"decimal\" ? e.decimalCharacter : m.value).join(\"\");\n      return e != null && e.currencyBeforeAmount ? `${e.currencyToken}${l}` : `${l}${e == null ? void 0 : e.currencyToken}`;\n    }\n    return new Intl.NumberFormat(f, {\n      style: \"currency\",\n      currency: s\n    }).format(c);\n  }\n  return {\n    formatCurrency: a\n  };\n}\nfunction S(i) {\n  const { formatCurrency: o } = g(i);\n  function a(n, t) {\n    const r = {};\n    return n.price !== void 0 && (r.priceText = o(n.price, t)), n.listPrice !== void 0 && (r.listPriceText = o(n.listPrice, t)), Object.assign({}, n, r);\n  }\n  function c(n) {\n    return n.price !== void 0 || n.listPrice !== void 0;\n  }\n  return function(t) {\n    if (!c(t))\n      return t;\n    const r = a(t, t.priceCurrencyCode);\n    return r.skus && r.skus.some(c) && (r.skus = r.skus.map((u) => c(u) ? a(u, t.priceCurrencyCode) : u)), r;\n  };\n}\nexport {\n  g as getCurrencyFormatting,\n  S as priceDecorator\n};\n", "import { Context } from \"preact\"\nimport { PageType } from \"./api/types\"\nimport {\n    defaultState as baseDefaultState,\n    State as BaseState,\n    StoreContext as BaseStoreContext,\n    createExtendableStore\n} from \"@nosto/search-js/preact/common\"\n\n/**\n * Preact state includes all changing variables of the app.\n * After each change page is automatically rerendered.\n * State includes user input, output and other useful things.\n */\nexport interface State extends BaseState {\n    /**\n     * Displays which page type it is - category | search\n     */\n    pageType: PageType | undefined\n    /**\n     * Custom params from URL\n     */\n    customParams: Record<string, unknown>\n}\n\nexport const defaultState: State = {\n    ...baseDefaultState,\n    pageType: undefined,\n    customParams: {}\n}\n\nexport function createStore(overrides: Partial<State>) {\n    const store = createExtendableStore(defaultState, overrides)\n    return {\n        ...store,\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        getInitialState: () => overrides as State\n    }\n}\n\nexport type Store = ReturnType<typeof createStore>\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\nexport const StoreContext = BaseStoreContext as unknown as Context<State>\n", "import { u as n } from \"../jsxRuntime.module-Bzuv3cXw.js\";\nimport { s as l } from \"../index.es-B8mbAxS4.js\";\nimport { u as f, c as p, S as u, C as m } from \"../configContext-GuZOIX3o.js\";\nimport { useCallback as S } from \"preact/hooks\";\nimport { B as C } from \"../BaseElement-IyqEeIiJ.js\";\nimport { d as g, u as d } from \"../baseConfig-Bafl02NY.js\";\nconst h = \"nosto:search:scrollPos\";\nfunction k() {\n  window.sessionStorage.setItem(h, window.scrollY.toString());\n}\nfunction b({ children: e, hit: o, componentProps: r, as: t }) {\n  const { pageType: s } = f(), a = s === \"autocomplete\" ? void 0 : s === \"search\" ? \"serp\" : s, c = S(() => {\n    o && a && l((i) => i.recordSearchClick(a, o)), k();\n  }, [o, a]);\n  return /* @__PURE__ */ n(C, { as: t, onClick: c, componentProps: r, children: e });\n}\nconst v = {\n  ...g,\n  persistentSearchCache: !1,\n  preservePageScroll: !1\n};\nfunction P(e = {}) {\n  return {\n    pageType: \"search\",\n    ...v,\n    ...e\n  };\n}\nfunction I({ config: e, store: o, children: r }) {\n  const t = o ?? p();\n  return d(), /* @__PURE__ */ n(m, { value: P(e), children: /* @__PURE__ */ n(u, { value: t, children: r }) });\n}\nexport {\n  I as SearchPageProvider,\n  b as SerpElement\n};\n", "import { u as b } from \"./jsxRuntime.module-Bzuv3cXw.js\";\nimport { useCallback as h } from \"preact/hooks\";\nfunction d({ onClick: i, as: l, children: u, componentProps: a }) {\n  const C = {\n    ...a,\n    onClick: h(\n      (B) => {\n        var f;\n        i(), (f = a == null ? void 0 : a.onClick) == null || f.call(a, B);\n      },\n      [i, a]\n    )\n  }, k = l ?? (a && \"href\" in a ? \"a\" : \"span\");\n  return /* @__PURE__ */ b(k, { ...C, children: u });\n}\nexport {\n  d as B\n};\n", "import { s as e } from \"./index.es-B8mbAxS4.js\";\nimport { l as t } from \"./logger-DVwg4Wor.js\";\nimport { useEffect as r } from \"preact/hooks\";\nfunction c() {\n  r(() => {\n    const o = window.setTimeout(() => {\n      t.error(\"Nosto client script has not loaded after 3 seconds.\");\n    }, 3e3);\n    e(() => {\n      window.clearTimeout(o);\n    });\n  }, []);\n}\nconst a = {\n  defaultCurrency: \"EUR\",\n  queryModifications: (o) => o\n};\nexport {\n  a as d,\n  c as u\n};\n", "import { u as t } from \"../jsxRuntime.module-Bzuv3cXw.js\";\nimport { c as n, S as c, C as i } from \"../configContext-GuZOIX3o.js\";\nimport { d as s, u as f } from \"../baseConfig-Bafl02NY.js\";\nconst C = {\n  ...s,\n  persistentSearchCache: !1,\n  preservePageScroll: !1\n};\nfunction u(e) {\n  return {\n    pageType: \"category\",\n    ...C,\n    ...e\n  };\n}\nfunction m({ config: e, store: r, children: o }) {\n  const a = r ?? n();\n  return f(), /* @__PURE__ */ t(i, { value: u(e), children: /* @__PURE__ */ t(c, { value: a, children: o }) });\n}\nexport {\n  m as CategoryPageProvider\n};\n", "import { u as c } from \"../jsxRuntime.module-Bzuv3cXw.js\";\nimport { s as m } from \"../index.es-B8mbAxS4.js\";\nimport { useCallback as p } from \"preact/hooks\";\nimport { B as i } from \"../BaseElement-IyqEeIiJ.js\";\nimport { c as l, S as f, C as s } from \"../configContext-GuZOIX3o.js\";\nimport { d as C, u as d } from \"../baseConfig-Bafl02NY.js\";\nfunction B({\n  children: e,\n  hit: o,\n  as: t,\n  componentProps: r\n}) {\n  const n = p(() => {\n    o && \"productId\" in o && m((a) => a.recordSearchClick(\"autocomplete\", o));\n  }, [o]);\n  return /* @__PURE__ */ c(i, { onClick: n, as: t, componentProps: r, children: e });\n}\nfunction I({ as: e, componentProps: o, onSearchInput: t, children: r }) {\n  const n = {\n    ...o,\n    onInput: (u) => {\n      t(u.target);\n    }\n  }, a = e ?? \"input\";\n  return e || (n.type = \"search\"), /* @__PURE__ */ c(a, { ...n, children: r });\n}\nconst g = {\n  ...C,\n  memoryCache: !1\n};\nfunction S(e) {\n  return {\n    pageType: \"autocomplete\",\n    ...g,\n    ...e\n  };\n}\nfunction P({ config: e, store: o, children: t }) {\n  const r = o ?? l();\n  return d(), /* @__PURE__ */ c(s, { value: S(e), children: /* @__PURE__ */ c(f, { value: r, children: t }) });\n}\nexport {\n  B as AutocompleteElement,\n  P as AutocompletePageProvider,\n  I as SearchInput\n};\n", "import { render, h } from \"preact\"\nimport { newSearch } from \"../actions\"\nimport { SearchQuery } from \"../api\"\nimport { FullConfig, ConfigContext, resolveQuery } from \"../config\"\nimport { bindClickOutside, findAll } from \"../helpers/dom\"\nimport { bindInput } from \"../helpers/input\"\nimport { createStore } from \"../state\"\nimport { AutocompleteElementProvider } from \"./components/AutocompleteElement\"\nimport { HistoryElementProvider } from \"./components/HistoryElement\"\nimport { getLocalStorageItem, setLocalStorageItem } from \"../helpers/storage\"\nimport ErrorBoundary from \"../components/ErrorBoundary\"\nimport createDebouncer from \"../utils/debounce\"\nimport { logger, measure, disableNativeAutocomplete } from \"@nosto/search-js/utils\"\nimport { selectorLoaded } from \"../helpers/selectors\"\nimport { extractNativeForm, searchFormNativeClassName } from \"../helpers/searchFallback\"\nimport { isErrorSession } from \"../helpers/errorHandling\"\nimport { resolveCssSelector } from \"../helpers/resolveCssSelector\"\nimport { AutocompleteOptions } from \"./components/types\"\nimport { AutocompletePageProvider } from \"@nosto/search-js/preact/autocomplete\"\n\nexport type AutocompleteHandlers = {\n    onSubmit: (query: SearchQuery, options?: AutocompleteOptions) => void\n}\n\nexport async function initAutocomplete(config: FullConfig, handlers: AutocompleteHandlers) {\n    if (!config.inputCssSelector || isErrorSession()) {\n        return\n    }\n    const end = measure(\"initAutocomplete\")\n\n    if (config.formCssSelector) {\n        await extractNativeForm(config.formCssSelector, config.formUnbindDelay)\n    }\n\n    const store = createStore({\n        pageType: \"autocomplete\",\n        query: resolveQuery(config, \"autocompleteQuery\")\n    })\n\n    const debouncer = createDebouncer(config.debounceDelay)\n\n    const dropdowns = findAll(config.inputCssSelector, HTMLInputElement)\n        .filter(input => !input.form?.classList.contains(searchFormNativeClassName))\n        .map(input => {\n            const dropdown = createDropdown(input, config)\n            const history = createHistory(input, config)\n\n            if (config.speechToTextComponent && config.speechToTextEnabled) {\n                const locationHelperElement = document.createElement(\"div\")\n                locationHelperElement.className = \"ns-autocomplete-voice-position\"\n                input.insertAdjacentElement(\"afterend\", locationHelperElement)\n\n                render(\n                    <ErrorBoundary>\n                        <config.speechToTextComponent onSubmit={query => handlers.onSubmit({ query })} />\n                    </ErrorBoundary>,\n                    locationHelperElement\n                )\n            }\n\n            const storeHistoryState = () => {\n                store.updateState({\n                    historyItems: history.get()\n                })\n            }\n\n            input.setAttribute(\"data-nosto-element\", \"search-input\")\n            storeHistoryState()\n\n            const createHandleSubmit =\n                (element: ReturnType<typeof createDropdown | typeof createHistory>) =>\n                (query: SearchQuery, options?: AutocompleteOptions) => {\n                    handlers.onSubmit(query, options)\n                    element.hide()\n                    if (query.query) {\n                        history.add(query.query)\n                        storeHistoryState()\n                        input.value = query.query\n                    }\n                }\n\n            const shouldUpdateSearch = async (value: string) => {\n                dropdown.hide()\n                const query = store.getState()?.query?.query\n                if (query !== value) {\n                    await newSearch({ config, store }, { query: value })\n                }\n                dropdown.show()\n            }\n\n            disableNativeAutocomplete(input)\n\n            const bind = bindInput(config, input, {\n                onInput: value => {\n                    if (value.length >= config.autocompleteMinLength) {\n                        dropdown.show()\n                        history.hide()\n                        debouncer(async () => {\n                            try {\n                                return await newSearch(\n                                    { config, store },\n                                    {\n                                        query: value\n                                    }\n                                )\n                            } catch (err) {\n                                logger.error(\"New search failed\", err)\n                                return\n                            }\n                        })\n                    } else if (value.length === 0 && config.historyEnabled) {\n                        dropdown.hide()\n                        history.show()\n                    } else {\n                        dropdown.hide()\n                        history.hide()\n                    }\n                },\n                onFocus: async value => {\n                    if (value.length >= config.autocompleteMinLength) {\n                        if (!value) {\n                            store.updateState({\n                                initialized: true,\n                                loading: false\n                            })\n                        }\n                    } else if (value.length === 0 && config.historyEnabled && !history.isOpen()) {\n                        if (!config.historyComponent) {\n                            return\n                        }\n                        history.show()\n\n                        render(\n                            <ErrorBoundary>\n                                <AutocompletePageProvider config={config} store={store}>\n                                    <ConfigContext.Provider value={config}>\n                                        <HistoryElementProvider onHistorySubmit={createHandleSubmit(history)}>\n                                            <config.historyComponent />\n                                        </HistoryElementProvider>\n                                    </ConfigContext.Provider>\n                                </AutocompletePageProvider>\n                            </ErrorBoundary>,\n                            history.element\n                        )\n                    }\n                },\n                onClick: async value => {\n                    if (value.length >= config.autocompleteMinLength) {\n                        shouldUpdateSearch(value)\n\n                        if (!value) {\n                            store.updateState({\n                                initialized: true,\n                                loading: false\n                            })\n                        }\n                    } else if (value.length === 0 && config.historyEnabled && !history.isOpen()) {\n                        if (!config.historyComponent || !config.historyEnabled) {\n                            return\n                        }\n                        history.show()\n                    }\n                },\n                onSubmit: value => {\n                    if (value.length >= config.autocompleteMinLength) {\n                        dropdown.hide()\n                        history.hide()\n                        history.add(value)\n                        storeHistoryState()\n\n                        const highlighted = dropdown.highlightedIndex()\n                        if (highlighted >= 0) {\n                            dropdown.submitHighlightedItem(highlighted)\n                            return\n                        }\n\n                        handlers.onSubmit({\n                            query: value\n                        })\n\n                        dropdown.hide()\n                    }\n                },\n                onKeyDown: (_value, key) => {\n                    if (_value.length >= config.autocompleteMinLength) {\n                        if (dropdown.isOpen()) {\n                            if (key === \"ArrowDown\") {\n                                dropdown.goDown()\n                            } else if (key === \"ArrowUp\") {\n                                dropdown.goUp()\n                            } else if (key === \"Enter\") {\n                                const highlighted = dropdown.highlightedIndex()\n                                if (highlighted >= 0) {\n                                    dropdown.submitHighlightedItem(highlighted)\n                                    return\n                                }\n                                dropdown.hide()\n                            }\n                        }\n\n                        if (key === \"Escape\") {\n                            dropdown.hide()\n                        } else if (key === \"ArrowDown\") {\n                            dropdown.show()\n                            history.hide()\n                        }\n                    }\n\n                    if (_value.length === 0 && config.historyEnabled) {\n                        if (history.isOpen()) {\n                            if (key === \"ArrowDown\") {\n                                history.goDown()\n                            } else if (key === \"ArrowUp\") {\n                                history.goUp()\n                            }\n                        }\n                        if (key === \"Escape\") {\n                            history.hide()\n                        } else if (key === \"ArrowDown\") {\n                            history.show()\n                        } else if (key === \"Enter\") {\n                            const highlighted = history.highlightedIndex()\n                            if (highlighted >= 0) {\n                                history.submitHighlightedItem(highlighted)\n                                return\n                            }\n                            history.hide()\n                        }\n                    }\n                }\n            })\n\n            store.onChange(selectorLoaded, ({ initialized }) => {\n                if (!initialized || !config.autocompleteComponent) {\n                    return\n                }\n\n                const end = measure(\"renderAutocomplete\")\n\n                render(\n                    <ErrorBoundary>\n                        <AutocompletePageProvider config={config} store={store}>\n                            <ConfigContext.Provider value={config}>\n                                <AutocompleteElementProvider onSubmit={createHandleSubmit(dropdown)}>\n                                    <config.autocompleteComponent />\n                                </AutocompleteElementProvider>\n                            </ConfigContext.Provider>\n                        </AutocompletePageProvider>\n                    </ErrorBoundary>,\n                    dropdown.element\n                )\n                end()\n            })\n\n            const outsideDropdown = bindClickOutside([dropdown.element, input], () => {\n                dropdown.hide()\n            })\n\n            const outsideHistory = bindClickOutside([history.element, input], () => {\n                history.hide()\n            })\n\n            return {\n                destroy() {\n                    bind.destroy()\n                    dropdown.destroy()\n                    history.destroy()\n                    outsideDropdown.destroy()\n                    outsideHistory.destroy()\n                }\n            }\n        })\n\n    end()\n\n    return {\n        destroy: () => {\n            dropdowns.forEach(v => {\n                v.destroy()\n            })\n        }\n    }\n}\n\nfunction createElements(input: HTMLInputElement, dropdown: HTMLDivElement, config: FullConfig) {\n    const wrapper = document.createElement(\"div\")\n    wrapper.className = \"nosto-autocomplete-wrapper\"\n\n    dropdown.style.display = \"none\"\n\n    input.parentNode?.insertBefore(wrapper, input.nextSibling)\n    wrapper.appendChild(input)\n\n    const dropdownLocator = resolveCssSelector(config.dropdownCssSelector)\n    const dropdownParent = dropdownLocator && document.querySelector(dropdownLocator.selector)\n\n    if (dropdownParent) {\n        const form = document.createElement(\"form\")\n        form.className = \"nosto-dropdown-form\"\n        form.appendChild(dropdown)\n        if (dropdownLocator.position === \"first\") {\n            dropdownParent.prepend(form)\n        } else {\n            dropdownParent.appendChild(form)\n        }\n    } else {\n        wrapper.appendChild(dropdown)\n    }\n\n    const highlightElement = (elementList: Element[], highlightIndex: number) => {\n        dropdown\n            .querySelector(\".ns-autocomplete-element.ns-autocomplete-element-hovered\")\n            ?.classList.remove(\"ns-autocomplete-element-hovered\")\n        elementList[highlightIndex]?.classList.add(\"ns-autocomplete-element-hovered\")\n    }\n\n    const getHighlightIndex = (removeHighlight?: boolean): number => {\n        const elements = Array.from(dropdown.getElementsByClassName(\"ns-autocomplete-element\"))\n\n        const highlighted = elements.find(item => {\n            if (item.classList.contains(\"ns-autocomplete-element-hovered\")) {\n                if (removeHighlight) {\n                    item.classList.remove(\"ns-autocomplete-element-hovered\")\n                }\n                return true\n            }\n            return false\n        })\n\n        return highlighted ? elements.indexOf(highlighted) : -1\n    }\n    return {\n        element: dropdown,\n        hide: () => {\n            dropdown.style.display = \"none\"\n        },\n        show: () => {\n            dropdown.style.display = \"\"\n        },\n        destroy: () => {\n            wrapper.parentElement?.removeChild(wrapper)\n        },\n        isOpen: () => dropdown.style.display !== \"none\",\n        goDown: () => {\n            const elements = Array.from(dropdown.getElementsByClassName(\"ns-autocomplete-element\"))\n            const index = getHighlightIndex(true)\n            highlightElement(elements, index >= 0 ? index + 1 : 0)\n        },\n        goUp: () => {\n            const elements = Array.from(dropdown.getElementsByClassName(\"ns-autocomplete-element\"))\n            const index = getHighlightIndex(true)\n            highlightElement(elements, (index >= 0 ? index : elements.length) - 1)\n        },\n        highlight: highlightElement,\n        highlightedIndex: getHighlightIndex,\n        submitHighlightedItem: (highlightedIndex: number) => {\n            const elements = Array.from(dropdown.querySelectorAll<HTMLElement>(\".ns-autocomplete-element\"))\n            elements[highlightedIndex]?.click()\n            const value = elements[highlightedIndex]?.getAttribute(\"data-nosto-query\")\n            if (value) {\n                input.value = value\n            }\n        }\n    }\n}\n\nfunction createDropdown(input: HTMLInputElement, config: FullConfig) {\n    const dropdown = document.createElement(\"div\")\n    const base = createElements(input, dropdown, config)\n\n    return {\n        ...base,\n        element: dropdown\n    }\n}\n\nconst historyKey = \"nosto:search-templates:history\"\n\nfunction createHistory(input: HTMLInputElement, config: FullConfig) {\n    const dropdown = document.createElement(\"div\")\n    const base = createElements(input, dropdown, config)\n\n    return {\n        ...base,\n        element: dropdown,\n        add: (value: string) => {\n            const allItems = getLocalStorageItem<string[]>(historyKey) || []\n            const filteredItems = allItems.filter(v => v !== value).slice(config.historySize ? -config.historySize : 0)\n            filteredItems.push(value)\n            setLocalStorageItem(historyKey, filteredItems)\n        },\n        get: () => {\n            const historyFromLocalStorage = getLocalStorageItem<string[]>(historyKey) || []\n            const historyItems = historyFromLocalStorage\n                ? historyFromLocalStorage.reverse().filter((c: string) => !!c)\n                : undefined\n\n            return historyItems\n        }\n    }\n}\n", "export type CssSelector =\n    | string\n    | {\n          selector: string\n          position?: \"first\" | \"last\"\n      }\n\nexport function resolveCssSelector(selector: CssSelector | undefined) {\n    if (!selector) {\n        return undefined\n    }\n    if (typeof selector === \"string\") {\n        return {\n            selector,\n            position: \"last\"\n        }\n    }\n    return {\n        position: \"last\",\n        ...selector\n    }\n}\n", "import { Config } from \"../config\"\nimport { resolveCssSelector } from \"./resolveCssSelector\"\nimport { bindInput as bindInputListeners, InputBindingCallbacks } from \"@nosto/search-js/utils\"\n\nexport function bindInput(\n    config: Config,\n    target: HTMLInputElement,\n    callbacks: InputBindingCallbacks\n): {\n    destroy: () => void\n} {\n    const dropdownLocator = resolveCssSelector(config.dropdownCssSelector)\n    const formContainer = dropdownLocator && document.querySelector(dropdownLocator.selector)\n\n    const formEl = formContainer ? formContainer.querySelector(\"form\") : target.form\n    return bindInputListeners(target, callbacks, { form: formEl! })\n}\n", "import { ComponentChildren, h, JSX } from \"preact\"\nimport { useContext } from \"preact/hooks\"\nimport { SearchQuery } from \"../../api\"\nimport { trackGaPageView } from \"../../helpers/ga\"\nimport { paramsToQueryString } from \"../../urlEncoding/url\"\nimport { useConfig } from \"../../hooks\"\nimport { Context } from \"./Context\"\nimport { AutocompleteOptions } from \"./types\"\nimport { useAppStateSelector } from \"../../hooks/useAppStateSelector\"\nimport { nostojs } from \"@nosto/nosto-js\"\nimport { logger } from \"@nosto/search-js/utils\"\n\nexport function AutocompleteElementProvider(props: {\n    onSubmit(query: SearchQuery, options?: AutocompleteOptions): void\n    children: ComponentChildren\n}) {\n    return <Context.Provider value={props.onSubmit}>{props.children}</Context.Provider>\n}\n\n/**\n * @group Components\n */\nexport type AutocompleteElementProps = {\n    /**\n     * Rendered content.\n     */\n    children: ComponentChildren\n    /**\n     * Execute new search with specified query on the selection\n     */\n    query?: SearchQuery\n    /**\n     * Append CSS class to element\n     */\n    class?: string\n    /**\n     * Append CSS class to element is selected with keyboard\n     */\n    activeClass?: string\n    /**\n     * Get product data for analytics and redirection\n     */\n    hit?: {\n        productId: string\n        url?: string\n        keyword?: string\n        _redirect?: string\n    }\n    /**\n     * Filter to use on keyword click\n     */\n    filter?: {\n        field: string\n        value: string[]\n    }\n    /**\n     * Redirect to specified url on click\n     */\n    url?: string\n    /**\n     * Render element as specified element\n     */\n    as?: string\n    /**\n     * Handle click event\n     */\n    onClick: (event: Event) => void\n} & JSX.HTMLAttributes &\n    JSX.SVGAttributes\n\n/**\n * Wraps elements to interactive component that handles selection based on provided configuration.\n *\n * @example\n * ```jsx\n * // Render product\n * {products?.hits?.map(hit => <AutocompleteElement hit={hit} class=\"nosto-product\">\n *     {hit.title}\n * </AutocompleteElement>)}\n *\n * // Render keywords\n * {keywords?.hits?.map(hit => <AutocompleteElement query={{ query: hit.keywords }} class=\"nosto-keyword\">\n *     {hit.keywords}\n * </AutocompleteElement>)}\n * ```\n *\n * @group Components\n */\nexport function AutocompleteElement(props: AutocompleteElementProps): JSX.Element {\n    const { as, filter, children, activeClass, url, hit, onClick, ...rest } = props\n    const query = useAppStateSelector(state => state.query.query)\n    const { serpUrlMapping, serpPath } = useConfig()\n    const onSubmit = useContext(Context)\n\n    const searchOptions = {\n        isKeyword: true\n    } as const\n\n    const getTrackUrl = (value: string | undefined) => {\n        try {\n            return new URL(\n                `${serpPath || location.pathname}?${paramsToQueryString({\n                    [serpUrlMapping.query || \"query\"]: value\n                })}`,\n                window.location.origin\n            ).toString()\n        } catch (error) {\n            logger.warn(\"Could not create track url\", error)\n            return undefined\n        }\n    }\n\n    function handleClick() {\n        if (props.hit) {\n            nostojs(api => api.recordSearchClick(\"autocomplete\", props.hit!))\n\n            if (props.hit?.keyword) {\n                if (props.hit?._redirect) {\n                    trackGaPageView({\n                        delay: true,\n                        location: getTrackUrl(props.hit.keyword)\n                    })\n                    location.href = props.hit._redirect\n                    return\n                }\n\n                return onSubmit(\n                    {\n                        query: props.hit?.keyword,\n                        ...(props.filter\n                            ? {\n                                  products: {\n                                      filter: [props.filter]\n                                  }\n                              }\n                            : {})\n                    },\n                    searchOptions\n                )\n            }\n            trackGaPageView({\n                delay: true,\n                location: getTrackUrl(query)\n            })\n        }\n\n        if (props?.hit?.url || props?.url) {\n            location.href = (props.url || props?.hit?.url)!\n        } else if (props.query) {\n            onSubmit(\n                {\n                    ...props.query,\n                    ...(props.filter\n                        ? {\n                              products: {\n                                  filter: [props.filter]\n                              }\n                          }\n                        : {})\n                },\n                searchOptions\n            )\n        }\n    }\n\n    if (as) {\n        return h(\n            as,\n            {\n                ...(as === \"a\" && props.hit?.url\n                    ? {\n                          href: props.hit.url\n                      }\n                    : {}),\n                ...rest,\n                onClick: (event: MouseEvent) => {\n                    if (props.hit) {\n                        nostojs(api => api.recordSearchClick(\"autocomplete\", props.hit!))\n                    }\n                    return props.onClick?.(event)\n                }\n            },\n            props.children\n        )\n    }\n\n    return (\n        <div\n            class={`ns-autocomplete-element ${props.class ?? \"\"}`}\n            data-nosto-query={props?.hit?.keyword || props?.query?.query}\n            data-nosto-url={props.url || props?.hit?.url}\n            onClick={() => {\n                handleClick()\n            }}\n            onKeyDown={(event: KeyboardEvent) => {\n                if (event.key === \"Enter\") {\n                    handleClick()\n                }\n            }}\n            tabIndex={0}\n        >\n            {props.children}\n        </div>\n    )\n}\n", "import { logger } from \"@nosto/search-js/utils\"\n\nconst localStorageKey = \"search-templates-ga-event\"\n\ntype GaNamespace = {\n    (): void\n    getAll(): {\n        send(type: string, url: string): void\n    }[]\n}\n\nfunction hasGtag(window: Window): window is Window & { gtag: (...args: unknown[]) => void } {\n    return \"gtag\" in window && typeof window.gtag === \"function\"\n}\n\nfunction hasGa(window: Window): window is Window & { ga: GaNamespace } {\n    return (\n        \"ga\" in window &&\n        typeof window.ga === \"function\" &&\n        \"getAll\" in window.ga &&\n        typeof window.ga.getAll === \"function\"\n    )\n}\n\nfunction hasGoogleTagManager(window: Window): window is Window & { google_tag_manager: Record<string, unknown> } {\n    return \"google_tag_manager\" in window && typeof window.google_tag_manager === \"object\"\n}\n\nexport function trackGaPageView(options?: { delay?: boolean; title?: string; location?: string }) {\n    const { delay = false, title = document.title, location = window.location.href } = options || {}\n\n    if (delay) {\n        saveToLocalStorage(title, location)\n    } else {\n        if (hasGtag(window)) {\n            const accounts = Object.keys(hasGoogleTagManager(window) ? window.google_tag_manager : {}).filter(\n                e => e.substring(0, 2) == \"G-\"\n            )\n\n            if (accounts.length > 1) {\n                for (let i = 0; i < accounts.length; i++) {\n                    window.gtag(\"event\", \"page_view\", {\n                        page_title: title,\n                        page_location: location,\n                        send_to: accounts[i]\n                    })\n                }\n            } else {\n                window.gtag(\"event\", \"page_view\", {\n                    page_title: title,\n                    page_location: location\n                })\n            }\n        }\n        if (hasGa(window)) {\n            try {\n                const url = new URL(location)\n                const trackers = window.ga!.getAll()\n                if (trackers?.length > 0) {\n                    trackers[0]?.send(\"pageview\", url.pathname + url.search)\n                }\n            } catch (error) {\n                logger.warn(\"Could not send pageview to GA\", error)\n            }\n        }\n    }\n}\n\nfunction saveToLocalStorage(title: string, location: string): void {\n    localStorage.setItem(localStorageKey, JSON.stringify({ title, location }))\n}\n\ninterface Event {\n    title: string\n    location: string\n}\n\nfunction consumeLocalStorageEvent(): void {\n    const eventString = localStorage.getItem(localStorageKey)\n    if (typeof eventString === \"string\") {\n        localStorage.removeItem(localStorageKey)\n        try {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            const event: Event = JSON.parse(eventString)\n            trackGaPageView(event)\n        } catch (e) {\n            logger.warn(e)\n        }\n    }\n}\n\nsetTimeout(consumeLocalStorageEvent, 1000)\n", "import { createContext } from \"preact\"\nimport { SearchQuery } from \"../../api\"\nimport { AutocompleteOptions } from \"./types\"\n\nexport const Context = createContext<(query: SearchQuery, options?: AutocompleteOptions) => void>(() => {})\n", "import { ComponentChildren, Fragment, h } from \"preact\"\nimport { SearchQuery } from \"../../api\"\nimport { useContext } from \"preact/hooks\"\nimport { Context } from \"./Context\"\n\nexport function HistoryElementProvider(props: {\n    onHistorySubmit(query: SearchQuery): void\n    children: ComponentChildren\n}) {\n    return <Context.Provider value={props.onHistorySubmit}>{props.children}</Context.Provider>\n}\n\n/**\n * @group Components\n */\nexport interface HistoryElementProps {\n    children: ComponentChildren\n    /**\n     * Execute new search with specified query on the selection.\n     */\n    query?: SearchQuery\n    /**\n     * Append class to element.\n     */\n    class?: string\n    /**\n     * Append class when element is selected with keyboard.\n     */\n    activeClass?: string\n}\n\n/**\n * @group Components\n */\nexport function HistoryElement({ children, query, class: className }: HistoryElementProps) {\n    const onSubmit = useContext(Context)\n\n    return (\n        <Fragment>\n            <div\n                className={`ns-autocomplete-element ${className || \"\"}`}\n                data-nosto-query={query?.query}\n                onClick={() => {\n                    if (query) {\n                        onSubmit(query)\n                    }\n                }}\n                onKeyDown={event => {\n                    if (event.key === \"Enter\" && query) {\n                        onSubmit(query)\n                    }\n                }}\n                tabIndex={0}\n            >\n                {children}\n            </div>\n        </Fragment>\n    )\n}\n", "import { Fragment, h, ComponentChildren } from \"preact\"\nimport { useErrorBoundary } from \"preact/hooks\"\nimport { logger } from \"@nosto/search-js/utils\"\n\n/**\n * Error boundary component to log UI level errors\n * @group Components\n */\nexport default function ErrorBoundary({ children }: { children: ComponentChildren }) {\n    const [error] = useErrorBoundary()\n\n    if (error) {\n        logger.error(\"Error caught in ErrorBoundary\", error)\n    }\n\n    return <Fragment>{children}</Fragment>\n}\n", "export default function (delay: number) {\n    let timeoutId: ReturnType<typeof setTimeout> | undefined\n\n    return (callback: () => void) => {\n        if (timeoutId) {\n            clearTimeout(timeoutId)\n        }\n        timeoutId = setTimeout(callback, delay)\n    }\n}\n", "import { State } from \"../state\"\nimport { isBot } from \"@nosto/search-js/utils\"\n\n/**\n * Selector returning the state of initialization.\n *\n * Includes special case for bot clients (SEO crawlers).\n * For bots, if the app is in a loading state this selector returns `initialized: false`.\n *\n * The expected use-case is to skip rendering loading state for bots and encourage them to take\n * snapshot of the native products in case Nosto products haven't loaded yet.\n */\nexport function selectorLoaded({ initialized, loading }: State) {\n    return { initialized: isBot() ? initialized && !loading : initialized }\n}\n", "import { SearchQuery } from \"../api\"\nimport { parseNumber } from \"@nosto/search-js/utils\"\n\nexport default function ensureSearchQueryNumbers({ products, ...rest }: SearchQuery): SearchQuery {\n    return {\n        ...rest,\n        products: {\n            ...products,\n            ...(products?.from ? { from: parseNumber(products.from) } : {}),\n            ...(products?.size ? { size: parseNumber(products.size) } : {})\n        }\n    }\n}\n", "import { ComponentType, render, h } from \"preact\"\nimport { ConfigContext, FullConfig } from \"../config\"\nimport { Store } from \"../state\"\nimport { logger, measure } from \"@nosto/search-js/utils\"\nimport ErrorBoundary from \"../components/ErrorBoundary\"\nimport { waitForElements } from \"../utils/wait\"\nimport { extractNativeContent } from \"../helpers/searchFallback\"\nimport { CategoryPageProvider } from \"@nosto/search-js/preact/category\"\nimport { SearchPageProvider } from \"@nosto/search-js/preact/serp\"\n\nexport async function renderComponent(\n    config: FullConfig,\n    store: Store,\n    {\n        cssSelector,\n        docComponent\n    }: {\n        cssSelector?: string\n        docComponent?: ComponentType\n    }\n): Promise<void> {\n    if (!cssSelector || !docComponent) {\n        return\n    }\n\n    const targets = await waitForElements({\n        selector: cssSelector,\n        timeout: 100\n    })\n\n    const target = targets[0]\n\n    if (!target) {\n        logger.warn(`No content element with ${cssSelector} selector found, skipping rendering`)\n        return\n    }\n\n    if (targets.length > 1) {\n        logger.warn(\n            `Multiple content elements found with ${cssSelector} selector, using the first element for rendering`\n        )\n    }\n\n    if (config.serpRenderDelay) {\n        await config.serpRenderDelay()\n    }\n\n    extractNativeContent(target)\n    const end = measure(\"renderSearch\")\n\n    const pageType = store.getState().pageType\n    const renderProps = {\n        store,\n        config,\n        target,\n        ComponentToRender: docComponent\n    } satisfies RenderProps\n\n    if (pageType === \"search\") {\n        renderSerpComponent(renderProps)\n    } else if (pageType === \"category\") {\n        renderCategoryComponent(renderProps)\n    } else {\n        throw new Error(`Unsupported page type: ${pageType}`)\n    }\n\n    end()\n}\n\ninterface RenderProps {\n    store: Store\n    config: FullConfig\n    target: Element\n    ComponentToRender: ComponentType\n}\n\nfunction renderSerpComponent({ store, config, target, ComponentToRender }: RenderProps) {\n    render(\n        <ErrorBoundary>\n            <SearchPageProvider store={store} config={config}>\n                <ConfigContext.Provider value={config}>\n                    <ComponentToRender />\n                </ConfigContext.Provider>\n            </SearchPageProvider>\n        </ErrorBoundary>,\n        target\n    )\n}\n\nfunction renderCategoryComponent({ store, config, target, ComponentToRender }: RenderProps) {\n    render(\n        <ErrorBoundary>\n            <CategoryPageProvider store={store} config={config}>\n                <ConfigContext.Provider value={config}>\n                    <ComponentToRender />\n                </ConfigContext.Provider>\n            </CategoryPageProvider>\n        </ErrorBoundary>,\n        target\n    )\n}\n", "import { logger } from \"@nosto/search-js/utils\"\nimport { findAll } from \"../helpers/dom\"\n\nexport interface DelayOptions {\n    /** HTML Selector to observe and wait for */\n    selector: string\n    /**\n     * Timeout in milliseconds, how long to wait for element to get rendered\n     * @default 500\n     */\n    timeout?: number\n}\n/**\n * Wait for element to appear in DOM using MutationObserver\n * @returns First element it finds\n * @example\n * ```\n * import { waitForElement } from '@nosto/preact'\n *\n * init({\n *     serpRenderDelay: () => {\n *        return waitForElement({\n *          selector: 'script[type=\"text/x-magento-init\"]',\n *          timeout: 1000 //1 second\n *        })\n *     },\n * })\n * ```\n */\n\nexport async function waitForElement({ selector, timeout = 500 }: DelayOptions): Promise<Element | void> {\n    const elements = await waitForElements({ selector, timeout })\n    return elements[0]\n}\n\n/**\n * Wait for element to appear in DOM using MutationObserver\n * @returns Array of elements it finds\n */\nexport function waitForElements({ selector, timeout = 500 }: DelayOptions): Promise<Element[]> {\n    return new Promise((resolve, reject) => {\n        const elements = findAll(selector)\n        if (elements.length > 0) {\n            return resolve(elements)\n        }\n\n        const observer = new MutationObserver(() => {\n            const elements = findAll(selector)\n            if (elements.length > 0) {\n                observer.disconnect()\n                clearTimeout(timer)\n                resolve(elements)\n            }\n        })\n\n        const timer = setTimeout(() => {\n            observer.disconnect()\n            logger.warn(`Timed out (${timeout}) while waiting for element ${selector}`)\n            resolve([])\n        }, timeout)\n\n        observer.observe(document.body, {\n            childList: true,\n            subtree: true\n        })\n    })\n}\n", "import { newSearch, handleFallback } from \"../actions\"\nimport { SearchQuery } from \"../api/types\"\nimport { FullConfig } from \"../config\"\nimport {\n    updateUrlState,\n    bindUrlStateChange,\n    paramsToJson,\n    queryStringToParams,\n    unmapParams,\n    getSearchUrl\n} from \"../urlEncoding/url\"\nimport { Store } from \"../state\"\nimport { trackGaPageView } from \"../helpers/ga\"\nimport pipe from \"../utils/pipe\"\nimport ensureSearchQueryNumbers from \"../helpers/ensureNumbers\"\nimport { isErrorSession } from \"../helpers/errorHandling\"\nimport { deepMerge, measure } from \"@nosto/search-js/utils\"\nimport { selectorLoaded } from \"../helpers/selectors\"\nimport { renderComponent } from \"./render\"\nimport { createMapperOptions } from \"../urlEncoding/createMapperOptions\"\nimport { restoreSavedScroll, unhideNativeContent } from \"../helpers/dom\"\n\nexport async function initSerp(config: FullConfig, store: Store): Promise<void> {\n    const end = measure(\"initSerp\")\n    unhideNativeContent(config.contentCssSelector)\n    unhideNativeContent(config.categoryCssSelector)\n\n    store.onChange(selectorLoaded, ({ initialized }) => {\n        if (!initialized) {\n            return\n        }\n\n        if (store.getState().pageType === \"category\") {\n            renderComponent(config, store, {\n                cssSelector: config.categoryCssSelector,\n                docComponent: config.categoryComponent\n            })\n        } else {\n            renderComponent(config, store, {\n                cssSelector: config.contentCssSelector,\n                docComponent: config.serpComponent\n            })\n        }\n\n        if (config.preservePageScroll) {\n            restoreSavedScroll()\n        }\n    })\n\n    store.onChange(\n        ({ query, customParams }) => ({ query, customParams }),\n        ({ query, customParams }) => {\n            updateUrlState(getSearchUrl({ config, store }, query, { customParams }))\n            trackGaPageView()\n        }\n    )\n\n    handleUrlStateChange(config, store)\n    bindUrlStateChange(() => {\n        handleUrlStateChange(config, store)\n    })\n\n    end()\n}\n\nexport function getDataFromUrl(config: FullConfig, store: Store) {\n    const parsedParams = paramsToJson(queryStringToParams(location.search))\n    const queryParamKeys = Object.values(config.serpUrlMapping)\n    const encodedQuery: SearchQuery = unmapParams(parsedParams, config.serpUrlMapping) || {}\n    if (encodedQuery.products && !encodedQuery.products.size) {\n        // making products.size available for pagination decoding\n        encodedQuery.products.size = store.getInitialState().query?.products?.size\n    }\n    const encodedCustomParams = Object.entries(parsedParams).reduce<Record<string, unknown>>((prev, cur) => {\n        if (!queryParamKeys.includes(cur[0])) {\n            prev[cur[0]] = cur[1]\n        }\n        return prev\n    }, {})\n\n    const mapperOptions = createMapperOptions(config)\n    const decoder = pipe(\n        ...(config.customUrlMappings?.map(m => {\n            // Wrap decoder to include mapperOptions\n            return (query: unknown) => m.decode(query, mapperOptions)\n        }) ?? [])\n    )\n\n    // @ts-expect-error TODO fix pipe function\n    const queryPartial: SearchQuery = pipe(decoder, ensureSearchQueryNumbers)(encodedQuery)\n    const query = deepMerge(store.getInitialState().query, queryPartial)\n    // @ts-expect-error TODO fix pipe function\n    const customParams: Record<string, unknown> = decoder(encodedCustomParams)\n\n    return { query, customParams }\n}\n\nfunction handleUrlStateChange(config: FullConfig, store: Store): void {\n    const { query, customParams } = getDataFromUrl(config, store)\n    const isSerp = (!config.serpPath || location.pathname === config.serpPath) && !!query?.query\n    const isCategory = config.isCategoryPage?.()\n\n    if (\n        (isSerp && store.getState().pageType === \"search\") ||\n        (isCategory && store.getState().pageType === \"category\")\n    ) {\n        if (config.fallback && isErrorSession()) {\n            handleFallback(config, query)\n            return\n        }\n\n        newSearch({ config, store }, query, { customParams })\n        return\n    }\n\n    if (store.getState().initialized) {\n        location.reload()\n    }\n}\n", "export default function expandMapping(mapping: Record<string, string>): Record<string, unknown> {\n    return Object.entries(mapping).reduce<Record<string, unknown>>((expandedMapping, [key, value]) => {\n        const nestedKeys = key.split(\".\")\n        let currentLevel = expandedMapping\n\n        for (let i = 0; i < nestedKeys.length - 1; i++) {\n            const nestedKey = nestedKeys[i]!\n            if (!currentLevel[nestedKey]) {\n                currentLevel[nestedKey] = {}\n            }\n            // @ts-expect-error type mismatch\n            currentLevel = currentLevel[nestedKey]\n        }\n\n        const lastKey = nestedKeys[nestedKeys.length - 1]!\n        currentLevel[lastKey] = value\n\n        return expandedMapping\n    }, {})\n}\n", "export default function flattenMapping(nestedMapping: Record<string, unknown>, prefix = \"\"): Record<string, string> {\n    const result: Record<string, string> = {}\n\n    Object.entries(nestedMapping).forEach(([key, value]) => {\n        const nestedKey = prefix ? `${prefix}.${key}` : key\n\n        if (typeof value === \"object\" && value !== null) {\n            // @ts-expect-error type mismatch\n            Object.assign(result, flattenMapping(value, nestedKey))\n        } else {\n            // @ts-expect-error type mismatch\n            result[nestedKey] = value\n        }\n    })\n\n    return result\n}\n", "import { ProductsRemapped } from \"./mapping\"\nimport { MapperOptions } from \"./types\"\n\n/**\n * Wraps a pair of encode and decode functions for InputSearchProducts to a pair of encode and decode functions for SearchQuery.\n */\nexport default function createMapper<In, Out>({\n    encode,\n    decode\n}: {\n    encode(products: In, options: MapperOptions): ProductsRemapped<In, Out, keyof In>\n    decode(products: Out, options: MapperOptions): ProductsRemapped<Out, In, keyof Out>\n}) {\n    return {\n        encode<Q extends { products?: In }>(query: Q, options: MapperOptions) {\n            return query.products ? { ...query, products: encode(query.products, options) } : query\n        },\n        decode<Q extends { products?: Out }>(query: Q, options: MapperOptions) {\n            return query.products ? { ...query, products: decode(query.products, options) } : query\n        }\n    }\n}\n", "export function decodeValue(value: string, separator: string): string {\n    return value.replace(/%7E/g, separator)\n}\n\nexport function encodeValue(value: string, separator: string): string {\n    // Escape the separator character as it could be a regex control character\n    const regex = new RegExp(`\\\\${separator}`, \"g\")\n    return value.replace(regex, \"%7E\")\n}\n", "import { decodeValue, encodeValue } from \"../utils/valueEncoding\"\nimport { MapperOptions } from \"../types\"\nimport type { InputSearchFilter, InputSearchRangeFilter } from \"@nosto/nosto-js/client\"\n\nfunction decodeUnit(unit: string, separator: string): InputSearchRangeFilter {\n    const [gte, lte] = unit.split(separator)\n    const range: InputSearchRangeFilter = {}\n    if (lte) {\n        range[lte.includes(\"]\") ? \"lt\" : \"lte\"] = decodeValue(lte.replace(/[[{\\]}']/gm, \"\"), separator)\n    }\n    if (gte) {\n        range[gte.includes(\"[\") ? \"gt\" : \"gte\"] = decodeValue(gte.replace(/[[{\\]}']/gm, \"\"), separator)\n    }\n    return range\n}\n\nconst filterComponent = {\n    decode(filterUrl: string): string[] {\n        return filterUrl.split(\"||\").map(value => decodeValue(value, \"~\"))\n    },\n    encode(filters: string[]): string {\n        return filters.map(value => encodeValue(value, \"~\")).join(\"||\")\n    }\n}\n\nconst rangeComponent = {\n    decode(rangeUrl: string, separator: string): InputSearchRangeFilter[] {\n        return rangeUrl.split(\",\").map(unit => decodeUnit(unit, separator))\n    },\n    encode(rangeList: InputSearchRangeFilter[], options: MapperOptions): string {\n        return rangeList\n            .map(item => {\n                const gtE = item.gte || (item.gt ? `[${item.gt}` : \"\")\n                const ltE = item.lte || (item.lt ? `${item.lt}]` : \"\")\n                return [gtE, ltE]\n                    .map(value => encodeValue(value, options.filterRangeSeparator))\n                    .join(options.filterRangeSeparator)\n            })\n            .join(\",\")\n    }\n}\n\nexport default {\n    decode(field: string, value: string, options: MapperOptions): InputSearchFilter {\n        if (value.includes(\"-+\")) {\n            const decodedValue = decodeURIComponent(value)\n            return { field, range: rangeComponent.decode(decodedValue, \"-+\") }\n        } else if (value.includes(options.filterRangeSeparator)) {\n            return { field, range: rangeComponent.decode(value, options.filterRangeSeparator) }\n        }\n        return { field, value: filterComponent.decode(value) }\n    },\n    encode({ field, range, value }: InputSearchFilter, options: MapperOptions) {\n        if (range) {\n            return { [field!]: rangeComponent.encode(range, options) }\n        } else if (value) {\n            return { [field!]: filterComponent.encode(value) }\n        }\n        return {}\n    }\n}\n", "import type { InputSearchFilter } from \"@nosto/nosto-js/client\"\nimport expandMapping from \"../expandMapping\"\nimport flattenMapping from \"../flattenMapping\"\nimport { NestedFilter } from \"../mapping\"\nimport createMapper from \"../createMapper\"\nimport filterEncoding from \"./filterEncoding\"\n\n/**\n * Encodes the query object by converting the `filter` property of the `products` object to an object with key-value pairs.\n * @example\n * products.filter.0.field=skus.customFields.size&products.filter.0.value.0=10 to products.filter.skus.customFields.size=10,15\n * customUrlMappings: [\n *    compressFilterParameters\n * ]\n *\n * @hidden\n */\nexport default createMapper<{ filter?: InputSearchFilter[] }, { filter?: NestedFilter }>({\n    encode({ filter, ...rest }, options) {\n        if (!filter) return rest\n        const compressedFilter = filter.reduce<Record<string, string>>((acc, filterEntry) => {\n            return { ...acc, ...filterEncoding.encode(filterEntry, options) }\n        }, {})\n        const expandedFields = expandMapping(compressedFilter)\n        return { ...rest, filter: expandedFields }\n    },\n    decode({ filter, ...rest }, options) {\n        if (!filter) return rest\n        const compressedFields = flattenMapping(filter)\n        const expandedFilter = Object.entries(compressedFields).map(([field, value]) =>\n            filterEncoding.decode(field, value, options)\n        )\n        return { ...rest, filter: expandedFilter }\n    }\n})\n", "import type { InputSearchSort } from \"@nosto/nosto-js/client\"\nimport createMapper from \"../createMapper\"\n\n/**\n * Encodes the query object by converting the `sort` property of the `products` object to an object with key-value pairs.\n * @example\n * products.sort.0.field=price&products.sort.0.order=desc to products.sort=price~asc\n * customUrlMappings: [\n *    compressSortParameters\n * ]\n *\n * @hidden\n */\nexport default createMapper<{ sort?: InputSearchSort[] }, { sort?: string }>({\n    encode({ sort, ...rest }) {\n        if (!sort) return rest\n        const compressed = sort.map(({ field, order }) => `${field}~${order}`).join(\",\")\n        return { ...rest, sort: compressed }\n    },\n    decode({ sort, ...rest }) {\n        if (!sort) return rest\n        if (typeof sort === \"object\") {\n            const expanded = Object.entries(sort).map(([field, order]) => ({\n                field,\n                order\n            }))\n            return { ...rest, sort: expanded }\n        }\n        const expanded = sort\n            .split(\",\")\n            .filter(Boolean)\n            .map(s => s.split(\"~\"))\n            .map(([field, order]) => ({ field, order }))\n        return { ...rest, sort: expanded }\n    }\n})\n", "import createMapper from \"../createMapper\"\n\n/**\n * Encodes the query object by converting the `from` property of the `products` object to a `page` property.\n * @example\n * products.from=24 to products.page=1\n * customUrlMappings: [\n *    mapOffsetToPage\n * ]\n *\n * @hidden\n */\n\nexport default createMapper<{ from?: number; size?: number }, { page?: number; size?: number }>({\n    encode({ from = 0, size, ...rest }) {\n        if (!size) return rest\n        const page = Math.floor(from / size) + 1\n        return { ...rest, page, size }\n    },\n    decode({ page = 1, size, ...rest }) {\n        if (!size) return rest\n        const from = (page - 1) * size\n        return { ...rest, from, size }\n    }\n})\n", "import { SearchQuery } from \"../api\"\nimport compressFilterParameters from \"./mappers/compressFilterParameters\"\nimport compressSortParameters from \"./mappers/compressSortParameters\"\nimport mapOffsetToPage from \"./mappers/mapOffsetToPage\"\nimport { EncodedQuery } from \"./mapping\"\nimport { MapperOptions } from \"./types\"\n\nfunction encode(query: SearchQuery, options: MapperOptions) {\n    const q1 = mapOffsetToPage.encode(query, options)\n    const q2 = compressSortParameters.encode(q1, options)\n    return compressFilterParameters.encode(q2, options)\n}\n\nfunction decode(query: EncodedQuery, options: MapperOptions) {\n    const q1 = mapOffsetToPage.decode(query, options)\n    const q2 = compressSortParameters.decode(q1, options)\n    return compressFilterParameters.decode(q2, options)\n}\n\n/**\n * @hidden\n */\nexport default {\n    encode,\n    decode\n}\n", "/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { deepMerge, logger } from \"@nosto/search-js/utils\"\nimport { Config, defaultConfig, FullConfig } from \"./config\"\nimport defaultMappers from \"./urlEncoding/defaultMappers\"\nimport { handleFallback, shouldFallback } from \"./actions\"\nimport { Store } from \"./state\"\nimport { SearchOptions } from \"./api\"\nimport { isErrorSession } from \"./helpers/errorHandling\"\n\nexport function makeConfig(config: Partial<Config>): FullConfig {\n    const fullConfig = deepMerge(defaultConfig, config) as FullConfig\n\n    if (fullConfig.compressUrlParameters && !fullConfig.customUrlMappings) {\n        fullConfig.customUrlMappings = [defaultMappers]\n    }\n\n    fullConfig.onBeforeSearch = (context, options) => {\n        if (config.fallback && isErrorSession()) {\n            throw new Error(\"Search API is in error state\")\n        }\n        const store = context.store as Store\n        const searchOptions = options as SearchOptions\n        store.updateState({\n            customParams: searchOptions.customParams ?? {}\n        })\n    }\n\n    fullConfig.onSearchError = (error, query, _, pageType) => {\n        if (config.fallback && pageType !== \"autocomplete\") {\n            if (shouldFallback(error)) {\n                handleFallback(fullConfig, query)\n            } else {\n                logger.info(\"Skipping fallback logic for \", error)\n            }\n        }\n    }\n\n    fullConfig.search = {\n        hitDecorators: fullConfig.hitDecorators,\n        maxRetries: fullConfig.retries,\n        retryInterval: fullConfig.retryInterval\n    }\n\n    return fullConfig\n}\n", "import { newSearch } from \"./actions\"\nimport { initAutocomplete } from \"./autocomplete/initAutocomplete\"\nimport { Config, resolveQuery } from \"./config\"\nimport { isErrorSession } from \"./helpers/errorHandling\"\nimport { DOMReady } from \"./helpers/dom\"\nimport { getFullUrl, getSearchUrl } from \"./urlEncoding/url\"\nimport { initSerp } from \"./serp\"\nimport { createStore } from \"./state\"\nimport { measure } from \"@nosto/search-js/utils\"\nimport { nostojs } from \"@nosto/nosto-js\"\nimport { registerSearchTermsProvider } from \"./api/nosto\"\nimport { makeConfig } from \"./fullConfig\"\n\n/**\n * Create search page\n *\n * @example\n * ```\n * import { init } from '@nosto/preact'\n *\n * import serpComponent from './serp'\n *\n * init({\n *     serpComponent,\n *     inputCssSelector: '#search',\n *     contentCssSelector: '#content',\n *     merchant: '123',\n *     defaultInput: {\n *         products: {\n *             size: 30\n *         }\n *     }\n * })\n * ```\n */\nexport async function init(config: Config): Promise<void> {\n    const end = measure(\"init\")\n    const fullConfig = makeConfig(config)\n    const api = await new Promise(nostojs)\n    const { searchEnabled, categoriesEnabled } = api.internal.getSettings()\n\n    const searchActive = searchEnabled && fullConfig.contentCssSelector\n    const autocompleteActive = searchEnabled && fullConfig.inputCssSelector\n    const categoriesActive = categoriesEnabled && fullConfig.categoryCssSelector\n\n    if (searchActive || autocompleteActive) {\n        registerSearchTermsProvider(fullConfig)\n        const serpStore = createStore({\n            query: resolveQuery(fullConfig, \"serpQuery\"),\n            pageType: \"search\"\n        })\n        if (searchActive) {\n            initSerp(fullConfig, serpStore)\n        }\n        if (autocompleteActive) {\n            initAutocomplete(fullConfig, {\n                onSubmit: (query, options) => {\n                    if (query.query) {\n                        nostojs(api => api.recordSearchSubmit(query.query!))\n                    }\n                    if (fullConfig.serpPathRedirect || (fullConfig.fallback && isErrorSession())) {\n                        if (typeof fullConfig.serpPathRedirect === \"function\") {\n                            fullConfig.serpPathRedirect(query, options)\n                        } else {\n                            location.href = getFullUrl(getSearchUrl({ config: fullConfig, store: serpStore }, query))\n                        }\n                    } else {\n                        newSearch({ config: fullConfig, store: serpStore }, query, options)\n                    }\n                }\n            })\n        }\n    }\n\n    if (categoriesActive) {\n        // fullConfig.isCategoryPage() might depend on DOM based nosto tagging\n        await DOMReady()\n\n        if (fullConfig.isCategoryPage()) {\n            const categoryStore = createStore({\n                query: resolveQuery(fullConfig, \"categoryQuery\"),\n                pageType: \"category\"\n            })\n            initSerp(fullConfig, categoryStore)\n        }\n    }\n    end()\n}\n", "import { ComponentChildren, h } from \"preact\"\nimport { Category } from \"./types\"\n\n/*\n * @group Components\n */\nexport interface KeywordInCategoryProps {\n    /**\n     * Category suggestion.\n     */\n    category: Category\n    /**\n     * Keyword content component to enhance with category suggestion.\n     */\n    children: ComponentChildren\n}\n\n/**\n * Default component for rendering keyword with category suggestion.\n *\n * @group Components\n */\nexport function KeywordInCategory({ category, children }: KeywordInCategoryProps) {\n    return (\n        <span class=\"ns-clickable\">\n            {category?.value ? (\n                <span>\n                    {children}{\" \"}\n                    <span class=\"ns-keyword-in-category\">\n                        in <span>{category.value}</span>\n                    </span>\n                </span>\n            ) : (\n                children\n            )}\n        </span>\n    )\n}\n", "import { ComponentType, Fragment, h } from \"preact\"\nimport { KeywordInCategory, KeywordInCategoryProps } from \"./KeywordInCategory\"\nimport { KeywordsInCategory } from \"./KeywordsInCategory\"\nimport { ElementProps, KeywordProps } from \"./types\"\nimport type { SearchKeyword, SearchTermsFacet } from \"@nosto/nosto-js/client\"\n\n/**\n * @group Components\n */\nexport interface KeywordsProps {\n    /**\n     * Keywords to render.\n     */\n    hits: SearchKeyword[]\n    /**\n     * Component for rendering keyword's visual content.\n     */\n    keywordComponent: ComponentType<KeywordProps>\n    /**\n     * Component for rendering single keyword element.\n     */\n    elementComponent?: ComponentType<ElementProps>\n    /**\n     * Component for rendering keyword with category suggestion (default: KeywordInCategory)\n     */\n    keywordInCategoryComponent?: ComponentType<KeywordInCategoryProps>\n    /**\n     * Enable category suggestion (default: true)\n     */\n    categorySuggestion?: boolean\n    /**\n     * Number of category suggestions to render (default: 3)\n     */\n    categorySuggestionCount?: number\n}\n\n/**\n * Component for keywords rendering.\n *\n * @example\n * ```jsx\n * <Keywords\n *    hits={keywords.hits}\n *    keywordComponent={({ hit }) => <span\n *        data-nosto-element=\"keyword\"\n *    >\n *        {hit?._highlight?.keyword\n *            ? <span dangerouslySetInnerHTML={{ __html: hit._highlight.keyword }}></span>\n *            : hit.keyword\n *        }\n *    </span>}\n *    elementComponent={({ hit, keywordComponent, filter }) =>\n *        <AutocompleteElement hit={hit} filter={filter} class=\"ns-clickable ns-py-2 ns-px-4 ns-font-4\">\n *            {keywordComponent}\n *        </AutocompleteElement>\n *    }\n * />\n * ```\n *\n * @group Components\n */\nexport function Keywords({\n    hits,\n    elementComponent: Element,\n    keywordComponent: Keyword,\n    keywordInCategoryComponent = KeywordInCategory,\n    categorySuggestion = true,\n    categorySuggestionCount = 3\n}: KeywordsProps) {\n    const [firstKeyword, ...restKeywords] = hits ?? []\n    // Find first facet's field value\n    const categoryField = hits\n        ?.find(hit =>\n            hit?.facets?.find((facet): facet is SearchTermsFacet => \"data\" in facet && facet?.data?.length > 0)\n        )\n        ?.facets?.find((facet): facet is SearchTermsFacet => \"data\" in facet && facet?.data?.length > 0)?.field\n\n    if (categoryField && firstKeyword && categorySuggestion) {\n        return (\n            <Fragment>\n                <KeywordsInCategory\n                    hit={firstKeyword}\n                    categoryField={categoryField}\n                    keywordComponent={<Keyword hit={firstKeyword} />}\n                    wrapperComponent={({ keywordComponent, filter }) => {\n                        return Element ? (\n                            <Element keywordComponent={keywordComponent} hit={firstKeyword} filter={filter} />\n                        ) : (\n                            <Keyword hit={firstKeyword} />\n                        )\n                    }}\n                    keywordInCategoryComponent={keywordInCategoryComponent}\n                    categorySuggestionCount={categorySuggestionCount}\n                />\n                {restKeywords?.map((hit, index) => {\n                    return Element ? (\n                        <Element key={`${hit.keyword}-${index}}`} keywordComponent={<Keyword hit={hit} />} hit={hit} />\n                    ) : (\n                        <Keyword hit={hit} />\n                    )\n                })}\n            </Fragment>\n        )\n    }\n\n    return hits?.map((hit, index) => {\n        return Element ? (\n            <Element key={`${hit.keyword}-${index}}`} keywordComponent={<Keyword hit={hit} />} hit={hit} />\n        ) : (\n            <Keyword hit={hit} />\n        )\n    })\n}\n", "import { ComponentType, JSX, h, Fragment } from \"preact\"\nimport { KeywordInCategory, KeywordInCategoryProps } from \"./KeywordInCategory\"\nimport { KeywordWrapper } from \"./KeywordWrapper\"\nimport { WrapperProps } from \"./types\"\nimport type { SearchKeyword, SearchTermsFacet } from \"@nosto/nosto-js/client\"\n\n/**\n * @group Components\n */\nexport interface KeywordsInCategoryProps {\n    /**\n     * Field name for category suggestion.\n     */\n    categoryField: string\n    /**\n     * Keyword object.\n     */\n    hit: SearchKeyword\n    /**\n     * Component to wrap keyword content component. For e.g. AutocompleteElement.\n     */\n    wrapperComponent?: ComponentType<WrapperProps>\n    /**\n     * Component for rendering keywords visual content.\n     */\n    keywordComponent: JSX.Element\n    /**\n     * Component for rendering keyword with category suggestion (default: KeywordInCategoryDefault)\n     */\n    keywordInCategoryComponent?: ComponentType<KeywordInCategoryProps>\n    /**\n     * Number of category suggestions to render (default: 3)\n     */\n    categorySuggestionCount?: number\n}\n\n/**\n * Component for rendering keywords with category suggestion.\n *\n * @example\n * ```jsx\n * <KeywordsInCategory\n *  hit={firstKeyword}\n *  categoryField={categoryField}\n *  keywordComponent={<Keyword hit={firstKeyword} />}\n *  wrapperComponent={({ keywordComponent, filter }) => (\n *      <Element\n *          keywordComponent={keywordComponent}\n *          hit={firstKeyword}\n *          filter={filter}\n *      />\n *  )}\n *  keywordInCategoryComponent={keywordInCategoryComponent}\n * />\n * ```\n *\n * @group Components\n */\nexport function KeywordsInCategory({\n    categoryField,\n    wrapperComponent,\n    hit,\n    keywordComponent,\n    keywordInCategoryComponent: KeywordInCategoryComponent = KeywordInCategory,\n    categorySuggestionCount = 3\n}: KeywordsInCategoryProps) {\n    const facet = hit.facets?.find((f): f is SearchTermsFacet => \"data\" in f && f.field === categoryField)\n\n    if (facet?.data?.length) {\n        return (\n            <>\n                <KeywordWrapper wrapperComponent={wrapperComponent}>{keywordComponent}</KeywordWrapper>\n                {facet.data.slice(0, categorySuggestionCount).map((category, index) => {\n                    return (\n                        <KeywordWrapper\n                            wrapperComponent={wrapperComponent}\n                            key={category.value ?? index}\n                            filter={{\n                                value: [category.value],\n                                field: categoryField\n                            }}\n                        >\n                            <KeywordInCategoryComponent category={category}>\n                                {keywordComponent}\n                            </KeywordInCategoryComponent>\n                        </KeywordWrapper>\n                    )\n                })}\n            </>\n        )\n    }\n\n    return <KeywordWrapper wrapperComponent={wrapperComponent}>{keywordComponent}</KeywordWrapper>\n}\n", "import { ComponentChildren, ComponentType, Fragment, h } from \"preact\"\nimport { WrapperProps } from \"./types\"\nimport type { InputSearchFilter } from \"@nosto/nosto-js/client\"\n\n/**\n * @group Components\n */\nexport interface KeywordWrapperProps {\n    wrapperComponent?: ComponentType<WrapperProps>\n    filter?: InputSearchFilter\n    children: ComponentChildren\n}\n\n/**\n * @group Components\n */\nexport function KeywordWrapper({ children, filter, wrapperComponent: Wrapper }: KeywordWrapperProps) {\n    return Wrapper ? <Wrapper keywordComponent={children} filter={filter} /> : <Fragment>{children}</Fragment>\n}\n", "import { ComponentChildren, h, JSX, RefCallback } from \"preact\"\nimport { useEffect, useRef } from \"preact/hooks\"\nimport { classJoin } from \"../helpers/classjoin\"\nimport {\n    getHandleCenterPosition,\n    getMousePosition,\n    getTouchPosition,\n    isEventFromHandle,\n    isNotCorrectTouchEvent,\n    noop\n} from \"./utils\"\nimport { Marks } from \"./Marks\"\nimport { Steps } from \"./Steps\"\n\n/**\n * @group Components\n */\nexport interface AbstractSliderProps {\n    /** Minimum value */\n    min?: number\n    /** Maximum value */\n    max?: number\n    /** Value to be added or subtracted on each step the slider makes */\n    step?: number\n    /** Marks on the slider */\n    marks?: SliderMarks\n    /** Show dots on slider (with step as interval)? */\n    dots?: boolean\n    /** As continuous value interval (otherwise, as independent values)? */\n    included?: boolean\n    /** Vertical mode? */\n    vertical?: boolean\n    /** Control disabled? */\n    disabled?: boolean\n    /** Component main class name */\n    className?: string\n    /** Prefix for secondary class names in component */\n    classesPrefix?: string\n    /** Triggered before value is start to change (on mouse down, etc) */\n    onBeforeChange?(value: SliderValue): void\n    /** Triggered while the value of Slider changing */\n    onChange?(value: SliderValue): void\n    /** Triggered after slider changes stop (on mouse up, etc) */\n    onAfterChange?(value: SliderValue): void\n    /** A function to format value on tooltip */\n    tipFormatter?(value: number): ComponentChildren\n    tracks?: JSX.Element[]\n    handles?: JSX.Element[]\n    bounds?: number[]\n    upperBound?: number\n    lowerBound?: number\n    onStart?: (position: number) => void\n    onEnd?: () => void\n    onMove?: (position: number) => void\n    sliderRefCallback?: RefCallback<HTMLDivElement> | undefined\n    handlesRefs?: Element[]\n    activeHandle?: number | null\n    children?: ComponentChildren\n}\n\n/**\n * Marks on the slider. The key determines the position, and the value\n * determines what will show.\n */\nexport interface SliderMarks {\n    [key: number]: ComponentChildren\n}\n\n/**\n * Allowed type of slider value.\n */\nexport type SliderValue = number | number[]\n\n/**\n * Buttons in MouseEvent.button.\n */\nconst MouseButtons = {\n    LEFT: 0,\n    MODDLE: 1,\n    RIGHT: 2,\n    BACK: 3,\n    FORWARD: 4\n} as const\n\n/**\n * Abstract slider class (for single and multi slider).\n *\n * @group Components\n */\nexport function AbstractSlider({\n    min = 0,\n    max = 100,\n    step = 1,\n    marks = {},\n    dots = false,\n    included = true,\n    vertical = false,\n    disabled = false,\n    className = \"range-slider\",\n    classesPrefix = \"\",\n    children,\n    tracks = [],\n    handles = [],\n    bounds = [],\n    lowerBound = 0,\n    upperBound = 0,\n    sliderRefCallback,\n    activeHandle = null,\n    handlesRefs = [],\n    onStart = noop,\n    onEnd = noop,\n    onMove = noop,\n    onAfterChange = noop\n}: AbstractSliderProps) {\n    /**\n     * Current cursor offset while dragging.\n     */\n    const dragOffset = useRef(0)\n    const sliderRef = useRef<HTMLDivElement | null>(null)\n\n    /**\n     * Pass ref to the parent component.\n     */\n    useEffect(() => {\n        if (sliderRefCallback) {\n            sliderRefCallback(sliderRef.current)\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    /**\n     * Effect is necessary on every render to get latest props in event listener methods.\n     */\n    useEffect(() => {\n        removeDocumentEvents()\n\n        if (activeHandle === null) {\n            return\n        }\n\n        addDocumentMouseEvents()\n        addDocumentTouchEvents()\n\n        return () => {\n            removeDocumentEvents()\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    })\n\n    const classes = classJoin(\n        {\n            [`with-marks`]: !!Object.keys(marks).length,\n            vertical,\n            disabled,\n            [className]: true\n        },\n        cl => classesPrefix + cl\n    )\n\n    /**\n     * Start mouse event.\n     */\n    function onMouseDown(event: MouseEvent): void {\n        if (event.button !== MouseButtons.LEFT) {\n            return\n        }\n\n        let position: number = getMousePosition(vertical, event)\n\n        if (isEventFromHandle(event, handlesRefs) && event.target instanceof Element) {\n            const handlePosition = getHandleCenterPosition(vertical, event.target)\n            dragOffset.current = position - handlePosition\n            position = handlePosition\n        } else {\n            dragOffset.current = 0\n        }\n\n        onStart(position)\n    }\n\n    /**\n     * Start touch event.\n     */\n    function onTouchStart(event: TouchEvent): void {\n        if (isNotCorrectTouchEvent(event)) {\n            return\n        }\n\n        let position: number = getTouchPosition(vertical, event)\n\n        if (isEventFromHandle(event, handlesRefs) && event.target instanceof Element) {\n            const handlePosition = getHandleCenterPosition(vertical, event.target)\n            dragOffset.current = position - handlePosition\n            position = handlePosition\n        } else {\n            dragOffset.current = 0\n        }\n\n        onStart(position)\n    }\n\n    /**\n     * Mouse moving.\n     */\n    function onMouseMove(event: MouseEvent): void {\n        if (!sliderRef.current) {\n            onEnd()\n\n            return\n        }\n\n        const position = getMousePosition(vertical, event)\n        onMove(position - dragOffset.current)\n    }\n\n    /**\n     * Touch moving.\n     */\n    function onTouchMove(event: TouchEvent): void {\n        if (!sliderRef.current || isNotCorrectTouchEvent(event)) {\n            onEnd()\n\n            return\n        }\n\n        const position = getTouchPosition(vertical, event)\n        onMove(position - dragOffset.current)\n    }\n\n    /**\n     * Stop mouse/touch event.\n     */\n    function onEventEnd(): void {\n        onEnd()\n        onAfterChange(bounds)\n    }\n\n    /**\n     * Add mouse events to the document.\n     */\n    function addDocumentMouseEvents(): void {\n        document.addEventListener(\"mousemove\", onMouseMove)\n        document.addEventListener(\"mouseup\", onEventEnd)\n    }\n\n    /**\n     * Add touch events to the document.\n     */\n    function addDocumentTouchEvents(): void {\n        document.addEventListener(\"touchmove\", onTouchMove)\n        document.addEventListener(\"touchend\", onEventEnd)\n    }\n\n    /**\n     * Remove mouse and touch events from the document.\n     */\n    function removeDocumentEvents(): void {\n        document.removeEventListener(\"mousemove\", onMouseMove)\n        document.removeEventListener(\"mouseup\", onEventEnd)\n\n        document.removeEventListener(\"touchmove\", onTouchMove)\n        document.removeEventListener(\"touchend\", onEventEnd)\n    }\n\n    /**\n     * Render base markup of the component.\n     */\n    return (\n        <div\n            class={classes}\n            ref={sliderRef}\n            onTouchStart={disabled ? noop : onTouchStart}\n            onMouseDown={disabled ? noop : onMouseDown}\n        >\n            <div class={`${classesPrefix}rail`} />\n            {tracks}\n            <Steps\n                vertical={vertical}\n                marks={marks}\n                dots={dots}\n                step={step}\n                included={included}\n                lowerBound={lowerBound}\n                upperBound={upperBound}\n                max={max}\n                min={min}\n                classesPrefix={classesPrefix}\n            />\n            {handles}\n            <Marks\n                vertical={vertical}\n                marks={marks}\n                included={included}\n                lowerBound={lowerBound}\n                upperBound={upperBound}\n                max={max}\n                min={min}\n                classesPrefix={classesPrefix}\n            />\n            {children}\n        </div>\n    )\n}\n", "const defaultMapper = (v: string) => v\n\n/**\n * Conditionally join class names together.\n */\nexport function classJoin(classes: Record<string, unknown>, mapper = defaultMapper) {\n    return Object.keys(classes)\n        .filter(k => classes[k])\n        .map(mapper)\n        .join(\" \")\n}\n", "import { SliderMarks } from \"./AbstractSlider\"\n\n/**\n * No operation.\n */\nexport function noop(..._rest: unknown[]): void {\n    // No operation\n}\n\n/**\n * Clamp value to the range.\n */\nexport function clampValue(value: number, { min, max }: { min: number; max: number }): number {\n    if (value <= min) {\n        return min\n    }\n\n    if (value >= max) {\n        return max\n    }\n\n    return value\n}\n\n/**\n * Is value out of range?\n */\nexport function isValueOutOfRange(value: number, { min, max }: { min: number; max: number }): boolean {\n    return value < min || value > max\n}\n\n/**\n * Get precision from step.\n */\nfunction getPrecision(step: number): number {\n    const stepString = step.toString()\n    const dotIndex = stepString.indexOf(\".\")\n    let precision = 0\n\n    if (dotIndex !== -1) {\n        precision = stepString.length - dotIndex - 1\n    }\n\n    return precision\n}\n\n/**\n * Properties required to align value.\n */\nexport interface AlignValueProps {\n    marks: SliderMarks\n    step: number\n    min: number\n}\n\n/**\n * Get point on slider closest to value.\n */\nfunction getClosestPoint(value: number, { marks, step, min }: AlignValueProps): number {\n    const points = Object.keys(marks).map(Number)\n\n    if (step != null && step > 0) {\n        const closestStep = Math.round((value - min) / step) * step + min\n        points.push(closestStep)\n    }\n\n    const diffs = points.map(point => Math.abs(value - point))\n\n    return points[diffs.indexOf(Math.min(...diffs))] || min\n}\n\n/**\n * Align value to available values using step and marks.\n */\nexport function alignValue(value: number, { step, marks, min }: AlignValueProps): number {\n    const closestPoint = getClosestPoint(value, { step, marks, min })\n\n    return (\n        // If step is less or equal 0, value is taken from marks and should\n        // not be rounded.\n        step == null || step <= 0 ? closestPoint : Number(closestPoint.toFixed(getPrecision(step)))\n    )\n}\n\n/**\n * Get center position of handle element.\n */\nexport function getHandleCenterPosition(vertical: boolean, handle: Element): number {\n    const coords = handle.getBoundingClientRect()\n\n    return vertical ? coords.top + coords.height / 2 : coords.left + coords.width / 2\n}\n\n/**\n * Get mouse position.\n */\nexport function getMousePosition(vertical: boolean, event: MouseEvent): number {\n    return vertical ? event.clientY : event.pageX\n}\n\n/**\n * Get touch position.\n */\nexport function getTouchPosition(vertical: boolean, event: TouchEvent): number {\n    return vertical ? event.touches[0]!.clientY : event.touches[0]!.pageX\n}\n/**\n * Is event from handle?\n */\nexport function isEventFromHandle(event: Event, handles: Element[]): boolean {\n    return handles.some(handle => event.target === handle)\n}\n\n/**\n * Is touch event is not correct to move handle?\n */\nexport function isNotCorrectTouchEvent(event: TouchEvent): boolean {\n    return event.touches.length > 1 || (event.type.toLowerCase() === \"touchend\" && event.touches.length > 0)\n}\n", "import { h, JSX } from \"preact\"\nimport { classJoin } from \"../helpers/classjoin\"\nimport { SliderMarks } from \"./AbstractSlider\"\n\n/**\n * @group Components\n */\nexport interface MarksProps {\n    min: number\n    max: number\n    lowerBound: number\n    upperBound: number\n    marks: SliderMarks\n    included: boolean\n    vertical: boolean\n    classesPrefix: string\n}\n\n/**\n * Marks on the slider.\n *\n * @group Components\n */\nexport function Marks({ min, max, lowerBound, upperBound, marks, included, vertical, classesPrefix }: MarksProps) {\n    const marksKeys = Object.keys(marks)\n    const marksCount = marksKeys.length\n    const unit = 100 / (marksCount - 1)\n    const markWidth = unit * 0.9\n\n    const range = max - min\n\n    const elements = marksKeys\n        .map(Number)\n        .sort((a, b) => a - b)\n        .map(point => {\n            const active =\n                (!included && point === upperBound) || (included && point <= upperBound && point >= lowerBound)\n\n            const classes = classJoin(\n                {\n                    active,\n                    text: true\n                },\n                cl => `${classesPrefix}${cl}`\n            )\n\n            const style: JSX.CSSProperties = vertical\n                ? {\n                      marginBottom: \"-50%\",\n                      bottom: `${((point - min) / range) * 100}%`\n                  }\n                : {\n                      width: `${markWidth}%`,\n                      marginLeft: `${-markWidth / 2}%`,\n                      left: `${((point - min) / range) * 100}%`\n                  }\n\n            const markPoint = marks[point]\n\n            return (\n                <span class={classes} style={style} key={String(point)}>\n                    {markPoint}\n                </span>\n            )\n        })\n\n    return <div class={`${classesPrefix}marks`}>{elements}</div>\n}\n", "import { h, JSX } from \"preact\"\nimport { classJoin } from \"../helpers/classjoin\"\nimport { SliderMarks } from \"./AbstractSlider\"\n\n/**\n * @group Components\n */\nexport interface StepsProps {\n    min: number\n    max: number\n    step: number\n    lowerBound: number\n    upperBound: number\n    marks: SliderMarks\n    dots: boolean\n    included: boolean\n    vertical: boolean\n    classesPrefix: string\n}\n\n/**\n * Dots on the slider.\n *\n * @group Components\n */\nexport function Steps({\n    min,\n    max,\n    step,\n    lowerBound,\n    upperBound,\n    marks,\n    dots,\n    included,\n    vertical,\n    classesPrefix\n}: StepsProps) {\n    const range = max - min\n\n    const elements = calcPoints(marks, dots, step, min, max).map(point => {\n        const offset = `${(Math.abs(point - min) / range) * 100}%`\n        const style: JSX.CSSProperties = vertical ? { bottom: offset } : { left: offset }\n        const active = (!included && point === upperBound) || (included && point <= upperBound && point >= lowerBound)\n\n        const classes = classJoin({ active, dot: true }, cl => `${classesPrefix}${cl}`)\n\n        return <span class={classes} style={style} key={String(point)} />\n    })\n\n    return <div class={`${classesPrefix}steps`}>{elements}</div>\n}\n\n/**\n * Calc slider points.\n */\nfunction calcPoints(marks: SliderMarks, dots: boolean, step: number, min: number, max: number): number[] {\n    const points = Object.keys(marks).map(Number)\n\n    if (dots && step > 0) {\n        for (let i = min; i <= max; i = i + step) {\n            if (points.indexOf(i) === -1) {\n                points.push(i)\n            }\n        }\n    }\n\n    return points\n}\n", "import { ComponentChildren, h, JSX } from \"preact\"\nimport { useEffect, useRef } from \"preact/hooks\"\nimport { classJoin } from \"../helpers/classjoin\"\n\n/**\n * @group Components\n */\nexport interface HandleProps {\n    /** Vertical mode? */\n    vertical: boolean\n    /** Control disabled? */\n    disabled: boolean\n    /** Currently dragged? */\n    dragging: boolean\n    /** Minimum value */\n    min: number\n    refFn: (node: HTMLElement | null) => void\n    /** Maximum value */\n    max: number\n    /** Current value */\n    value: number\n    /** Handle index */\n    index: number\n    /** Handle offset, % */\n    offset: number\n    /** Prefix for class names */\n    classesPrefix: string\n    /** Label for handle */\n    label: string\n    /** Tip content */\n    children?: ComponentChildren\n}\n\n/**\n * Range handle.\n *\n * @group Components\n */\nexport function Handle({\n    min,\n    max,\n    value,\n    vertical,\n    disabled,\n    dragging,\n    index,\n    offset,\n    classesPrefix,\n    label,\n    children,\n    refFn\n}: HandleProps) {\n    const elementRef = useRef<HTMLElement | null>(null)\n\n    useEffect(() => {\n        if (dragging && elementRef.current) {\n            elementRef.current.focus()\n        }\n    }, [dragging])\n\n    const style: JSX.CSSProperties = vertical\n        ? {\n              bottom: `${offset}%`\n          }\n        : {\n              left: `${offset}%`\n          }\n\n    const classes = classJoin(\n        {\n            dragging,\n            handle: true,\n            [`handle-${index}`]: true\n        },\n        cl => `${classesPrefix}${cl}`\n    )\n\n    /**\n     * Save reference to element in DOM.\n     */\n    function saveElement(element: HTMLElement | null): void {\n        refFn(element)\n        if (element) {\n            elementRef.current = element\n        }\n    }\n\n    return (\n        <div\n            class={classes}\n            style={style}\n            role=\"slider\"\n            tabIndex={-1}\n            aria-orientation={vertical ? \"vertical\" : \"horizontal\"}\n            aria-disabled={true}\n            aria-valuemin={min}\n            aria-valuemax={max}\n            aria-valuenow={value}\n            aria-label={label}\n            ref={saveElement}\n        >\n            <span class={`${classesPrefix}tip`}>{children}</span>\n        </div>\n    )\n}\n", "import { h, JSX, RefCallback } from \"preact\"\nimport { alignValue, clampValue, isValueOutOfRange, noop } from \"./utils\"\nimport { AbstractSliderProps, AbstractSlider, SliderMarks } from \"./AbstractSlider\"\nimport { Handle } from \"./Handle\"\nimport { Track } from \"./Track\"\nimport { useCallback, useEffect, useRef, useState } from \"preact/hooks\"\n\n/**\n * @group Components\n */\nexport interface MultiSliderProps extends AbstractSliderProps {\n    /** Initial values of handles */\n    defaultValue: number[]\n    /** Current values of handles */\n    value?: number[]\n    /** How many ranges to render (handles count = count + 1) */\n    count?: number\n    /** Allow pushing of surrounding handles when moving with this distance */\n    pushable?: boolean | number\n    /** Allow handles to cross each other? */\n    allowCross?: boolean\n    /** Triggered before value is start to change (on mouse down, etc) */\n    onBeforeChange?(value: number[]): void\n    /** Triggered while the value of Slider changing */\n    onChange(value: number[]): void\n    /** Triggered after slider changes stop (on mouse up, etc) */\n    onAfterChange(value: number[]): void\n}\n\n/**\n * Cache of slider points.\n */\ninterface PointsCache {\n    marks: SliderMarks\n    step: number\n    points: number[]\n}\n\n/**\n * Slider with multiple handles.\n *\n * @group Components\n */\nexport function MultiSlider(props: MultiSliderProps): JSX.Element {\n    const {\n        count = 1,\n        allowCross = true,\n        pushable = false,\n        value = null,\n        defaultValue = null,\n        min = 0,\n        max = 100,\n        classesPrefix = \"\",\n        tipFormatter = String,\n        step = 1,\n        marks = {},\n        dots = false,\n        included = true,\n        vertical = false,\n        disabled = false,\n        className = \"range-slider\",\n        onBeforeChange = noop,\n        onAfterChange = noop,\n        onChange,\n        children\n    } = props\n\n    /**\n     * Cache of slider points.\n     */\n    const [pointsCache, setPointsCache] = useState<PointsCache | undefined>(undefined)\n    const [bounds, setBounds] = useState<number[]>([])\n    const [handle, setHandle] = useState<number | null>(null)\n    const [recent, setRecent] = useState<number>(0)\n    const setSliderRef = useCallback<RefCallback<HTMLDivElement>>(element => {\n        sliderRef.current = element\n    }, [])\n    /**\n     * Reference to slider in DOM.\n     */\n    const sliderRef = useRef<HTMLDivElement | null>(null)\n    /**\n     * References to handles in DOM.\n     */\n    const handlesRefs = useRef<Element[]>([])\n\n    useEffect(() => {\n        const initialValue = [...Array(count + 1)].map(() => min)\n\n        const values = value != null ? value : defaultValue != null ? defaultValue : initialValue\n\n        setBounds(values.map(value => clampAlignValue(value)))\n        setRecent(bounds[0] === max ? 0 : bounds.length - 1)\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    const previousBounds = useRef(bounds)\n    const previousProps = useRef(props)\n\n    useEffect(() => {\n        if (!(value || typeof min === \"number\" || typeof max === \"number\")) {\n            return\n        }\n\n        const nextValue = value || previousBounds.current\n        const nextBounds = nextValue.map(singleValue => clampAlignValue(singleValue, previousProps.current))\n\n        if (\n            nextBounds.length === previousBounds.current.length &&\n            nextBounds.every((singleValue, index) => singleValue === previousBounds.current[index])\n        ) {\n            return\n        }\n\n        setBounds(nextBounds)\n\n        if (previousBounds.current.some(singleValue => isValueOutOfRange(singleValue, { min, max }))) {\n            onChange(nextBounds)\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [value, min, max])\n\n    const offsets = bounds.map(value => calcOffset(value))\n\n    const handles = bounds.map((value, index) => (\n        <Handle\n            vertical={vertical}\n            disabled={disabled}\n            dragging={handle === index}\n            min={min}\n            max={max}\n            value={value}\n            index={index + 1}\n            offset={offsets[index]!}\n            classesPrefix={classesPrefix}\n            refFn={(node: HTMLElement | null) => {\n                saveHandle(node, index)\n            }}\n            key={`handle-${index}`}\n            label={index ? \"Upper bound\" : \"Lower bound\"}\n        >\n            {tipFormatter(value)}\n        </Handle>\n    ))\n\n    const tracks = bounds.slice(0, -1).map((_value, index) => {\n        const nextIndex = index + 1\n\n        return (\n            <Track\n                vertical={vertical}\n                included={true}\n                index={nextIndex}\n                offset={offsets[index]!}\n                length={offsets[nextIndex]! - offsets[index]!}\n                classesPrefix={classesPrefix}\n                key={`track-${index}`}\n            />\n        )\n    })\n\n    /**\n     * Save reference to handle element.\n     */\n    function saveHandle(node: HTMLElement | null, index: number = 0) {\n        if (!node) {\n            delete handlesRefs.current[index]\n        } else if (node instanceof HTMLElement) {\n            handlesRefs.current[index] = node\n        }\n    }\n\n    /**\n     * Get position, where slider starts in document (pixels).\n     */\n    function getSliderStart(): number {\n        const slider = sliderRef.current\n\n        if (!slider) {\n            return 0\n        }\n\n        const rect = slider.getBoundingClientRect()\n\n        return vertical ? rect.top : rect.left\n    }\n\n    /**\n     * Calc slider value based on a position in document.\n     */\n    function calcValueByPos(position: number): number {\n        const pixelOffset = position - getSliderStart()\n        const nextValue = clampAlignValue(calcValue(pixelOffset))\n\n        return nextValue\n    }\n\n    /**\n     * Calc slider value based on offset from slider element start.\n     */\n    function calcValue(offset: number): number {\n        const ratio = Math.abs(Math.max(offset, 0) / getSliderLength())\n        const value = vertical ? (1 - ratio) * (max - min) + min : ratio * (max - min) + min\n\n        return value\n    }\n\n    function getSliderLength(): number {\n        const slider = sliderRef.current\n\n        if (!slider) {\n            return 0\n        }\n\n        return vertical ? slider.clientHeight : slider.clientWidth\n    }\n\n    /**\n     * Calc offset in slider element based on a value.\n     */\n    function calcOffset(value: number): number {\n        const ratio = (value - min) / (max - min)\n\n        return ratio * 100\n    }\n\n    /**\n     * When value changed.\n     */\n    function handleChange(newState: { handle?: number | null; bounds: number[] }): void {\n        const isNotControlled = !value\n\n        if (isNotControlled) {\n            setBounds(newState.bounds)\n            if (newState.handle) {\n                setHandle(newState.handle)\n            }\n        } else if (typeof newState.handle !== \"undefined\") {\n            setHandle(newState.handle)\n        }\n        onChange(newState.bounds)\n    }\n\n    /**\n     * On mouse/touch start.\n     */\n    function onStart(position: number): void {\n        onBeforeChange?.(bounds)\n\n        const value = calcValueByPos(position)\n\n        const closestBound = getClosestBound(value)\n        const boundNeedMoving = getBoundNeedMoving(value, closestBound)\n\n        setHandle(boundNeedMoving)\n        setRecent(boundNeedMoving)\n\n        const prevValue = bounds[boundNeedMoving]\n\n        if (value === prevValue) {\n            return\n        }\n\n        const nextBounds = [...bounds]\n        nextBounds[boundNeedMoving] = value\n        handleChange({ bounds: nextBounds })\n    }\n\n    /**\n     * On mouse/touch move.\n     */\n    function onMove(position: number): void {\n        if (handle == null) {\n            return\n        }\n\n        const value = calcValueByPos(position)\n        const oldValue = bounds[handle]\n\n        if (value === oldValue) {\n            return\n        }\n\n        const nextBounds = [...bounds]\n        nextBounds[handle] = value\n\n        let nextHandle = handle\n\n        if (pushable !== false) {\n            const originalValue = bounds[nextHandle]\n            pushSurroundingHandles(nextBounds, nextHandle, originalValue!)\n        } else if (allowCross) {\n            nextBounds.sort((a, b) => a - b)\n            nextHandle = nextBounds.indexOf(value)\n        }\n\n        handleChange({\n            handle: nextHandle,\n            bounds: nextBounds\n        })\n    }\n\n    /**\n     * On mouse/touch end.\n     */\n    function onEnd(): void {\n        setHandle(null)\n    }\n\n    /**\n     * Clamp current value to min-max interval on align to available values\n     * using step and marks.\n     */\n    function clampAlignValue(value: number, nextProps: Partial<MultiSliderProps> = {}): number {\n        const mergedProps = { min, max, allowCross, marks, step, ...nextProps }\n        return alignValue(clampValueToSurroundingHandles(clampValue(value, mergedProps), mergedProps), mergedProps)\n    }\n\n    /**\n     * Get index of closes handle.\n     */\n    function getClosestBound(value: number): number {\n        let closestBound: number = 0\n\n        for (let i = 1, n = bounds.length - 1; i < n; i++) {\n            if (value > bounds[i]!) {\n                closestBound = i\n            }\n        }\n\n        if (Math.abs(bounds[closestBound + 1]! - value) < Math.abs(bounds[closestBound]! - value)) {\n            closestBound += 1\n        }\n\n        return closestBound\n    }\n\n    /**\n     * Get index of handle that should be moved.\n     */\n    function getBoundNeedMoving(value: number, closestBound: number): number {\n        let boundNeedMoving: number = closestBound\n\n        const nextBound = closestBound + 1\n        const atTheSamePoint = bounds[nextBound] === bounds[closestBound]\n\n        if (atTheSamePoint) {\n            if (bounds[recent] === bounds[closestBound]) {\n                boundNeedMoving = recent\n            } else {\n                boundNeedMoving = nextBound\n            }\n\n            if (value !== bounds[nextBound]) {\n                boundNeedMoving = value < bounds[nextBound]! ? closestBound : nextBound\n            }\n        }\n\n        return boundNeedMoving\n    }\n\n    /**\n     * Push surrounding handles.\n     */\n    function pushSurroundingHandles(bounds: number[], handle: number, originalValue: number): void {\n        const threshold = Number(pushable)\n        const value = bounds[handle]\n\n        let direction = 0\n\n        if (bounds[handle + 1]! - value! < threshold) {\n            // Push to right\n            direction = +1\n        }\n\n        if (value! - bounds[handle - 1]! < threshold) {\n            // Push to left\n            direction = -1\n        }\n\n        if (direction === 0) {\n            return\n        }\n\n        const nextHandle = handle + direction\n        const diffToNext = direction * (bounds[nextHandle]! - value!)\n\n        if (!pushHandle(bounds, nextHandle, direction, threshold - diffToNext)) {\n            // Revert to original value if pushing is impossible\n            bounds[handle] = originalValue\n        }\n    }\n\n    /**\n     * Push specific handle.\n     */\n    function pushHandle(bounds: number[], handle: number, direction: number, amount: number): boolean {\n        const originalValue = bounds[handle]\n        let currentValue = bounds[handle]\n\n        while (direction * (currentValue! - originalValue!) < amount) {\n            if (!pushHandleOnePoint(bounds, handle, direction)) {\n                // Can't push handle enough to create the needed `amount` gap,\n                // so we revert its position to the original value.\n                bounds[handle] = originalValue!\n\n                return false\n            }\n\n            currentValue = bounds[handle]\n        }\n\n        // The handle was pushed enough to create the needed `amount` gap\n\n        return true\n    }\n\n    /**\n     * Push specific handle by one point.\n     */\n    function pushHandleOnePoint(bounds: number[], handle: number, direction: number): boolean {\n        const points = getPoints()\n        const pointIndex = points.indexOf(bounds[handle]!)\n        const nextPointIndex = pointIndex + direction\n\n        if (nextPointIndex >= points.length || nextPointIndex < 0) {\n            // Reached the minimum or maximum available point, can't push anymore.\n            return false\n        }\n\n        const nextHandle = handle + direction\n        const nextValue = points[nextPointIndex]\n\n        const threshold = Number(pushable)\n\n        const diffToNext = direction * (bounds[nextHandle]! - nextValue!)\n\n        if (!pushHandle(bounds, nextHandle, direction, threshold - diffToNext)) {\n            // Couldn't push next handle, so we won't push this one either\n            return false\n        }\n\n        // Push the handle\n        bounds[handle] = nextValue!\n\n        return true\n    }\n\n    /**\n     * Returns an array of possible slider points, taking into account both\n     * `marks` and `step`. The result is cached.\n     */\n    function getPoints(): number[] {\n        const cache = pointsCache\n\n        if (!cache || cache.marks !== marks || cache.step !== step) {\n            const pointsObject = { ...marks }\n\n            if (step != null && step > 0) {\n                for (let point = min; point <= max; point += step) {\n                    pointsObject[point] = String(point)\n                }\n            }\n\n            const points = Object.keys(pointsObject).map(Number)\n\n            points.sort((a, b) => a - b)\n            setPointsCache({ marks, step, points })\n        }\n\n        return pointsCache?.points || []\n    }\n\n    /**\n     * Clamp value to interval of surrounding handles.\n     */\n    function clampValueToSurroundingHandles(value: number, { allowCross }: { allowCross: boolean }): number {\n        if (!allowCross && handle != null) {\n            if (handle > 0 && value <= bounds[handle - 1]!) {\n                return bounds[handle - 1]!\n            }\n            if (handle < bounds.length - 1 && value >= bounds[handle + 1]!) {\n                return bounds[handle + 1]!\n            }\n        }\n\n        return value\n    }\n\n    return (\n        <AbstractSlider\n            min={min}\n            max={max}\n            vertical={vertical}\n            disabled={disabled}\n            classesPrefix={classesPrefix}\n            tracks={tracks}\n            handles={handles}\n            bounds={bounds}\n            upperBound={bounds[bounds.length - 1]!}\n            lowerBound={bounds[0]!}\n            handlesRefs={handlesRefs.current}\n            activeHandle={handle}\n            step={step}\n            marks={marks}\n            dots={dots}\n            included={included}\n            className={className}\n            onBeforeChange={onBeforeChange}\n            onAfterChange={onAfterChange}\n            onChange={onChange}\n            onStart={onStart}\n            onEnd={onEnd}\n            onMove={onMove}\n            sliderRefCallback={setSliderRef}\n            tipFormatter={tipFormatter}\n        >\n            {children}\n        </AbstractSlider>\n    )\n}\n", "import { h, JSX } from \"preact\"\n\n/**\n * @group Components\n */\nexport interface TrackProps {\n    /** Vertical mode? */\n    vertical: boolean\n    /** Continuous value interval? */\n    included: boolean\n    /** Track index */\n    index: number\n    /** Track offset, % */\n    offset: number\n    /** Track length, % */\n    length: number\n    /** Prefix for class names */\n    classesPrefix: string\n}\n\n/**\n * Track line in range.\n *\n * @group Components\n */\nexport function Track({ vertical, included, index, offset, length, classesPrefix }: TrackProps) {\n    const style: JSX.CSSProperties = {}\n\n    if (!included) {\n        style.visibility = \"hidden\"\n    }\n\n    if (vertical) {\n        style.bottom = `${offset}%`\n        style.height = `${length}%`\n    } else {\n        style.left = `${offset}%`\n        style.width = `${length}%`\n    }\n\n    return <div class={`${classesPrefix}track ${classesPrefix}track-${index}`} style={style} />\n}\n", "import { h, Fragment } from \"preact\"\nimport { MultiSlider } from \"./MultiSlider\"\nimport { useRange } from \"../hooks/useRange\"\n\n/**\n * @group Components\n */\nexport interface RangeSliderProps {\n    /**\n     * Facet ID from the response, in most cases it is the same as field name.\n     */\n    id: string\n    /**\n     * Callback that will be called when the user releases slider handle.\n     */\n    onChange?(range: [number, number]): void\n    /**\n     * Callback that will be called when sliding the slider.\n     */\n    onSlide?(range: [number, number]): void\n    /**\n     * Prefix that will be appended to all component classes.\n     *\n     * @default 'ns-'\n     */\n    classesPrefix?: string\n    /**\n     * Component wrapper class.\n     *\n     * @default 'ns-range-slider'\n     */\n    className?: string\n    /**\n     * Callback to format display value.\n     */\n    valueFormat?: (value: number) => string\n}\n\n/**\n * Range slider component that renders range slider based on response stats facet.\n *\n * @example\n * ```tsx\n * return (props) => {\n *  return <RangeSlider id={props.facet.id}/>\n * }\n * ```\n *\n * @group Components\n */\nexport function RangeSlider(props: RangeSliderProps) {\n    const { min, max, range, updateRange } = useRange(props.id)\n\n    return typeof min === \"number\" && typeof max === \"number\" && min !== max ? (\n        <MultiSlider\n            key={`range_slider_${min}_${max}_${range.join(\"_\")}`}\n            classesPrefix={props.classesPrefix || \"ns-\"}\n            className={props.className || \"range-slider\"}\n            onChange={([from, to]) => {\n                if (props.onSlide) {\n                    props.onSlide([Math.floor(from || min), Math.ceil(to || max)])\n                }\n            }}\n            onAfterChange={([from, to]) => {\n                updateRange([from, to])\n            }}\n            defaultValue={[Math.floor(range[0] || min), Math.ceil(range[1] || max)]}\n            min={Math.floor(min)}\n            max={Math.ceil(max)}\n            tipFormatter={props.valueFormat}\n        />\n    ) : (\n        <Fragment />\n    )\n}\n", "import { h } from \"preact\"\nimport { useLoadMore } from \"../hooks/useLoadMore\"\nimport {\n    InfiniteScrollWithLink as InfiniteScrollWithLinkBase,\n    InfiniteScrollProps\n} from \"@nosto/search-js/preact/common\"\nimport { isBot } from \"@nosto/search-js/utils\"\nimport { InfiniteScrollWithObserver, intersectionObserverSupported } from \"@nosto/search-js/preact/legacy\"\n\n/**\n * Infinite scroll component that loads more results when user scrolls to the end of the page.\n * If the browser does not support IntersectionObserver, a load more button is shown instead.\n * @param props\n * @example\n * ```jsx\n * <InfiniteScroll pageSize={defaultConfig.pageSize}>\n *    {products?.hits?.map(hit => <Product hit={hit} />)}\n * </InfiniteScroll>\n *\n * <InfiniteScroll pageSize={defaultConfig.pageSize}>\n *    <Products />\n * </InfiniteScroll>\n *\n * // With custom load more button\n * function LoadMoreButton({ pageSize }) {\n *     const { loadMore, href } = useLoadMore(pageSize)\n *\n *     return (\n *         <a\n *              class=\"ns-load-more-button ns-act-btn ns-act-btn-light\"\n *              onClick={loadMore}\n *              href={href}\n *          >\n *              More results\n *         </a>\n *    )\n * }\n *\n * <InfiniteScroll loadMoreComponent={LoadMoreButton} pageSize={defaultConfig.pageSize}>\n *   {products?.hits?.map(hit => <Product hit={hit} />)}\n * </InfiniteScroll>\n * ```\n * @group Components\n */\nexport const InfiniteScroll =\n    !isBot() && intersectionObserverSupported() ? InfiniteScrollWithObserver : InfiniteScrollWithLink\n\n/**\n * @group Components\n */\nexport function InfiniteScrollWithLink({ loadMoreComponent, ...restProps }: InfiniteScrollProps) {\n    const loadMore = loadMoreComponent || LoadMoreLink\n    return <InfiniteScrollWithLinkBase {...restProps} loadMoreComponent={loadMore} />\n}\n\n/**\n * @group Components\n */\nfunction LoadMoreLink({ pageSize }: { pageSize?: number }) {\n    const { loadMore, href } = useLoadMore(pageSize)\n\n    return (\n        <a class=\"ns-load-more-button ns-act-btn ns-act-btn-light ns-text-align-center\" onClick={loadMore} href={href}>\n            More results\n        </a>\n    )\n}\n", "import { h, Fragment, cloneElement, JSX } from \"preact\"\nimport { useAppStateSelector } from \"../hooks/useAppStateSelector\"\nimport { nostojs } from \"@nosto/nosto-js\"\nimport { savePageScroll } from \"../helpers/dom\"\n\n/**\n * @group Components\n */\nexport type SerpElementProps = {\n    hit: {\n        productId: string\n        url?: string\n    }\n    onClick: (event: Event) => void\n    as?: string\n} & JSX.HTMLAttributes &\n    JSX.SVGAttributes\n\n/**\n * SerpElement is a wrapper component that can be used to wrap any element in the search result list.\n *\n * @group Components\n */\nexport function SerpElement({ children, hit, as, onClick, ...rest }: SerpElementProps): JSX.Element {\n    const pageType = useAppStateSelector(state => state.pageType)\n    const track = pageType === \"category\" ? \"category\" : pageType === \"search\" ? \"serp\" : undefined\n\n    const childArray = children instanceof Array ? children : [children]\n\n    if (as) {\n        return h(\n            as,\n            {\n                ...(as === \"a\" && hit && typeof hit === \"object\" && \"url\" in hit && typeof hit.url === \"string\"\n                    ? {\n                          href: hit.url\n                      }\n                    : {}),\n                ...rest,\n                onClick: (event: MouseEvent) => {\n                    if (hit && track) {\n                        nostojs(api => api.recordSearchClick(track, hit))\n                    }\n                    savePageScroll()\n                    return onClick?.(event)\n                }\n            },\n            ...childArray\n        )\n    }\n\n    return (\n        <Fragment>\n            {childArray.map((child, index) => {\n                if (child && typeof child === \"object\" && \"props\" in child) {\n                    const onClick: JSX.HTMLAttributes[\"onClick\"] = event => {\n                        if (hit && track) {\n                            nostojs(api => api.recordSearchClick(track, hit))\n                        }\n                        savePageScroll()\n                        if (typeof child.props?.onClick == \"function\") {\n                            child.props.onClick(event)\n                        }\n                    }\n\n                    return cloneElement(child, {\n                        ...child.props,\n                        onClick,\n                        key: index\n                    })\n                }\n                return child\n            })}\n        </Fragment>\n    )\n}\n", "import { nostojs } from \"@nosto/nosto-js\"\n\n/**\n * Reports a click to Nosto.\n *\n * @deprecated Use `window.nostojs` instead.\n */\nexport function reportClick(type: \"serp\" | \"autocomplete\" | \"category\", hit: { productId: string; url?: string }) {\n    nostojs(api => api.recordSearchClick(type, hit))\n}\n", "import type { InputSearchSort } from \"@nosto/nosto-js/client\"\n\nexport interface SortOption {\n    id: string\n    value: {\n        name: string\n        sort: InputSearchSort[]\n    }\n}\n\nexport function createSortOption(id: string, name: string, ...sort: InputSearchSort[]) {\n    return { id, value: { name, sort } }\n}\n\nexport function isMatchingSort(optionSort: InputSearchSort[], querySort: InputSearchSort[]) {\n    if (optionSort.length !== querySort.length) {\n        return false\n    }\n    return optionSort.every(v1 => querySort.find(v2 => v1.field === v2.field && v1.order === v2.order))\n}\n", "export interface CurrencyFormatOptions {\n    locale: string\n    fractionDigits: number\n}\n\nconst defaultOptions = {\n    locale: \"en-US\",\n    fractionDigits: 2\n}\n\nexport const currencyOptions: Record<string, CurrencyFormatOptions> = {\n    EUR: { locale: \"de-DE\", fractionDigits: 2 },\n    GBP: { locale: \"en-GB\", fractionDigits: 2 },\n    USD: { locale: \"en-US\", fractionDigits: 2 },\n    AUD: { locale: \"en-AU\", fractionDigits: 2 },\n    CAD: { locale: \"en-CA\", fractionDigits: 2 }\n}\n\n/**\n * @deprecated use useCurrencyFormatting hook instead\n */\nexport function configureCurrency(currency: string, options: CurrencyFormatOptions) {\n    currencyOptions[currency] = options\n}\n\n/**\n * @deprecated use useCurrencyFormatting hook instead\n * Formats a number as a currency string\n */\nexport function formatCurrency(value: number, currency: string = \"EUR\") {\n    const { locale, fractionDigits } = currencyOptions[currency] ?? defaultOptions\n\n    const numberFormat = new Intl.NumberFormat(locale, {\n        style: \"currency\",\n        currency,\n        minimumFractionDigits: fractionDigits,\n        maximumFractionDigits: fractionDigits\n    })\n    return numberFormat.format(value)\n}\n", "export type GroupsType<T> = Record<string | number, T[]>\n\nexport default function groupBy<T>(list: T[], callback: (group: T, index: number) => string) {\n    return list.reduce<GroupsType<T>>((groups, item, index) => {\n        const field = callback(item, index)\n        const group = groups[field] || []\n        group.push(item)\n        groups[field] = group\n        return groups\n    }, {})\n}\n", "import { i as m } from \"../index.es-B8mbAxS4.js\";\nfunction s({ size: n, productId: a, hash: c }) {\n  const i = m();\n  if (!i)\n    throw new Error(\"Client script settings are not yet available\");\n  return `https://${i.thumbnailHost}/${i.account}/${n}/${a}/${c}/A`;\n}\nfunction l({ size: n }) {\n  function a(u, r) {\n    if (r)\n      return s({\n        size: n,\n        productId: u,\n        hash: r\n      });\n  }\n  function c(u, r) {\n    if (r)\n      return r.map((t) => ({\n        ...t,\n        imageUrl: a(u, t.imageHash) ?? t.imageUrl\n      }));\n  }\n  function i(u, r, t) {\n    if (!t)\n      return r;\n    if (r)\n      return t.map(\n        (e) => s({\n          size: n,\n          productId: u,\n          hash: e\n        })\n      );\n  }\n  return function(r) {\n    const t = r.productId;\n    return t ? {\n      ...r,\n      imageUrl: a(t, r.imageHash) ?? r.imageUrl,\n      thumbUrl: a(t, r.thumbHash) ?? r.thumbUrl,\n      skus: c(t, r.skus),\n      alternateImageUrls: i(t, r.alternateImageUrls, r.alternateImageHashes)\n    } : r;\n  };\n}\nconst p = /cdn\\.shopify\\.com/, f = {\n  1: \"170x170\",\n  2: \"100x100\",\n  3: \"90x70\",\n  4: \"50x50\",\n  5: \"30x30\",\n  6: \"100x140\",\n  7: \"200x200\",\n  8: \"400x400\",\n  9: \"750x750\"\n};\nfunction g(n) {\n  return n in f;\n}\nfunction U({ size: n, fallback: a = (c) => c }) {\n  if (n === \"orig\")\n    return a;\n  const c = f[n] || n;\n  function i(e) {\n    return e ? new URL(e).hostname.match(p) : !1;\n  }\n  function u(e) {\n    return e ? i(e) ? e.replace(/(\\.jpg|\\.png|\\.jpeg|\\.gif|\\.webp)/, `_${c}$1`) : e : \"\";\n  }\n  function r(e) {\n    if (e)\n      return e.map((o) => ({\n        ...o,\n        imageUrl: u(o.imageUrl)\n      }));\n  }\n  function t(e) {\n    if (e)\n      return e.map((o) => u(o));\n  }\n  return function(o) {\n    return i(o.imageUrl) ? {\n      ...o,\n      imageUrl: u(o.imageUrl),\n      thumbUrl: u(o.thumbUrl),\n      skus: r(o.skus),\n      alternateImageUrls: t(o.alternateImageUrls)\n    } : a(o);\n  };\n}\nfunction d() {\n  var n;\n  return (n = window.Nosto) == null ? void 0 : n.shopifyScript;\n}\nfunction x({ size: n }) {\n  const a = l({ size: n });\n  return d() && g(n) ? U({ size: n, fallback: a }) : a;\n}\nexport {\n  s as generateThumbnailUrl,\n  l as nostoThumbnailDecorator,\n  U as shopifyThumbnailDecorator,\n  x as thumbnailDecorator\n};\n"],
  "mappings": "ubAAA,IAAAA,GAAA,GAAAC,GAAAD,GAAA,oBAAAE,GAAA,wBAAAC,GAAA,gCAAAC,GAAA,6BAAAC,GAAA,yBAAAC,GAAA,WAAAC,GAAA,mBAAAC,GAAA,2BAAAC,GAAA,mBAAAC,GAAA,2BAAAC,GAAA,sBAAAC,GAAA,mBAAAC,GAAA,aAAAC,GAAA,uBAAAC,GAAA,UAAAC,GAAA,gBAAAC,GAAA,gBAAAC,GAAA,uBAAAC,GAAA,gBAAAC,GAAA,UAAAC,GAAA,iBAAAC,GAAA,UAAAC,GAAA,6BAAAC,GAAA,2BAAAC,GAAA,sBAAAC,GAAA,qBAAAC,GAAA,gBAAAC,GAAA,oBAAAC,GAAA,mBAAAC,GAAA,YAAAC,GAAA,SAAAC,GAAA,qBAAAC,GAAA,oBAAAC,GAAA,SAAAC,GAAA,mBAAAC,GAAA,gBAAAC,GAAA,8BAAAC,GAAA,0BAAAC,GAAA,uBAAAC,GAAA,eAAAC,GAAA,gBAAAC,GAAA,wBAAAC,EAAA,cAAAC,GAAA,0BAAAC,GAAA,2BAAAC,GAAA,aAAAC,GAAA,cAAAC,GAAA,gBAAAC,GAAA,kBAAAC,GAAA,sBAAAC,GAAA,aAAAC,GAAA,qBAAAC,GAAA,mBAAAD,GAAA,gBAAAE,GAAA,4BAAAC,GAAA,wBAAAC,GAAA,mBAAAC,GAAA,YAAAC,GAAA,oBAAAC,GAAA,aAAAC,GAAA,mBAAAC,KAAA,eAAAC,GAAA9D,ICAA,IAAA+D,GAA6C,kBCA7C,SAASC,IAAI,CAAb,IAAAC,EACE,OAAO,SAAUA,EAAA,OAAO,UAAP,KAAAA,EAAkB,SAASC,EAAG,CADjD,IAAAD,GAEK,OAAO,QAAQ,GAAIA,EAAA,OAAO,QAAQ,IAAf,KAAAA,EAAoB,CAAC,GAAG,KAAKC,CAAC,CACpD,CACF,CACA,eAAeC,EAAED,EAAG,CAClB,OAAO,OAAO,QAAQA,CAAC,CACzB,CACA,IAAIE,GAAI,KACR,OAAO,OAAS,MAAQJ,GAAE,EAAGG,EAAGD,GAAM,CACpCE,GAAIF,EAAE,SAAS,YAAY,CAC7B,CAAC,GCwCD,OAAO,OAAS,KAAOG,GAAE,EChDzB,SAASC,IAAqC,CAC1C,MAAM,IAAI,MAAM,iBAAiB,CACrC,CAEO,IAAMC,EAAU,CACnB,WAAYD,GACZ,aAAcA,GACd,SAAUA,GACV,UAAWA,EACf,EAEAE,EAAQC,GAAO,CACXF,EAAQ,WAAa,IAAG,CAf5B,IAAAG,EAe+B,OAAAA,EAAAD,EAAI,YAAY,EAAE,cAAlB,YAAAC,EAAgC,IAC3DH,EAAQ,aAAe,IAAG,CAhB9B,IAAAG,EAgBiC,OAAAA,EAAAD,EAAI,YAAY,EAAE,aAAlB,YAAAC,EAA+B,IAC5DH,EAAQ,SAAW,IAAME,EAAI,YAAY,EAAE,SAC3CF,EAAQ,UAAY,IAAME,EAAI,YAAY,EAAE,SAChD,CAAC,EAEM,SAASE,GAA4BC,EAA6D,CACrGJ,EAAQC,GAAO,CACXA,EAAI,SAAS,mBACT,cACA,IAAM,CAzBlB,IAAAC,EA2BgB,IAAMG,EADS,IAAI,gBAAgB,OAAO,SAAS,MAAM,EAC/B,MAAIH,EAAAE,EAAO,iBAAP,YAAAF,EAAuB,QAAS,EAAE,EAChE,OAAOG,EAAa,CAACA,CAAU,EAAI,MACvC,EACA,CAAE,SAAU,EAAK,CACrB,CACJ,CAAC,CACL,CHxBO,IAAMC,GAAgB,CACzB,sBAAuB,EACvB,eAAgB,GAChB,YAAa,EACb,eAAgB,CACZ,KAAM,OACN,MAAO,QACP,+BAAgC,MAChC,SAAU,WACV,YAAa,cACb,QAAS,UACT,KAAM,OACN,SAAU,WACV,SAAU,UACd,EACA,gBAAiB,MACjB,iBAAkB,GAClB,WAAY,IAAMC,EAAQ,WAAW,EACrC,aAAc,IAAMA,EAAQ,aAAa,EACzC,YAAa,IAAMA,EAAQ,UAAU,EAErC,eAA4B,CACxB,MAAO,CACH,SAAU,CACN,WAAY,KAAK,WAAY,EAC7B,aAAc,KAAK,aAAc,EACjC,KAAM,KAAK,SACX,KAAM,CACV,CACJ,CACJ,EACA,eAAgB,IAAMA,EAAQ,SAAS,IAAM,WAC7C,sBAAuB,GACvB,cAAe,IACf,sBAAuB,GACvB,YAAa,GACb,mBAAoB,GACpB,mBAAoBC,GAASA,EAC7B,cAAe,CAAC,EAChB,QAAS,EACT,cAAe,IACf,oBAAqB,EACzB,EAkaaC,MAAgB,kBAA0BH,EAAa,EA+B7D,SAASI,GAAaC,EAAyBC,EAAiE,CACnH,IAAMC,EAAQF,EAAOC,CAAU,EAC/B,OAAI,OAAOC,GAAU,WACVA,EAAM,KAAKF,CAAM,EAAE,EAEvBE,CACX,CIzfA,IAAAC,GAA2B,wBAsBpB,SAASC,IAAY,CACxB,SAAO,eAAWC,EAAa,CACnC,CCzBA,SAASC,IAAI,CAAb,IAAAC,EACE,OAAO,SAAUA,EAAA,OAAO,UAAP,KAAAA,EAAkB,SAASC,EAAG,CADjD,IAAAD,GAEK,OAAO,QAAQ,GAAIA,EAAA,OAAO,QAAQ,IAAf,KAAAA,EAAoB,CAAC,GAAG,KAAKC,CAAC,CACpD,CACF,CACA,eAAeC,EAAED,EAAG,CAClB,OAAO,OAAO,QAAQA,CAAC,CACzB,CACA,IAAIE,GAAI,KACR,OAAO,OAAS,MAAQJ,GAAE,EAAGG,EAAGD,GAAM,CACpCE,GAAIF,EAAE,SAAS,YAAY,CAC7B,CAAC,GACD,SAASG,IAAI,CACX,OAAOD,EACT,CAOA,OAAO,OAAS,KAAOE,GAAE,ECpBzB,IAAMC,GAAKC,GAAM,OAAOA,CAAC,IAAM,kBAC/B,SAASC,GAAED,EAAG,CACZ,GAAI,CAACD,GAAEC,CAAC,EACN,MAAO,GACT,IAAME,EAAIF,EAAE,YACZ,GAAIE,IAAM,OACR,MAAO,GACT,IAAMC,EAAID,EAAE,UACZ,MAAO,EAAE,CAACH,GAAEI,CAAC,GAAK,CAACA,EAAE,eAAe,eAAe,EACrD,CACA,SAASC,EAAEJ,EAAGE,EAAG,CACf,GAAIF,IAAME,EACR,MAAO,GACT,GAAIF,aAAa,MAAQE,aAAa,KACpC,OAAOF,EAAE,QAAQ,IAAME,EAAE,QAAQ,EACnC,GAAI,MAAM,QAAQF,CAAC,GAAK,MAAM,QAAQE,CAAC,EACrC,OAAOF,EAAE,SAAWE,EAAE,OAAS,GAAKF,EAAE,MAAM,CAACG,EAAGE,IAAMD,EAAED,EAAGD,EAAEG,CAAC,CAAC,CAAC,EAClE,GAAIJ,GAAED,CAAC,GAAKC,GAAEC,CAAC,EAAG,CAChB,IAAMC,EAAI,OAAO,QAAQH,CAAC,EAC1B,OAAOG,EAAE,SAAW,OAAO,KAAKD,CAAC,EAAE,OAAS,GAAKC,EAAE,MAAM,CAAC,CAACE,EAAGC,CAAC,IAAMF,EAAEE,EAAGJ,EAAEG,CAAC,CAAC,CAAC,CACjF,CACA,MAAO,EACT,CACA,SAASE,GAAEP,EAAG,CACZ,MAAO,IAAIE,IAAM,CACfM,EAAGL,GAAM,EACNA,EAAE,SAAS,QAAQ,KAAK,UAAU,EAAI,QAAQH,CAAC,EAAIG,EAAE,SAAS,OAAOH,CAAC,GAAG,GAAGE,CAAC,CAChF,CAAC,CACH,CACF,CACA,IAAMO,EAAI,CACR,MAAOF,GAAE,OAAO,EAChB,KAAMA,GAAE,MAAM,EACd,KAAMA,GAAE,MAAM,EACd,MAAOA,GAAE,OAAO,CAClB,ECnCA,SAASG,KAAK,EAAG,CACf,OAAOC,GAAE,GAAG,CAAC,CACf,CACA,SAASA,MAAK,EAAG,CACf,OAAO,EAAE,OAAO,CAACC,EAAG,IAAMC,GAAED,EAAG,CAAC,CAAC,CACnC,CACA,SAASC,GAAE,EAAGD,EAAG,CACf,OAAOE,GAAE,CAAC,GAAKA,GAAEF,CAAC,EAAI,OAAO,QAAQA,CAAC,EAAE,OACtC,CAAC,EAAG,CAACG,EAAGC,CAAC,KAAO,EAAED,CAAC,EAAIF,GAAE,EAAEE,CAAC,EAAGC,CAAC,EAAG,GACnC,CAAE,GAAG,CAAE,CACT,EAAIF,GAAE,CAAC,EAAI,EAAIF,CACjB,CCZA,IAAIK,GAAI,+1DAAg2DC,GAAI,gDAAiDC,GAC75D,SAASC,IAAI,CACX,GAAID,cAAa,OACf,OAAOA,GACT,GAAI,CACFA,GAAI,IAAI,OAAOF,GAAG,GAAG,CACvB,OAAQ,GACNE,GAAID,EACN,CACA,OAAOC,EACT,CACA,SAASE,GAAE,EAAG,CACZ,MAAO,CAAC,CAAC,GAAKD,GAAE,EAAE,KAAK,CAAC,CAC1B,CACA,SAASE,IAAI,CACX,OAAOD,GAAE,UAAU,SAAS,CAC9B,CACA,SAASE,MAAK,EAAG,CACf,GAAI,CAAC,EAAE,MAAOC,GAAMA,GAAK,IAAI,EAC3B,OAAO,EAAE,OAAQA,GAAM,MAAM,QAAQA,CAAC,CAAC,EAAE,OAAO,CAACA,EAAGC,IAAMD,EAAE,OAAOC,CAAC,EAAG,CAAC,CAAC,CAC7E,CACA,IAAMC,GAAI,gBACV,SAASC,GAAE,EAAG,CACZ,IAAIF,EACJ,IAAM,EAAI,GAAGC,EAAC,GAAG,CAAC,IACjBD,EAAI,OAAO,cAAgB,MAAQA,EAAE,KAAK,GAAG,CAAC,QAAQ,CACzD,CACA,SAASG,GAAE,EAAG,CACZ,IAAIH,EAAGI,EACP,IAAML,EAAI,GAAGE,EAAC,GAAG,CAAC,IACjBD,EAAI,OAAO,cAAgB,MAAQA,EAAE,KAAK,GAAGD,CAAC,MAAM,GAAIK,EAAI,OAAO,cAAgB,MAAQA,EAAE,QAAQL,EAAG,GAAGA,CAAC,SAAU,GAAGA,CAAC,MAAM,CACnI,CACA,SAASM,EAAE,EAAG,CACZ,OAAOH,GAAE,CAAC,EAAG,IAAMC,GAAE,CAAC,CACxB,CACA,SAASG,GAAE,EAAG,CACZ,OAAO,MAAM,KAAK,IAAI,IAAI,CAAC,CAAC,CAC9B,CCrCA,SAASC,EAAEC,EAAG,CACZ,GAAI,OAAOA,GAAK,SACd,OAAOA,EACT,GAAI,OAAOA,GAAK,SACd,OACF,IAAM,EAAI,OAAOA,CAAC,EAClB,OAAO,MAAM,CAAC,EAAI,OAAS,CAC7B,CCPA,SAASC,GAAEC,KAAMC,EAAG,CAClB,OAAOA,EAAE,OACP,CAACC,EAAGC,KAAOD,EAAEC,CAAC,EAAIH,EAAEG,CAAC,EAAGD,GACxB,CAAC,CACH,CACF,CCAA,SAASE,GAAEC,EAAG,CACZA,EAAE,aAAa,eAAgB,KAAK,CACtC,CACA,SAASC,GAAED,EAAG,CAAE,QAASE,EAAG,QAASC,EAAG,QAAS,EAAG,UAAWC,EAAG,SAAUC,CAAE,EAAG,CAAE,KAAMC,GAAIC,MAAAP,EAAE,OAAF,KAAAO,EAAU,UAAQ,aAAcC,CAAE,EAAI,CAAC,EAAG,CACrI,IAAMC,EAAI,CAAC,EACX,SAASC,EAAEC,EAAGC,EAAGC,EAAG,CAClBF,EAAE,iBAAiBC,EAAGC,CAAC,EAAGJ,EAAE,KAAK,IAAME,EAAE,oBAAoBC,EAAGC,CAAC,CAAC,CACpE,CACA,OAAQT,GAAKC,IAAMK,EAAEV,EAAG,UAAYW,GAAM,CACxCP,GAAK,MAAQA,EAAEJ,EAAE,MAAOW,EAAE,GAAG,EAAGP,IAAMO,EAAE,MAAQ,aAAeA,EAAE,MAAQ,WAAaA,EAAE,eAAe,EAAIN,GAAKM,EAAE,MAAQ,UAAYX,EAAE,QAAU,IAAM,CAACW,EAAE,QAAUN,EAAEL,EAAE,KAAK,EAAGQ,GAAKG,EAAE,eAAe,EACzM,CAAC,EAAGN,GAAKC,IAAMI,EAAEJ,EAAG,SAAWK,GAAM,CACnCH,GAAKG,EAAE,eAAe,EAAGN,EAAEL,EAAE,KAAK,CACpC,CAAC,EAAGM,EAAE,iBAAiB,eAAe,EAAE,QAASK,GAAM,CACrDD,EAAEC,EAAG,QAAUC,GAAM,CACnBJ,GAAKI,EAAE,eAAe,EAAGP,EAAEL,EAAE,KAAK,CACpC,CAAC,CACH,CAAC,GAAIE,GAAKQ,EAAEV,EAAG,QAAS,IAAME,EAAEF,EAAE,KAAK,CAAC,EAAGG,GAAKO,EAAEV,EAAG,QAAS,IAAMG,EAAEH,EAAE,KAAK,CAAC,EAAG,GAAKU,EAAEV,EAAG,QAAS,IAAM,EAAEA,EAAE,KAAK,CAAC,EAAG,CACrH,SAAU,CACRS,EAAE,QAASE,GAAMA,EAAE,CAAC,CACtB,CACF,CACF,CC1Be,SAARG,MAAqBC,EAAsC,CAC9D,OAAQC,GAAmBD,EAAI,OAAO,CAACE,EAAMC,IAAOA,EAAGD,CAAI,EAAGD,CAAK,CACvE,CCFA,IAAMG,GAAYC,GAA4B,OAAOA,CAAC,IAAM,kBAE7C,SAARC,GAA4DC,EAA4B,CAC3F,GAAI,CAACH,GAASG,CAAK,EACf,MAAO,GAEX,IAAMC,EAAcD,EAAM,YAC1B,GAAIC,IAAgB,OAChB,MAAO,GAEX,IAAMC,EAAYD,EAAY,UAK9B,MAJI,GAACJ,GAASK,CAAS,GAInB,CAACA,EAAU,eAAe,eAAe,EAIjD,CCjBe,SAARC,GAAgCC,EAA2B,CAC9D,OAAO,MAAM,QAAQA,CAAK,EAAIA,EAAQ,CAACA,CAAK,CAChD,CCDA,IAAMC,GAAgC,CAClC,qBAAsB,GAC1B,EAEO,SAASC,GAAoBC,EAAoB,CACpD,OAAI,OAAOA,EAAO,uBAA0B,SACjCF,GAGJ,CACH,GAAGA,GACH,GAAGE,EAAO,qBACd,CACJ,CCRO,SAASC,GAAUC,EAAcC,EAAiB,CACrD,OAAO,OAAO,QAAQA,CAAO,EACxB,KAAK,CAACC,EAAGC,IAAMA,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,OAASD,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,MAAM,EAC9D,OACG,CAAC,CAACE,EAAQC,CAAM,EAAG,CAACC,EAASC,CAAK,IAAM,CACpC,IAAMC,EAAQC,GAAeJ,EAAQC,CAAO,EAE5C,OAAIE,GAAS,KACF,CAEHE,GAAeN,EAAQG,EAAOC,CAAK,EACnCG,GAAkBN,EAAQC,CAAO,CACrC,EAEG,CAACF,EAAQC,CAAM,CAC1B,EACA,CAAC,CAAC,EAAGL,CAAI,CACb,EAAE,CAAC,CACX,CAEO,SAASY,GAAYZ,EAAcC,EAAiC,CACvE,OAAI,OAAO,KAAKA,GAAW,CAAC,CAAC,EAAE,OAAS,EAC7BF,GACHC,EACA,OAAO,QAAQC,CAAO,EAAE,OACpB,CAACY,EAAM,CAACC,EAAKN,CAAK,IACd,OAAO,OAAO,OAAO,OAAO,CAAC,EAAGK,CAAI,EAAG,CACnC,CAACL,CAAK,EAAGM,CACb,CAAC,EACL,CAAC,CACL,CACJ,EAEGd,CACX,CAEO,SAASe,GAAoBC,EAAyC,CACzE,IAAMC,EAAe,IAAI,gBACzB,cAAO,QAAQD,CAAM,EAAE,QAAQ,CAAC,CAACF,EAAKI,CAAM,IAAM,CAC9CC,GAAYD,CAAM,EACb,OAAOE,GAAKA,GAAK,IAAI,EACrB,QAAQA,GAAK,CACVH,EAAa,OAAOH,EAAK,OAAOM,CAAC,CAAC,CACtC,CAAC,CACT,CAAC,EACMH,EAAa,SAAS,CACjC,CAEO,SAASI,GAAoBC,EAAyC,CACzE,IAAML,EAAe,IAAI,gBAAgBK,CAAK,EACxCN,EAAmC,CAAC,EAC1C,OAAAC,EAAa,QAAQ,CAACT,EAAOM,IAAQ,CAC5BE,EAAOF,CAAG,IAAGE,EAAOF,CAAG,EAAI,CAAC,GACjCE,EAAOF,CAAG,EAAG,KAAKN,CAAK,CAC3B,CAAC,EACMQ,CACX,CAEO,SAASO,GAAaP,EAAiC,CAC1D,IAAMhB,EAAO,OAAO,QAAQgB,CAAM,EAC7B,IAAI,CAAC,CAACQ,EAAGJ,CAAC,KAAO,CACd,IAAKI,EACL,OAAQL,GAAYC,CAAC,CACzB,EAAE,EACD,KAAK,CAAClB,EAAGC,IACCD,EAAE,IAAMC,EAAE,IAAM,GAAKD,EAAE,IAAMC,EAAE,IAAM,EAAI,CACnD,EACL,OAAOsB,GAEHzB,EAAK,IAAIoB,IAAM,CACX,IAAKM,GAAUN,EAAE,GAAG,EACpB,OAAQA,EAAE,MACd,EAAE,CACN,CACJ,CAEO,SAASO,GAAa3B,EAA+B4B,EAAsB,CAAC,EAA4B,CAC3G,OAAO,OAAO,OAAO,CAAC,EAAG,GAAG,OAAO,QAAQ5B,CAAI,EAAE,IAAI,CAAC,CAACwB,EAAGJ,CAAC,IAAMS,GAAW,CAACL,CAAC,EAAGJ,EAAGQ,CAAS,CAAC,CAAC,CACnG,CAEO,SAASE,GAAeC,EAAgBC,EAAgB,SAAS,MAAa,CACjF,IAAMC,EAAUC,GAAWH,CAAM,EAC5BI,GAAW,OAAO,SAAS,KAAMF,CAAO,GACzC,OAAO,QAAQ,UAAU,OAAWD,EAAOC,CAAO,CAE1D,CAEO,SAASG,GAAmBC,EAAgD,CAE/E,WAAW,IAAM,CACb,OAAO,iBAAiB,WAAYA,CAAQ,CAChD,EAAG,EAAE,CACT,CAEO,SAASF,GAAWG,EAAaC,EAA2B,CAC/D,OAAOL,GAAWI,CAAG,IAAMJ,GAAWK,CAAQ,CAClD,CAEO,SAASL,GAAWI,EAAqB,CAC5C,OAAO,IAAI,IAAIA,EAAI,SAAS,GAAG,EAAIA,EAAI,MAAM,EAAG,EAAE,EAAIA,EAAK,OAAO,SAAS,IAAI,EAAE,IACrF,CAEO,SAASE,GACZC,EAIAnB,EACAoB,EACM,CArHV,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAsHI,IAAMC,EAAgBC,GAAoBR,EAAQ,MAAM,EAClDS,EAAUC,GACZ,IAAIP,GAAAD,EAAAF,EAAQ,OAAO,oBAAf,YAAAE,EAAkC,IAAIS,GAE9B9B,GAAmB8B,EAAE,OAAO9B,EAAO0B,CAAa,KAFxD,KAAAJ,EAGE,CAAC,CACX,EAEMS,EAAuBC,GAAWJ,EAAQ5B,CAAK,EAAG4B,EAAQT,EAAQ,MAAM,gBAAgB,EAAE,KAAK,CAAC,EAEhGzB,EAASW,GACX,CACI,IAAIkB,EAAAH,GAAA,YAAAA,EAAS,eAAT,KAAAG,EAAyB,CAAC,EAE9B,GAAG9C,GAAUsD,EAAsBZ,EAAQ,OAAO,cAAc,CACpE,EAEA,OAAO,OAAOA,EAAQ,OAAO,cAAc,CAC/C,EAEA,MAAO,KACHK,EAAAL,EAAQ,MAAM,gBAAgB,IAA9B,YAAAK,EAAiC,YAAa,WACvCC,EAAAN,EAAQ,OAAO,WAAf,KAAAM,EACD,SAAS,QACnB,IAAIhC,GAAoBC,CAAM,CAAC,EACnC,CAEA,IAAMuC,GAAgB,IAChBC,GAAwB,KAW9B,SAASC,GAAUvD,EAAoB,CACnC,MAAO,oBAAoB,KAAKA,CAAC,CACrC,CAEA,SAASuB,GAAezB,EAAwD,CAC5E,GAAI,CAACA,EAAK,OACN,MAAO,CAAC,EAEZ,IAAM0D,EAAQ1D,EAAK,CAAC,EACpB,OAAI0D,EAAO,IAAI,SAAW,EAClBA,EAAO,OAAO,SAAW,EAClBA,EAAO,OAAO,CAAC,EAEnBA,EAAO,OAEdD,GAAUC,EAAO,IAAI,CAAC,CAAE,EACjB,OAAO,OAAOC,GAAe3D,CAAI,CAAC,EAEtC2D,GAAe3D,CAAI,CAC9B,CAEA,SAAS2D,GAAe3D,EAA+C,CACnE,IAAM4D,EAAU5D,EAAK,OAA6B,CAAC,EAAG6D,IAAM,CACxD,IAAMrC,EAAIqC,EAAE,IAAI,CAAC,EACjB,MAAO,CACH,GAAG,EACH,CAACrC,CAAE,EAAG,CAAC,GAAI,EAAEA,CAAE,GAAK,CAAC,EAAIqC,CAAC,CAC9B,CACJ,EAAG,CAAC,CAAC,EACL,OAAO,OAAO,OACV,CAAC,EACD,GAAG,OAAO,KAAKD,CAAO,EAAE,IAAI9C,IAAQ,CAChC,CAACA,CAAG,EAAGW,GAAeqC,GAAYF,EAAQ9C,CAAG,CAAE,CAAC,CACpD,EAAE,CACN,CACJ,CAEA,SAASgD,GAAY9D,EAAsC,CACvD,OAAOA,EAAK,IAAIoB,IAAM,CAClB,IAAKA,EAAE,IAAI,MAAM,CAAC,EAClB,OAAQA,EAAE,MACd,EAAE,CACN,CAEA,SAASS,GAAWkC,EAAgBvD,EAAgBoB,EAA8C,CAC9F,OAAIoC,GAAcxD,CAAK,EACZ,OAAO,OAAO,CAAC,EAAG,GAAG,OAAO,QAAQA,CAAK,EAAE,IAAI,CAAC,CAACgB,EAAGJ,CAAC,IAAMS,GAAW,CAAC,GAAGkC,EAAMvC,CAAC,EAAGJ,EAAGQ,CAAS,CAAC,CAAC,EAEzGpB,aAAiB,QAAUoB,EAAU,SAASmC,EAAK,CAAC,CAAE,GAAKvD,EAAM,KAAKY,GAAKA,aAAa,MAAM,GACvF,OAAO,OAAO,CAAC,EAAG,GAAGZ,EAAM,IAAI,CAACY,EAAG6C,IAAMpC,GAAW,CAAC,GAAGkC,EAAME,EAAE,SAAS,CAAC,EAAG7C,EAAGQ,CAAS,CAAC,CAAC,EAE/F,CACH,CAACsC,GAAUH,CAAI,CAAC,EAAGvD,CACvB,CACJ,CAEA,SAAS0D,GAAUH,EAAwB,CACvC,OAAOA,EAAK,IAAIvC,GAAKA,EAAE,MAAM+B,EAAa,EAAE,KAAKC,EAAqB,CAAC,EAAE,KAAKD,EAAa,CAC/F,CAEA,SAAS7B,GAAUZ,EAAuB,CACtC,OAAOA,EAAI,MAAMyC,EAAa,EAAE,IAAI/B,GAAKA,EAAE,MAAMgC,EAAqB,EAAE,KAAKD,EAAa,CAAC,CAC/F,CAEO,SAAS5C,GAAkBwD,EAAarD,EAAa,CACxDqD,EAAMC,GAAYD,CAAG,EAErB,IAAIF,EAAGI,EAAOC,EAAKC,EAASC,EAC5BD,EAAUJ,EACV,IAAMM,EAAU3D,EAAI,MAAM,GAAG,EAC7B,IAAKuD,EAAQJ,EAAI,EAAGK,EAAMG,EAAQ,OAAQR,EAAIK,IAC1CE,EAASC,EAAQJ,CAAK,EACtBG,EAAS,mBAAmBA,CAAM,EAC9BR,GAAcO,CAAO,GAAKC,KAAUD,GAHOF,EAAQ,EAAEJ,EAIjDI,EAAQ,IAAMI,EAAQ,OACtB,OAAOF,EAAQC,CAAM,EAErBD,EAAUA,EAAQC,CAAM,EAMpC,OAAOL,CACX,CAEO,SAAS1D,GAAe0D,EAAarD,EAAa4D,EAAwB,CAE7E,IAAIT,EAAGI,EAAOC,EAAKC,EAASC,EAAgBhE,EAC5C+D,EAAUJ,EACV,IAAMM,EAAU3D,EAAI,MAAM,GAAG,EAE7B,IADAN,EAAQ,OACH6D,EAAQJ,EAAI,EAAGK,EAAMG,EAAQ,OAAQR,EAAIK,EAAKD,EAAQ,EAAEJ,EAGzD,GAFAO,EAASC,EAAQJ,CAAK,EACtBG,EAAS,mBAAmBA,CAAM,EAC9BR,GAAcO,CAAO,GAAKC,KAAUD,EACpCA,EAAUA,EAAQC,CAAM,EACxBhE,EAAQ+D,MACL,CACH/D,EAAQkE,EACR,KACJ,CAEJ,OAAOlE,CACX,CAIA,SAAS4D,GAAYD,EAAuB,CACxC,OAAIA,aAAe,MACRA,EAAI,IAAI/C,GAAKgD,GAAYhD,CAAC,CAAC,EAElC4C,GAAcG,CAAG,EACV,OAAO,QAAQA,CAAG,EAAE,OACvB,CAACtD,EAAM,CAACC,EAAKN,CAAK,IACd,OAAO,OAAO,OAAO,OAAO,CAAC,EAAGK,CAAI,EAAG,CACnC,CAACuD,GAAYtD,CAAG,CAAC,EAAGsD,GAAY5D,CAAK,CACzC,CAAC,EACL,CAAC,CACL,EAEG2D,CACX,CAEO,SAASzD,GAAeyD,EAA8BrD,EAAaN,EAAgB,CACtF2D,EAAMC,GAAYD,CAAG,EAErB,IAAIF,EAAGI,EAAOC,EAAKC,EAAkCC,EACrDD,EAAUJ,EACV,IAAMM,EAAU3D,EAAI,MAAM,GAAG,EAC7B,IAAKuD,EAAQJ,EAAI,EAAGK,EAAMG,EAAQ,OAAQR,EAAIK,EAAKD,EAAQ,EAAEJ,EACzDO,EAASC,EAAQJ,CAAK,EACtBG,EAAS,mBAAmBA,CAAM,EAC9BH,EAAQ,IAAMI,EAAQ,QAChBD,KAAUD,IACZA,EAAQC,CAAM,EAAI,CAAC,GAElBR,GAAcO,EAAQC,CAAM,CAAC,IAC9BD,EAAQC,CAAM,EAAI,CAAC,GAGvBD,EAAUA,EAAQC,CAAM,GAExBD,EAAQC,CAAM,EAAIhE,EAG1B,OAAO2D,CACX,CAEO,SAASQ,GAAYzE,EAAYC,EAAY,CAChD,OAAO,KAAK,UAAUD,CAAC,IAAM,KAAK,UAAUC,CAAC,CACjD,CAIO,SAASmD,GAAW9C,EAAgCoE,EAAsB,CAC7E,GAAIZ,GAAcxD,CAAK,GAAKwD,GAAcY,CAAW,EAAG,CACpD,IAAMC,EAAkC,CAAC,EACzC,cAAO,KAAKrE,CAAK,EAAE,QAAQM,GAAO,CACzB6D,GAAYnE,EAAMM,CAAG,EAAG8D,EAAY9D,CAAG,CAAC,IACzC+D,EAAO/D,CAAG,EAAIwC,GAAW9C,EAAMM,CAAG,EAAG8D,EAAY9D,CAAG,CAAC,EAE7D,CAAC,EACM+D,CACX,CACA,OAAOrE,CACX,CC/TA,SAASsE,GAAWC,EAAWC,EAAgBC,EAAkB,CAC7D,IAAMC,EAAc,KAAK,UAAUF,CAAK,EACxC,GAAI,CACAC,EAAQ,QAAQF,EAAMG,CAAW,CACrC,OAASC,EAAO,CACZC,EAAO,KAAKD,CAAK,CACrB,CACJ,CAEA,SAASE,GAAcN,EAAWE,EAAkB,CAChD,IAAIK,EACJ,GAAI,CACAA,EAAaL,EAAQ,QAAQF,CAAI,CACrC,OAASI,EAAO,CACZC,EAAO,KAAKD,CAAK,EACjB,MACJ,CACA,GAAKG,EAGL,GAAI,CAEA,OAAO,KAAK,MAAMA,CAAU,CAChC,OAASH,EAAO,CACZC,EAAO,KAAK,sBAAsBD,CAAK,KAAKG,CAAU,GAAG,EACzD,MACJ,CACJ,CAUO,SAASC,GAAoBC,EAAWC,EAAgB,CAC3DC,GAAWF,EAAMC,EAAO,YAAY,CACxC,CAEO,SAASE,GAAsBH,EAAWC,EAAgB,CAC7DC,GAAWF,EAAMC,EAAO,cAAc,CAC1C,CAEO,SAASG,GAAuBJ,EAAW,CAC9C,OAAOK,GAAcL,EAAM,YAAY,CAC3C,CAEO,SAASM,GAAyBN,EAAW,CAChD,OAAOK,GAAcL,EAAM,cAAc,CAC7C,CCrDO,IAAMO,GAAgB,IAEvBC,GAAM,+BAEL,SAASC,IAAkB,CAC9B,IAAMC,EAAiBC,GAAgB,EACjCC,EAAmBC,GAAoB,EAC7C,MAAI,CAACH,GAAkBE,EAAmBF,GACtCI,GAAsBN,GAAKI,EAAmBL,EAAa,EACpD,IAEJ,EACX,CAEA,SAASI,IAAkB,CACvB,IAAMD,EAAiBK,GAA8BP,EAAG,EACxD,OAAOE,EAAiB,CAACA,EAAiB,MAC9C,CAEO,SAASG,IAAsB,CAClC,OAAO,KAAK,MAAM,IAAI,KAAK,EAAE,QAAQ,EAAI,GAAI,CACjD,CAEO,SAASG,IAAiB,CAC7B,IAAMN,EAAiBC,GAAgB,EACvC,OAAOD,GAAkBG,GAAoB,EAAIH,CACrD,CC5BA,eAAsBO,IAA0B,CAC5C,OAAO,IAAI,QAAQC,GAAW,CACtB,SAAS,aAAe,UACxBA,EAAQ,EAER,OAAO,iBAAiB,mBAAoB,IAAM,CAC9CA,EAAQ,CACZ,CAAC,CAET,CAAC,CACL,CAIO,SAASC,GAA2BC,EAAqBC,EAAiC,CAE7F,OADiB,OAAOD,GAAa,SAAW,MAAM,KAAK,SAAS,iBAAiBA,CAAQ,CAAC,EAAI,CAACA,CAAQ,GAC3F,OAAQE,GAAeD,EAAaC,aAAaD,EAAa,EAAK,CACvF,CAEO,SAASE,GAAQC,EAAmBJ,EAA8B,CACrE,IAAIK,EAAwB,CAAC,EAC7B,OAAAN,GAAQK,CAAM,EAAE,QAAQE,GAAW,CAC/B,IAAMC,EAASD,EAAQ,WACnBC,IAAW,UAAYA,aAAkB,UACzCF,EAAW,KAAKE,CAAM,EACtBF,EAAaA,EAAW,OAAOF,GAAQI,CAAM,CAAC,EAEtD,CAAC,EACMF,EAAW,OAAOC,GAAWN,IAAa,QAAaQ,GAAQF,EAASN,CAAQ,CAAC,CAC5F,CAEO,SAASQ,GAAQJ,EAAmBJ,EAA2B,CAClE,IAAMS,EACF,QAAQ,UAAU,SAElB,QAAQ,UAAU,mBAClB,QAAQ,UAAU,sBACtB,OAAOV,GAAQK,CAAM,EAAE,KAAKE,GAAWG,EAAY,KAAKH,EAASN,CAAQ,CAAC,CAC9E,CAEO,SAASU,GAAiB,CAACJ,EAASK,CAAK,EAAkBC,EAAsB,CACpF,IAAMC,EAAWC,GAAsB,CACnC,IAAMV,EAASU,EAAM,OAEjBV,aAAkB,aAAeE,GAC7BF,IAAWE,GAAWF,IAAWO,GAAS,CAACR,GAAQC,CAAM,EAAE,SAASE,CAAO,GAC3EM,EAAS,CAGrB,EAEA,gBAAS,iBAAiB,QAASC,CAAO,EAEnC,CACH,QAAS,IAAM,CACX,SAAS,oBAAoB,QAASA,CAAO,CACjD,CACJ,CACJ,CAEO,SAASE,GAAoBC,EAAiC,CACjE,GAAI,CAACA,EACD,OAEJ,IAAMZ,EAAS,SAAS,cAAcY,CAAW,EAC5CZ,GAGLA,EAAO,UAAU,OAAO,mBAAmB,CAC/C,CAEO,SAASa,GAA0BC,EAASC,EAAkB,CAEjE,OAAOD,EAAK,UAAUC,CAAI,CAC9B,CAEA,IAAMC,GAAsB,mCAErB,SAASC,IAAiB,CAC7B,OAAO,eAAe,QAAQD,GAAqB,OAAO,QAAQ,SAAS,CAAC,CAChF,CAEO,SAASE,IAAqB,CACjC,IAAMC,EAAsB,OAAO,eAAe,QAAQH,EAAmB,EAC7E,GAAI,CAACG,EACD,OAGJ,IAAMC,EAAW,KAAK,MAAM,WAAWD,CAAmB,CAAC,EACrDE,EAAW,OAAO,YAAY,IAAM,CAChB,SAAS,gBAAgB,aAAe,OAAO,aAChDD,IACjB,OAAO,SAAS,EAAGA,CAAQ,EAC3B,OAAO,eAAe,WAAWJ,EAAmB,EACpD,OAAO,cAAcK,CAAQ,EAErC,EAAG,EAAE,EAKL,OAAO,WAAW,IAAM,CACpB,OAAO,cAAcA,CAAQ,EAC7B,QAAQ,KAAK,4EAA4E,CAC7F,EAAG,GAAI,CACX,CCvGO,IAAMC,GAAuB,qBACvBC,GAA6B,4BAE7BC,GAAsB,oBACtBC,GAA4B,2BAMlC,SAASC,GAAqBC,EAAwB,CACzDA,EAAQ,UAAU,IAAIL,EAAoB,EAE1C,IAAMM,EAAyB,SAAS,cAAc,KAAK,EAG3D,IAFAA,EAAuB,MAAM,QAAU,OACvCA,EAAuB,UAAU,IAAIL,EAA0B,EACxDI,EAAQ,YAAY,CACvB,IAAME,EAAQF,EAAQ,WACtBA,EAAQ,YAAYE,CAAK,EACzBD,EAAuB,YAAYC,CAAK,CAC5C,CAGAF,EAAQ,WAAY,YAAYC,CAAsB,CAC1D,CAQA,eAAsBE,GAAkBC,EAAkBC,EAAgB,CAClEA,GACA,MAAM,IAAI,QAAQC,GAAW,WAAWA,EAASD,CAAK,CAAC,EAE3D,SAAS,iBAA8BD,CAAQ,EAAE,QAAQG,GAAM,CAtCnE,IAAAC,EAuCQ,IAAMC,EAAaC,GAAUH,EAAI,EAAI,EAErCE,EAAW,UAAU,IAAIZ,EAAmB,GAC5CW,EAAAD,EAAG,aAAH,MAAAC,EAAe,aAAaC,EAAYF,GAExCA,EAAG,GAAK,GACRA,EAAG,UAAY,GACfA,EAAG,MAAM,QAAU,OACnBA,EAAG,UAAU,IAAIT,EAAyB,CAC9C,CAAC,CACL,CAEO,SAASa,IAAuB,CACnC,IAAMC,EAAS,SAAS,cAAc,IAAIjB,EAAoB,EAAE,EAC1DkB,EAAuB,SAAS,cAAc,IAAIjB,EAA0B,EAAE,EACpF,GAAI,GAACgB,GAAU,CAACC,GAIhB,MAAOD,EAAO,YACVA,EAAO,YAAYA,EAAO,UAAU,EAExC,KAAOC,EAAqB,YAAY,CACpC,IAAMX,EAAQW,EAAqB,WACnCA,EAAqB,YAAYX,CAAK,EACtCU,EAAO,YAAYV,CAAK,CAC5B,CACAW,EAAqB,OAAO,EAChC,CAEO,SAASC,IAAoB,CAChC,IAAMC,EAAe,SAAS,iBAA8B,IAAIlB,EAAmB,EAAE,EAC/EmB,EAAc,SAAS,iBAA8B,IAAIlB,EAAyB,EAAE,EAC1FiB,EAAa,QAAQ,CAACE,EAAMC,IAAU,CAClC,IAAMC,EAAaH,EAAYE,CAAK,EAC/BC,IAILA,EAAW,MAAM,QAAUF,EAAK,MAAM,QACtCE,EAAW,GAAKF,EAAK,GACrBA,EAAK,UAAU,OAAOpB,EAAmB,EACzCsB,EAAW,UAAYF,EAAK,UAC5BA,EAAK,OAAO,EAChB,CAAC,CACL,CCpFA,IAAAG,GAAmC,kBAGnC,IAAAC,GAAgC,wBAChC,SAASC,GAAEC,EAAGC,EAAI,CAAC,EAAG,CACpB,IAAMC,EAAoB,IAAI,IAC1B,EAAIC,GAAEH,EAAGC,GAAA,KAAAA,EAAK,CAAC,CAAC,EACdE,EAAIA,GAAEH,EAAGC,CAAC,EAChB,SAASG,EAAEC,EAAG,CACZ,EAAIA,EAAE,CAAC,EACP,QAAWC,KAAKJ,EAAE,OAAO,EACvBI,EAAE,CAAC,CACP,CACA,SAASC,EAAEF,EAAG,CACZD,EAAGE,IAAO,CAAE,GAAGA,EAAG,GAAGD,CAAE,EAAE,CAC3B,CACA,SAASG,GAAI,CACX,OAAO,CACT,CACA,SAASC,GAAI,CACX,OAAO,gBAAgBN,CAAC,CAC1B,CACA,SAASO,EAAEL,EAAGC,EAAG,CACf,IAAIK,EACJT,EAAE,IAAII,EAAI,GAAM,CACd,IAAMM,EAAIP,EAAE,CAAC,EACbF,EAAES,EAAGD,CAAC,IAAMA,EAAIC,EAAGN,EAAEM,CAAC,EACxB,CAAC,CACH,CACA,SAAS,EAAEP,EAAG,CACZH,EAAE,OAAOG,CAAC,CACZ,CACA,MAAO,CACL,YAAaE,EACb,SAAUC,EACV,gBAAiBC,EACjB,SAAUC,EACV,cAAe,CACjB,CACF,CACA,IAAMG,GAAI,CACR,QAAS,GACT,MAAO,CAAC,EACR,SAAU,CAAC,EACX,YAAa,EACf,EACA,SAASC,GAAEd,EAAI,CAAC,EAAG,CACjB,OAAOD,GAAEc,GAAGb,CAAC,CACf,CACA,IAAMe,KAAI,GAAAC,eAAEF,GAAE,CAAC,EAAGG,MAAI,GAAAD,eAAE,IAAI,EAAGE,GAAI,IAAM,CACvC,IAAMlB,KAAI,GAAAmB,YAAEF,EAAC,EACb,GAAI,CAACjB,EACH,MAAM,IAAI,MAAM,gDAAgD,EAClE,OAAOA,CACT,ECrDA,IAAAoB,EAA+F,wBCC/F,eAAeC,GAAEC,EAAG,CAAE,cAAeC,EAAG,GAAGC,CAAE,EAAGC,EAAG,CACjD,IAAIC,EAAGC,EACP,IAAMC,EAAI,MAAMH,EAAEH,EAAGE,CAAC,EACtB,GAAI,GAAGG,GAAKD,EAAIE,EAAE,WAAa,KAAO,OAASF,EAAE,OAAS,MAAQC,EAAE,SAAW,EAAEJ,GAAK,MAAQA,EAAE,QAC9F,OAAOK,EACT,IAAMC,EAAKC,GAAMP,EAAE,OAAO,CAACQ,EAAGC,IAAMA,EAAED,CAAC,EAAGD,CAAC,EAC3C,MAAO,CACL,GAAGF,EACH,SAAU,CACR,GAAGA,EAAE,SACL,KAAMA,EAAE,SAAS,KAAK,IAAIC,CAAC,CAC7B,CACF,CACF,CACA,SAASI,GAAEX,EAAGC,EAAGC,EAAG,CAClB,IAAMC,EAAI,KAAK,UAAUF,CAAC,EAC1B,GAAI,CACFC,EAAE,QAAQF,EAAGG,CAAC,CAChB,OAASG,EAAG,CACVE,EAAE,KAAKF,CAAC,CACV,CACF,CACA,SAASM,GAAEZ,EAAGC,EAAG,CACf,GAAI,CACF,IAAMC,EAAID,EAAE,QAAQD,CAAC,EACrB,GAAIE,EACF,OAAO,KAAK,MAAMA,CAAC,CACvB,OAASA,EAAG,CACVM,EAAE,KAAKN,CAAC,CACV,CACF,CACA,SAASW,GAAEb,EAAGC,EAAG,CACfU,GAAEX,EAAGC,EAAG,cAAc,CACxB,CACA,SAASa,GAAEd,EAAG,CACZ,OAAOY,GAAEZ,EAAG,cAAc,CAC5B,CACA,IAAMe,GAAI,wBAAyBC,GAAI,GAAK,IAC5C,SAASC,GAAEjB,EAAGC,EAAG,CACfY,GAAEE,GAAG,CAAE,MAAOf,EAAG,OAAQC,EAAG,QAAS,KAAK,IAAI,CAAE,CAAC,CACnD,CACA,SAASiB,GAAElB,EAAG,CACZ,IAAMC,EAAIa,GAAEC,EAAC,EACb,GAAI,CAACd,GAAK,CAACkB,GAAElB,CAAC,EACZ,OAAO,KACT,IAAMC,EAAIkB,GAAEnB,EAAE,KAAK,EACnB,MAAO,CAACS,EAAEU,GAAEpB,CAAC,EAAGE,CAAC,GAAK,KAAK,IAAI,EAAID,EAAE,QAAUe,GAAI,KAAOf,EAAE,MAC9D,CACA,SAASmB,GAAEpB,EAAG,CACZ,IAAMC,EAAI,CACR,GAAGD,EACH,KAAM,OACN,SAAU,CACR,GAAGA,EAAE,SACL,KAAM,MACR,CACF,EACA,OAAO,KAAK,MAAM,KAAK,UAAUC,CAAC,CAAC,CACrC,CACA,SAASkB,GAAEnB,EAAG,CACZ,OAAO,OAAOA,GAAK,UAAYA,IAAM,MAAQ,UAAWA,GAAK,WAAYA,GAAK,YAAaA,CAC7F,CACA,eAAeqB,GAAErB,EAAG,CAAE,mBAAoBC,EAAG,GAAGC,CAAE,EAAGC,EAAG,CACtD,GAAI,CAACF,EACH,OAAOE,EAAEH,EAAGE,CAAC,EACf,IAAMI,EAAI,MAAMgB,GAAEtB,EAAGE,EAAGC,CAAC,EACzB,OAAOc,GAAEjB,EAAGM,CAAC,EAAGA,CAClB,CACA,eAAegB,GAAEtB,EAAGC,EAAGC,EAAG,CAtE1B,IAAAqB,EAAAC,EAuEE,IAAIC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EACnB,GAAM,CAAE,KAAM3B,EAAI,EAAG,KAAMG,EAAI,CAAE,EAAIN,EAAE,UAAY,CAAC,EAAGO,EAAIW,GAAElB,CAAC,EAC9D,GAAI,CAACO,EACH,OAAO,MAAML,EAAEF,EAAGC,CAAC,EACrB,IAAMG,GAAMmB,GAAAE,EAAIlB,GAAK,KAAO,OAASA,EAAE,WAAa,KAAO,OAASkB,EAAE,OAA1D,KAAAF,EAAmE,EAAGlB,GAAMmB,GAAAE,EAAInB,GAAK,KAAO,OAASA,EAAE,WAAa,KAAO,OAASmB,EAAE,OAA1D,KAAAF,EAAmE,CAAC,EAC5J,GAAIlB,IAAMF,EACR,OAAOG,EACT,GAAID,EAAIF,EACN,MAAO,CACL,GAAGG,EACH,SAAU,CACR,GAAGA,EAAE,SACL,KAAMD,EACN,KAAMD,EAAE,MAAM,EAAGC,CAAC,EAClB,QAASqB,EAAIpB,EAAE,WAAa,KAAO,OAASoB,EAAE,QAAU,CAC1D,CACF,EACF,IAAMnB,EAAIF,EAAID,EAAE,OAAQI,EAAIN,EAAI,EAAIA,EAAI,EAAIG,EAAIE,EAAG,EAAI,CACrD,GAAGR,EACH,SAAU,CACR,GAAGA,EAAE,SACL,KAAMS,EACN,KAAMD,CACR,CACF,EAAGuB,EAAI,MAAM7B,EAAE,EAAGD,CAAC,EACnB,MAAO,CACL,GAAGM,EACH,SAAU,CACR,GAAGA,EAAE,SACL,KAAMD,EACN,KAAM,CAAC,KAAKsB,EAAIrB,EAAE,WAAa,KAAO,OAASqB,EAAE,OAAS,CAAC,EAAG,KAAKC,EAAIE,EAAE,WAAa,KAAO,OAASF,EAAE,OAAS,CAAC,CAAC,EACnH,QAASC,EAAIC,EAAE,WAAa,KAAO,OAASD,EAAE,QAAU,CAC1D,CACF,CACF,CACA,IAAME,GAAI,IAAKC,GAAoB,IAAI,IACvC,SAASC,GAAElC,EAAGC,EAAG,CACf,IAAMC,EAAI+B,GAAE,IAAIjC,CAAC,EACjB,GAAI,CAACE,EAAG,OACR,IAAMC,EAAI,KAAK,IAAI,EAAID,EAAE,QAAU8B,GAAG1B,EAAII,EAAET,EAAGC,EAAE,KAAK,EACtD,GAAIC,GAAK,CAACG,EAAG,CACX2B,GAAE,OAAOjC,CAAC,EACV,MACF,CACA,OAAOE,EAAE,MACX,CACA,SAASiC,GAAEnC,EAAGC,EAAGC,EAAG,CAClB+B,GAAE,IAAIjC,EAAG,CACP,MAAOC,EACP,OAAQC,EACR,QAAS,KAAK,IAAI,CACpB,CAAC,CACH,CACA,eAAekC,GAAEpC,EAAGC,EAAGC,EAAG,CACxB,GAAI,CAACD,EAAE,eACL,OAAOC,EAAEF,EAAGC,CAAC,EACf,IAAME,EAAI,KAAK,UAAUH,CAAC,EAAGM,EAAI4B,GAAE/B,EAAGH,CAAC,EACvC,GAAIM,EAAG,OAAOA,EACd,IAAMC,EAAI,MAAML,EAAEF,EAAGC,CAAC,EACtB,OAAOkC,GAAEhC,EAAGH,EAAGO,CAAC,EAAGA,CACrB,CACA,SAAS8B,GAAErC,EAAG,CACZ,OAAO,IAAI,QAASC,GAAM,WAAWA,EAAGD,CAAC,CAAC,CAC5C,CACA,eAAesC,GAAEtC,EAAG,CAAE,WAAYC,EAAI,EAAG,cAAeC,EAAI,EAAG,GAAGC,CAAE,EAAGG,EAAG,CACxE,IAAIC,EAAI,EACR,OACE,GAAI,CACF,OAAO,MAAMD,EAAEN,EAAGG,CAAC,CACrB,OAASC,EAAG,CACV,GAAIG,GAAKN,EACP,MAAMG,EACR,GAAI,CAACmC,GAAEnC,CAAC,EACN,MAAMI,EAAE,KAAK,2BAA4BJ,CAAC,EAAGA,EAC/CG,IAAK,MAAM8B,GAAEnC,CAAC,CAChB,CACJ,CACA,SAASqC,GAAEvC,EAAG,CACZ,MAAO,CAACA,GAAK,OAAOA,GAAK,SAAW,GAAK,EAAE,WAAYA,IAAMwC,GAAExC,EAAE,MAAM,CACzE,CACA,SAASwC,GAAExC,EAAG,CACZ,OAAO,OAAOA,GAAK,WAAaA,EAAI,KAAOA,GAAK,IAClD,CACA,eAAeyC,GAAEzC,EAAGC,EAAI,CAAC,EAAG,CAC1B,IAAMC,EAAI,MAAM,IAAI,QAAQO,CAAC,EAC7B,OAAOiC,GAAExC,EAAE,OAAQoC,GAAGF,GAAGf,GAAGtB,EAAC,EAAEC,EAAGC,CAAC,CACrC,CACA,SAASyC,GAAE1C,KAAMC,EAAG,CAClB,OAAOA,EAAE,OAAO,CAACC,EAAGC,IAAM,CAACG,EAAGC,IAAMJ,EAAEG,EAAGC,EAAGL,CAAC,EAAGF,CAAC,CACnD,CD1JA,SAAS2C,GAAE,EAAG,EAAG,CANjB,IAAAC,EAAAC,EAOE,MAAO,CACL,GAAG,EACH,SAAU,CACR,OAAQ,IAAM,eAAiB,OAAS,CAAC,GAAG,EAC5C,OAAQC,GACR,GAAG,EAAE,QACP,EACA,GAAG,EAAE,SAAW,CACd,SAAU,CACR,GAAG,EAAE,SACL,OAAQC,GAAE,CAAC,GAAGC,GAAG,IAAGJ,EAAA,EAAE,SAAS,SAAX,KAAAA,EAAqB,CAAC,CAAC,CAAC,EAC5C,WAAWC,EAAA,EAAE,SAAS,YAAX,KAAAA,EAAwB,CACjC,OAAQ,WACR,QAAS,WACX,CACF,CACF,EAAI,CAAC,CACP,CACF,CACA,IAAMC,GAAI,CACR,YACA,MACA,OACA,WACA,YACA,WACA,cACA,QACA,YACA,eACA,QACA,YACA,cACA,aACA,mBACA,qBACA,oBACA,gBACA,YACA,yBACA,kBACA,qBACA,iBACA,OACA,WACA,SACA,YACA,qBACA,cACA,cACA,iBACA,UACA,YACA,aACA,iBACA,iBACA,WACA,gBACA,sBACA,wBACA,0BACA,oBACA,MACA,aACA,YACA,cACA,WACA,YACA,QACA,QACA,OACF,EAAGE,GAAI,CAAC,UAAW,WAAW,EAC9B,eAAeC,GAAE,EAAG,EAAG,EAAG,CACxB,IAAIC,EAAG,EAAGC,EAAGC,EAAGC,EAAGC,EAAGP,EACtB,IAAMQ,EAAIH,EAAE,WAAW,EAAGI,EAAI,EAAE,OAAO,SAAUC,EAAID,IAAM,SAAW,OAASA,EAAGE,EAAIH,EAAE,EAAE,MAAM,gBAAgB,EAAE,MAAO,CAAC,EAAGI,EAAIJ,EAAE,EAAE,OAAO,OAAQ,EAAG,CACrJ,MAAOE,EACP,SAAUD,IAAM,eAChB,UAAW,CAAC,EAAE,GAAK,MAAQ,EAAE,WAC7B,mBAAoB,EAAE,OAAO,WAAa,gBAAkB,EAAE,OAAO,sBACrE,eAAgB,EAAE,OAAO,WAAa,gBAAkB,EAAE,OAAO,WACnE,CAAC,GACA,GAAKN,EAAI,EAAE,QAAQ,iBAAmB,MAAQ,EAAE,KAAKA,EAAG,EAAGS,CAAC,EAAG,EAAE,MAAM,YAAY,CAClF,MAAOD,EACP,QAAS,GACT,YAAa,EACf,CAAC,EACD,IAAME,EAAI,EAAE,OAAO,mBACjB,CACE,GAAGF,EACH,SAAU,CACR,GAAGA,EAAE,SAEL,OAAQP,IAAGC,GAAKD,EAAI,EAAE,MAAM,gBAAgB,EAAE,QAAU,KAAO,OAASA,EAAE,WAAa,KAAO,OAASC,EAAE,QAASC,EAAI,EAAE,WAAa,KAAO,OAASA,EAAE,MAAM,CAC/J,CACF,EACAG,CACF,EACA,GAAI,CACF,IAAMK,EAAI,MAAMC,GAAEnB,GAAE,EAAE,OAAO,SAAUiB,CAAC,EAAGD,CAAC,EAC5C,EAAE,MAAM,YAAY,CAClB,SAAUE,EACV,QAAS,EACX,CAAC,CACH,OAASA,EAAG,CACVH,EAAE,MAAM,uBAAwBG,CAAC,GAAId,GAAKO,EAAI,EAAE,QAAQ,gBAAkB,MAAQP,EAAE,KAAKO,EAAGO,EAAGD,EAAGD,EAAGH,CAAC,CACxG,CACAD,EAAE,CACJ,CACA,eAAeQ,GAAE,EAAG,EAAG,EAAG,CACxB,IAAM,EAAIX,EAAE,cAAc,EAAGI,EAAID,EAAE,EAAE,MAAM,SAAS,EAAE,MAAO,CAAE,SAAU,CAAE,KAAM,CAAE,CAAE,EAAG,CAAC,EACzF,MAAMN,GAAE,EAAGO,EAAG,CAAC,EAAG,EAAE,CACtB,CACA,SAAS,EAAE,EAAIQ,GAAG,CAChB,IAAM,KAAI,EAAAF,YAAEC,CAAC,EAAG,CAAC,EAAG,CAAC,KAAI,EAAAE,UAAE,EAAE,EAAE,SAAS,CAAC,CAAC,EAC1C,OAAO,EAAE,SAAS,EAAG,CAAC,KAAG,EAAAC,WAAE,IAAM,IAAM,EAAE,cAAc,CAAC,EAAG,CAAC,CAAC,CAAC,EAAG,CACnE,CACA,IAAMF,GAAK,GAAM,EACjB,eAAeG,GAAE,EAAG,EAAG,EAAG,CA5H1B,IAAAvB,EA6HE,IAAIc,EACJ,IAAMH,EAAIH,EAAE,eAAe,EAAGI,GAAKE,EAAI,EAAE,MAAM,SAAS,EAAE,MAAM,WAAa,KAAO,OAASA,EAAE,OAAQD,EAAI,IAAM,OAAS,CAAC,CAAE,MAAO,EAAG,CAAC,OAAO,GAAK,SAAW,QAAU,OAAO,EAAG,CAAC,CAAC,CAAE,CAAC,EAAI,CAAC,EAC7L,MAAMM,GAAE,EAAG,CACT,SAAU,CACR,OAAQ,CAAC,IAAInB,EAAAY,GAAK,KAAO,OAASA,EAAE,OAAQG,GAAMA,EAAE,QAAU,CAAC,IAAlD,KAAAf,EAAwD,CAAC,EAAG,GAAGa,CAAC,CAC/E,CACF,CAAC,EAAGF,EAAE,CACR,CACA,eAAea,GAAE,EAAG,EAAG,EAAG,EAAG,CArI7B,IAAAxB,EAsIE,IAAIgB,EAAGV,EACP,IAAM,EAAIE,EAAE,qBAAqB,EAAGK,GAAKG,EAAI,EAAE,MAAM,SAAS,EAAE,MAAM,WAAa,KAAO,OAASA,EAAE,OAAQF,EAAID,GAAK,KAAO,OAASA,EAAE,KAAMY,GAAMA,EAAE,iBAAiB,OAASA,EAAE,QAAU,CAAC,EAAGV,EAAID,GAAK,MAAQA,EAAE,MAAQ,CACzN,GAAGA,EACH,MAAO,CAAC,GAAGA,EAAE,MAAM,OAAQW,GAAM,CAACC,EAAED,EAAG,CAAC,CAAC,EAAG,GAAG,EAAI,CAAC,CAAC,EAAI,CAAC,CAAC,CAC7D,EAAI,EAAI,CACN,MAAO,EACP,MAAO,CAAC,CAAC,CACX,EAAI,OACJ,MAAMN,GAAE,EAAG,CACT,SAAU,CACR,OAAQ,CAAC,IAAInB,EAAAa,GAAK,KAAO,OAASA,EAAE,OAAQY,GAAMA,IAAMX,CAAC,IAA5C,KAAAd,EAAkD,CAAC,EAAG,IAAIM,EAAIS,GAAK,KAAO,OAASA,EAAE,QAAU,MAAQT,EAAE,OAAS,CAACS,CAAC,EAAI,CAAC,CAAC,CACzI,CACF,CAAC,EAAG,EAAE,CACR,CACA,SAASY,GAAI,CACX,IAAM,EAAIC,GAAE,EAAG,KAAI,EAAAV,YAAEC,CAAC,EAAG,KAAI,EAAAU,SAC3B,KAAO,CACL,OAAQ,EACR,MAAO,CACT,GACA,CAAC,EAAG,CAAC,CACP,EAAG,KAAI,EAAAC,aACL,CAAC,EAAG,IAAMzB,GAAE,EAAG,EAAG,CAAC,EACnB,CAAC,CAAC,CACJ,EAAGO,KAAI,EAAAkB,aACL,CAAC,EAAG,IAAMX,GAAE,EAAG,EAAG,CAAC,EACnB,CAAC,CAAC,CACJ,EAAGN,KAAI,EAAAiB,aACL,CAAC,EAAG,EAAGxB,IAAMkB,GAAE,EAAG,EAAG,EAAGlB,CAAC,EACzB,CAAC,CAAC,CACJ,EAAGQ,KAAI,EAAAgB,aACL,CAAC,EAAG,IAAMP,GAAE,EAAG,EAAG,CAAC,EACnB,CAAC,CAAC,CACJ,EACA,MAAO,CACL,UAAW,EACX,aAAcX,EACd,oBAAqBC,EACrB,cAAeC,CACjB,CACF,CACA,SAASiB,GAAE,CAAE,KAAM,EAAG,KAAM,EAAG,SAAU,CAAE,EAAG,CAC5C,OAAOf,GAAE,EAAI,CACX,SAAU,CAAE,KAAM,EAAI,CAAE,CAC1B,EAAI,CACF,SAAU,CAAE,KAAM,EAAI,CAAE,CAC1B,CACF,CACA,SAASgB,GAAE,EAAI,GAAI,CACjB,GAAM,CAAE,KAAM,EAAG,KAAM,CAAE,EAAI,EAAGnB,GAAM,CAvLxC,IAAAb,EAAAC,EAwLI,IAAI,EAAGc,EACP,MAAO,CACL,MAAQf,GAAA,EAAIa,EAAE,MAAM,WAAa,KAAO,OAAS,EAAE,OAA3C,KAAAb,EAAoD,EAC5D,MAAQC,GAAAc,EAAIF,EAAE,MAAM,WAAa,KAAO,OAASE,EAAE,OAA3C,KAAAd,EAAoD,CAC9D,CACF,CAAC,EAAG,CAAE,aAAc,CAAE,EAAI0B,EAAE,EAC5B,MAAO,CACL,YAAU,EAAAG,aAAE,SAAY,CACtB,MAAM,EAAEC,GAAE,CAAE,KAAM,EAAG,KAAM,EAAG,SAAU,CAAE,CAAC,CAAC,CAC9C,EAAG,CAAC,EAAG,EAAG,EAAG,CAAC,CAAC,CACjB,CACF,CEnMA,IAAAE,GAA6B,kBACzBC,GAAI,EACR,SAASC,EAAEC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAG,CAC3BJ,IAAMA,EAAI,CAAC,GACX,IAAIK,EAAGC,EAAGC,EAAIP,EACd,GAAI,QAASO,EAAG,IAAKD,KAAKC,EAAI,CAAC,EAAGP,EAAGM,GAAK,MAAQD,EAAIL,EAAEM,CAAC,EAAIC,EAAED,CAAC,EAAIN,EAAEM,CAAC,EACvE,IAAIE,EAAI,CAAE,KAAMT,EAAG,MAAOQ,EAAG,IAAKN,EAAG,IAAKI,EAAG,IAAK,KAAM,GAAI,KAAM,IAAK,EAAG,IAAK,KAAM,IAAK,KAAM,YAAa,OAAQ,IAAK,EAAER,GAAG,IAAK,GAAI,IAAK,EAAG,SAAUM,EAAG,OAAQC,CAAE,EACvK,GAAI,OAAOL,GAAK,aAAeM,EAAIN,EAAE,cAAe,IAAKO,KAAKD,EAAGE,EAAED,CAAC,IAAM,SAAWC,EAAED,CAAC,EAAID,EAAEC,CAAC,GAC/F,OAAO,GAAAG,QAAE,OAAS,GAAAA,QAAE,MAAMD,CAAC,EAAGA,CAChC,CCNA,IAAAE,GAA4C,wBAC5CC,GAA8B,kBAC9B,SAASC,GAAEC,EAAGC,EAAG,CALjB,IAAAC,EAAAC,EAAAC,EAME,IAAIC,EAAGC,EAAGC,EACV,IAAMC,GAAMN,GAAAG,EAAIJ,EAAE,WAAa,KAAO,OAASI,EAAE,QAArC,KAAAH,EAA+C,EAAGO,GAAMN,GAAAG,EAAIN,EAAE,WAAa,KAAO,OAASM,EAAE,OAArC,KAAAH,EAA8C,EAAG,GAAMC,GAAAG,EAAIP,EAAE,WAAa,KAAO,OAASO,EAAE,OAArC,KAAAH,EAA8C,EACzK,OAAOI,EAAI,GAAKA,EAAIC,EAAI,CAC1B,CACA,SAASC,IAAI,CACX,MAAO,CAAC,EAAE,OAAO,sBAAwB,OAAO,2BAA6B,sBAAuB,OAAO,0BAA0B,UACvI,CACA,SAASC,GAAE,CAAE,SAAUX,EAAG,SAAUC,CAAE,EAAG,CACvC,IAAMO,KAAI,GAAAI,QAAE,IAAI,EAAG,CAAE,MAAOH,EAAG,SAAUI,CAAE,EAAI,EAAGP,GAAME,GAAEF,EAAG,QAAS,UAAU,CAAC,EAAG,CAAE,SAAUD,CAAE,EAAIS,GAAEb,CAAC,EACzG,SAAO,GAAAc,WAAE,IAAM,CACb,IAAIT,EAAGC,EACP,OAAOR,GAAEU,EAAGI,CAAC,IAAMP,EAAIE,EAAE,QAASD,EAAI,IAAI,qBAAsBS,GAAM,CACpE,IAAMC,EAAID,EAAE,CAAC,EACbC,GAAK,MAAQA,EAAE,gBAAkBZ,EAAE,CACrC,CAAC,EAAGC,GAAKC,EAAE,QAAQD,CAAC,GAAI,IAAM,CAC5BA,GAAKC,EAAE,UAAUD,CAAC,CACpB,CACF,EAAG,CAACO,CAAC,CAAC,EAAmBL,EAAE,GAAAU,SAAG,CAAE,SAAU,CACxClB,EACgBQ,EAAE,MAAO,CAAE,IAAKA,EAAG,MAAO,CAAE,OAAQ,KAAM,CAAE,CAAC,CAC/D,CAAE,CAAC,CACL,CCIO,SAASW,GAAeC,EAAgB,CAC3C,GAAKA,EAEE,IAAIA,EAAM,SAAS,EAAE,SAAS,iBAAiB,EAClD,MAAO,GACJ,GAAI,OAAOA,GAAU,UAAY,WAAYA,GAAS,OAAOA,EAAM,QAAW,SACjF,MAAO,CAAC,CAAC,IAAK,GAAG,EAAE,SAASA,EAAM,MAAM,MAJxC,OAAO,GAMX,MAAO,EACX,CAEA,eAAsBC,GAAUC,EAAwBC,EAAoBC,EAAwC,CAChH,OAAOC,GACH,CACI,OAAQ,CACJ,GAAGH,EAAQ,OACX,SAAUA,EAAQ,MAAM,SAAS,EAAE,QACvC,EACA,MAAOA,EAAQ,KACnB,EACAC,EACAC,CACJ,CACJ,CAEA,eAAsBE,GAAaJ,EAAwBC,EAAoBC,EAAwC,CACnH,IAAMG,EAAcC,EAAU,CAAE,aAAcN,EAAQ,MAAM,SAAS,EAAE,YAAa,EAAGE,CAAO,EAC9F,OAAOK,GACH,CACI,OAAQ,CACJ,GAAGP,EAAQ,OACX,SAAUA,EAAQ,MAAM,SAAS,EAAE,QACvC,EACA,MAAOA,EAAQ,KACnB,EACAC,EACAI,CACJ,CACJ,CAEO,SAASG,GACZR,EACAC,EACAC,EAGF,CACE,IAAMO,EAAYH,EAAUN,EAAQ,MAAM,SAAS,EAAE,MAAO,CAAE,SAAU,CAAE,KAAM,CAAE,CAAE,EAAGC,CAAK,EACtFI,EAAcC,EAAU,CAAE,aAAcN,EAAQ,MAAM,SAAS,EAAE,YAAa,EAAGE,CAAO,EAE9F,MAAO,CACH,IAAK,IAAI,IAAIQ,GAAWC,GAAaX,EAASS,EAAWJ,CAAW,CAAC,CAAC,CAC1E,CACJ,CAEO,SAASO,GAAeC,EAAwBJ,EAAwB,CAC3E,IAAMK,EAAMC,EAAQ,gBAAgB,EAC9B,CAAE,eAAAC,EAAgB,iBAAAC,EAAkB,aAAAC,CAAa,EAAIL,EAE3D,GAAIG,EAAe,GAAKC,EAAkB,CACtCA,EAAiBR,CAAS,EAC1B,MACJ,SAAWS,EAAc,CACrBA,EAAaT,CAAS,EACtB,MACJ,CAEmBU,GAAgB,IAE3BN,EAAO,WAAa,SACpB,SAAS,OAAO,GAEhBO,GAAqB,EACrBC,GAAkB,IAG1BP,EAAI,CACR,CCvGA,IAAAQ,GAA8B,kBAE9B,SAASC,GAAE,CAAE,SAAU,CAAE,EAAG,CAC1B,GAAM,CAAE,SAAUC,CAAE,EAAIC,GAAE,CAAC,EAC3B,OAAuBC,EAAE,SAAU,CAAE,QAASF,EAAG,SAAU,cAAe,CAAC,CAC7E,CACA,SAASG,GAAE,CAAE,SAAU,EAAG,kBAAmBH,EAAG,SAAUE,CAAE,EAAG,CAC7D,GAAM,CAAE,QAASE,EAAG,MAAOC,EAAG,SAAUC,CAAE,EAAI,EAAGC,GAAML,GAAEK,EAAG,UAAW,QAAS,UAAU,CAAC,EAAGC,EAAI,CAACJ,GAAKK,GAAEJ,EAAGC,CAAC,EAC9G,OAAuBJ,EAAE,GAAAQ,SAAG,CAAE,SAAU,CACtC,EACAF,IAAMR,EAAoBE,EAAEF,EAAG,CAAE,SAAUE,CAAE,CAAC,EAAoBA,EAAEH,GAAG,CAAE,SAAUG,CAAE,CAAC,EACxF,CAAE,CAAC,CACL,CACA,IAAMS,GAAI,CAACC,GAAE,GAAKC,GAAE,EAAId,GAAII,GCjB5B,IAAAW,GAA2B,wBAQpB,SAASC,IAAW,CAEvB,SAAO,eAAWC,CAAY,CAClC,CCTA,IAAAC,EAA2F,wBAO3F,SAASC,GAAE,EAAGC,EAAG,CAVjB,IAAAC,EAWE,IAAIC,EACJ,IAAMC,GAAMF,GAAAC,EAAI,EAAE,OAAS,KAAO,OAASA,EAAE,OAAQE,GAAMA,EAAE,QAAQ,EAAE,SAA3D,KAAAH,EAAsE,EAAG,CAAE,OAAQI,CAAE,EAAI,CACnG,OAAQF,EAAI,EACZ,GAAGH,CACL,EAAG,CAACM,EAAGC,CAAC,KAAI,EAAAC,UAAEH,CAAC,EAAG,CAAE,oBAAqBI,CAAE,EAAIC,EAAE,EAAG,KAAI,EAAAC,aAAE,IAAM,CAC9DJ,EAAE,CAACD,CAAC,CACN,EAAG,CAACA,CAAC,CAAC,EACN,MAAO,CAEL,OAAQA,EAER,qBAAsBH,EAEtB,aAAc,EAEd,oBAAqBM,CACvB,CACF,CACA,SAASG,IAAK,CACZ,GAAM,CAAE,QAAS,EAAG,OAAQZ,CAAE,EAAI,EAAGG,GAAM,CA9B7C,IAAAF,EA+BI,IAAII,EAAGC,EACP,MAAO,CACL,QAASH,EAAE,QACX,QAAUF,GAAAK,GAAKD,EAAIF,EAAE,WAAa,KAAO,OAASE,EAAE,WAAa,KAAO,OAASC,EAAE,SAAzE,KAAAL,EAAoF,CAAC,CACjG,CACF,CAAC,EACD,MAAO,CAEL,QAAS,EAET,OAAQD,CACV,CACF,CACA,SAASa,GAAE,EAAGb,EAAG,CACf,IAAMG,EAAIH,EAAI,EACd,MAAO,CAAC,MAAMG,CAAC,GAAKA,EAAI,EAAI,IAAI,MAAMH,EAAI,CAAC,EAAE,KAAK,MAAM,EAAE,IAAI,CAACK,EAAGC,IAAMA,EAAI,CAAC,EAAI,CAAC,CACpF,CACA,SAASQ,GAAG,EAAG,CACb,GAAM,CAAE,MAAOd,EAAG,SAAUG,CAAE,EAAI,EAAGE,IAAO,CAC1C,MAAOA,EAAE,MACT,SAAUA,EAAE,SAAS,QACvB,EAAE,EACF,SAAO,EAAAU,SAAE,IAAM,CArDjB,IAAAd,EAAAe,EAsDI,IAAIC,EAAGC,EAAGC,EACV,GAAI,CAAChB,EACH,MAAO,CACL,WAAY,EACZ,YAAa,EACb,UAAW,EACX,MAAO,CAAC,CACV,EACF,IAAME,GAAMJ,GAAAgB,EAAIjB,EAAE,WAAa,KAAO,OAASiB,EAAE,OAArC,KAAAhB,EAA8C,EAAG,GAAKe,EAAA,GAAK,KAAO,OAAS,EAAE,QAAvB,KAAAA,EAAiC,IAAOT,EAAI,KAAK,IAAI,KAAK,MAAM,EAAI,CAAC,EAAI,EAAG,CAAC,EAAG,EAAIJ,EAAE,KAAO,EAAI,KAAK,MAAME,EAAIF,EAAE,IAAI,EAAI,EAAI,EAAGiB,EAAIjB,EAAE,KAAO,EAAI,KAAK,KAAKA,EAAE,MAAQA,EAAE,IAAI,EAAI,EAAGD,EAAKmB,GAAMA,GAAK,EAAId,GAAKc,GAAK,EAAId,EAAGH,EAAIC,EAAI,EAAGiB,EAAI,KAAK,IAAIjB,EAAIF,EAAE,MAAOA,EAAE,KAAK,EAAGoB,EAAI,CAC3U,KAAMlB,EACN,KAAM,EACN,QAAS,EACX,EAAGmB,EAAKH,IAAO,CACb,MAAOA,EAAI,GAAKlB,EAAE,KAClB,KAAMkB,EACN,QAASA,IAAM,CACjB,GAAII,EAAI,EAAI,EAAID,EAAE,EAAI,CAAC,EAAI,OAAQE,EAAI,EAAIN,EAAII,EAAE,EAAI,CAAC,EAAI,OAAQG,EAAI,EAAIpB,EAAI,EAAI,EAAIiB,EAAE,CAAC,EAAI,OAAQI,EAAI,EAAIrB,EAAI,EAAIa,EAAII,EAAEJ,CAAC,EAAI,OAAQS,EAAIhB,GAAE,EAAGO,EAAI,CAAC,EAAE,OAAOlB,CAAC,EAAE,IAAIsB,CAAC,EACvK,MAAO,CAACG,KAAOT,EAAIW,EAAE,CAAC,IAAM,KAAO,OAASX,EAAE,QAAU,GAAKW,EAAE,QAAQL,EAAE,CAAC,CAAC,EAAG,CAACI,KAAOT,EAAIU,EAAEA,EAAE,OAAS,CAAC,IAAM,KAAO,OAASV,EAAE,QAAUC,EAAI,GAAKS,EAAE,KAAKL,EAAEJ,CAAC,CAAC,EAAG,CAC/J,WAAYA,EACZ,YAAahB,EACb,UAAWkB,EACX,QAASC,EACT,KAAME,EACN,KAAMC,EACN,MAAOC,EACP,KAAMC,EACN,MAAOC,CACT,CACF,EAAG,CAAC7B,EAAGG,EAAG,GAAK,KAAO,OAAS,EAAE,KAAK,CAAC,CACzC,CAaA,SAAS2B,IAAI,CACX,GAAM,CAAE,OAAQ,CAAE,EAAI,EAAGC,GAAM,CAjGjC,IAAAC,EAkGI,IAAIC,EACJ,MAAO,CACL,QAAUD,GAAAC,EAAIF,EAAE,SAAS,WAAa,KAAO,OAASE,EAAE,SAA9C,KAAAD,EAAyD,CAAC,CACtE,CACF,CAAC,EAAG,CAAE,cAAeE,EAAG,oBAAqBC,CAAE,EAAIC,EAAE,EAAGC,KAAI,EAAAC,aACzDP,GAAM,CACL,IAAME,EAAI,GAAK,KAAO,OAAS,EAAE,KAAMM,GAAMA,EAAE,OAAS,SAAWA,EAAE,QAAUR,CAAC,EAChF,GAAIE,GAAK,QAASA,GAAK,QAASA,EAC9B,OAAOA,CACX,EACA,CAAC,CAAC,CACJ,EAAGO,KAAI,EAAAF,aACJP,GAAM,CA9GX,IAAAC,EA+GM,IAAIC,EACJ,OAASD,GAAAC,EAAI,GAAK,KAAO,OAAS,EAAE,KAAMM,GAAMA,EAAE,QAAUR,CAAC,IAAM,KAAO,OAASE,EAAE,OAA5E,KAAAD,EAAqFD,CAChG,EACA,CAAC,CAAC,CACJ,EAAG,KAAI,EAAAO,aAAGP,GAAM,UAAWA,IAAMA,EAAE,iBAAiB,OAASA,EAAE,iBAAiB,OAAQ,CAAC,CAAC,EAAGU,KAAI,EAAAH,aAAGP,GAAM,CACxG,IAAIE,EACJ,MAAO,CACL,GAAGF,EACH,OAAQE,EAAIF,EAAE,QAAU,KAAO,OAASE,EAAE,IAAKM,IAAO,CACpD,GAAIA,EAAE,GAAK,OAAOA,EAAE,EAAE,EAAIA,EAAE,GAC5B,IAAKA,EAAE,IAAM,OAAOA,EAAE,GAAG,EAAIA,EAAE,IAC/B,GAAIA,EAAE,GAAK,OAAOA,EAAE,EAAE,EAAIA,EAAE,GAC5B,IAAKA,EAAE,IAAM,OAAOA,EAAE,GAAG,EAAIA,EAAE,GACjC,EAAE,CACJ,CACF,EAAG,CAAC,CAAC,EAAGG,KAAI,EAAAJ,aACTP,GAAG,CA/HR,IAAAC,EA+HY,QAAAA,EAAAD,EAAE,QAAF,KAAAC,EAAW,CAAC,GAAG,IAAKO,IAAO,CACjC,MAAOA,EACP,MAAOR,EAAE,MACT,KAAMS,EAAET,EAAE,KAAK,EACf,OAAQU,EAAEV,CAAC,EACX,OAAQ,IAAM,CACZI,EAAEJ,EAAE,MAAOQ,EAAG,EAAE,CAClB,CACF,EAAE,GACF,CAACE,EAAGD,EAAGL,CAAC,CACV,EAAGQ,KAAI,EAAAL,aACJP,GAAG,CA1IR,IAAAC,EA0IY,QAAAA,EAAAD,EAAE,QAAF,KAAAC,EAAW,CAAC,GAAG,IAAKO,GAAM,CA1ItC,IAAAP,EAAAY,EAAAC,EAAAC,EA2IM,IAAIC,EAAGC,EACP,IAAMC,GAAIL,GAAAZ,EAAAO,EAAE,MAAF,KAAAP,EAASO,EAAE,KAAX,KAAAK,GAAmBG,EAAIV,EAAEN,EAAE,KAAK,IAAM,KAAO,OAASgB,EAAE,IAAMG,GAAIJ,GAAAD,EAAAN,EAAE,MAAF,KAAAM,EAASN,EAAE,KAAX,KAAAO,GAAmBE,EAAIX,EAAEN,EAAE,KAAK,IAAM,KAAO,OAASiB,EAAE,IACpI,GAAIC,IAAM,QAAUC,IAAM,OACxB,MAAO,CACL,MAAO,GAAGD,CAAC,MAAMC,CAAC,GAClB,MAAOnB,EAAE,MACT,KAAMS,EAAET,EAAE,KAAK,EACf,OAAQU,EAAEV,CAAC,EACX,OAAQ,IAAM,CACZG,EAAEH,EAAE,MAAO,MAAM,CACnB,CACF,CACJ,CAAC,EAAE,OAAO,OAAO,GACjB,CAACU,EAAGJ,EAAGG,EAAGN,CAAC,CACb,EACA,MAAO,CACL,cAAe,EACf,cAAeQ,EACf,cAAeC,CACjB,CACF,CACA,SAASP,IAAI,CACX,GAAM,CAAE,OAAQ,CAAE,EAAI,EAAGM,GAAM,CAjKjC,IAAAV,EAkKI,IAAIW,EACJ,MAAO,CACL,QAAUX,GAAAW,EAAID,EAAE,MAAM,WAAa,KAAO,OAASC,EAAE,SAA3C,KAAAX,EAAsD,CAAC,CACnE,CACF,CAAC,EAAG,CAAE,aAAcE,CAAE,EAAIE,EAAE,EAAG,CAAE,cAAeD,EAAG,cAAeE,EAAG,cAAeG,CAAE,EAAIV,GAAE,EAAG,KAAI,EAAAqB,SAAE,IAAM,EAAI,EAAE,OAAOhB,CAAC,EAAE,QAASO,GAAM,UAAWA,EAAIL,EAAEK,CAAC,EAAI,UAAWA,EAAIF,EAAEE,CAAC,EAAI,CAAC,CAAC,EAAE,OAAO,OAAO,EAAI,CAAC,EAAG,CAAC,EAAGP,EAAGK,EAAGH,CAAC,CAAC,EAAGI,KAAI,EAAAH,aAAE,IAAM,CACzOJ,EAAE,CACA,SAAU,CACR,OAAQ,CAAC,CACX,CACF,CAAC,CACH,EAAG,CAACA,CAAC,CAAC,EACN,MAAO,CAEL,QAAS,EAET,UAAWO,CACb,CACF,CACA,SAASW,GAAE,EAAG,CApLd,IAAApB,EAAAY,EAqLE,IAAIL,EAAGU,EAAGC,EACV,GAAM,CAAE,cAAehB,CAAE,EAAIE,EAAE,EAAG,CAAE,MAAOD,EAAG,SAAUE,CAAE,EAAI,EAAGU,IAAO,CACtE,MAAOA,EAAE,MACT,SAAUA,EAAE,SAAS,QACvB,EAAE,EAAG,GAAKR,EAAIF,GAAK,KAAO,OAASA,EAAE,SAAW,KAAO,OAASE,EAAE,KAAMQ,GAAMA,EAAE,KAAO,CAAC,EACxF,GAAI,CAAC,EACH,MAAO,CACL,IAAK,EACL,IAAK,EACL,MAAO,CAAC,EAAG,CAAC,EACZ,YAAa,IAAM,CACnB,CACF,EACF,IAAMM,GAAKH,GAAKD,EAAId,EAAE,WAAa,KAAO,OAASc,EAAE,SAAW,KAAO,OAASC,EAAE,KAAMH,GAAMA,EAAE,QAAU,EAAE,KAAK,EAAG,EAAIM,GAAK,MAAQA,EAAE,MAAQA,EAAE,MAAM,CAAC,EAAI,OAAQX,EAAI,OAAO,GAAK,WAAa,QAAS,GAAK,QAAS,GAAK,CAACY,EAAE,EAAE,GAAG,EAAGA,EAAE,EAAE,GAAG,CAAC,EAAI,CAAC,OAAQ,MAAM,EAAGX,EAAI,QAAS,EAAI,KAAK,MAAM,EAAE,GAAG,EAAI,EAAGZ,EAAI,QAAS,EAAI,KAAK,KAAK,EAAE,GAAG,EAAI,EAAGE,EAAI,CAAC,CAACc,EAAGC,CAAC,IAAM,CACnW,IAAMO,EAAIR,IAAM,OAAS,KAAK,MAAMA,CAAC,EAAI,OAAQS,EAAIR,IAAM,OAAS,KAAK,KAAKA,CAAC,EAAI,OAAQS,EAAIF,IAAM,OAAQG,EAAIF,IAAM,QACtHb,IAAMY,GAAK,CAACE,KAAO1B,IAAMyB,GAAK,CAACE,GAAKxB,EAAE,EAAE,MAAO,MAAM,GAAKS,IAAMY,GAAK,CAACE,IAAMC,EAAIxB,EAAE,EAAE,MAAO,CAC1F,IAAKsB,EAAE,SAAS,CAClB,CAAC,GAAKzB,IAAMyB,GAAK,CAACE,IAAMD,EAAIvB,EAAE,EAAE,MAAO,CACrC,IAAKqB,EAAE,SAAS,CAClB,CAAC,EAAIE,GAAKC,GAAKxB,EAAE,EAAE,MAAO,CACxB,IAAKqB,EAAE,SAAS,EAChB,IAAKC,EAAE,SAAS,CAClB,CAAC,CACH,EACA,MAAO,CAEL,IAAKb,EAEL,IAAKZ,EAEL,MAAO,EAACC,EAAAU,EAAE,CAAC,IAAH,KAAAV,EAAQW,GAAGC,EAAAF,EAAE,CAAC,IAAH,KAAAE,EAAQb,CAAC,EAE5B,YAAaE,CACf,CACF,CACA,SAAS0B,GAAG,EAAGzB,EAAG,CAChB,GAAM,CAAE,IAAKC,EAAG,IAAKE,EAAG,MAAOG,EAAG,YAAa,CAAE,EAAIY,GAAE,CAAC,EAAG,CAAE,QAASX,CAAE,EAAIL,GAAE,EAAGM,KAAI,EAAAS,SAAE,IAAM,CAC3F,IAAIH,EACJ,IAAMT,EAAIE,EAAE,KAAMc,GAAM,CACtB,IAAIC,EACJ,OAAQA,EAAID,GAAK,KAAO,OAASA,EAAE,SAAW,KAAO,OAASC,EAAE,KAClE,CAAC,EACGP,EAAI,KACR,GAAIV,EAAG,CACL,IAAMgB,GAAKP,EAAIT,EAAE,OAAO,QAAU,KAAO,OAASS,EAAE,CAAC,EACrDC,EAAI,CAACK,EAAEC,GAAK,KAAO,OAASA,EAAE,GAAG,EAAGD,EAAEC,GAAK,KAAO,OAASA,EAAE,GAAG,CAAC,CACnE,CACA,IAAML,EAAI,CAAC,EACPH,EAAI,KAAK,MAAMZ,EAAID,CAAC,EAAIA,EAC5B,KAAOa,EAAIV,GAAK,CACd,IAAMkB,EAAIR,EAAIb,EAAGsB,EAAIP,GAAKA,EAAE,CAAC,IAAMF,GAAKE,EAAE,CAAC,IAAMM,EACjDL,EAAE,KAAK,CACL,IAAKH,EACL,IAAKQ,EACL,SAAUC,CACZ,CAAC,EAAGT,EAAIQ,CACV,CACA,OAAOL,CACT,EAAG,CAACT,EAAGN,EAAGE,EAAGH,CAAC,CAAC,EAAGS,EAAKJ,GAAM,CAC3B,EAAE,CAACA,EAAGC,EAAE,CAAC,CAAC,CAAC,CACb,EAAGT,EAAKQ,GAAM,CACZ,EAAE,CAACC,EAAE,CAAC,EAAGD,CAAC,CAAC,CACb,EAAGN,EAAIE,IAAMK,EAAE,CAAC,GAAKH,IAAMG,EAAE,CAAC,EAC9B,MAAO,CAEL,IAAKL,EAEL,IAAKE,EAEL,MAAOG,EAEP,YAAa,EAEb,OAAQE,EAER,gBAAiBC,EAEjB,gBAAiBZ,EAEjB,WAAYE,CACd,CACF,CACA,SAAS2B,IAAK,CACZ,GAAM,CAAE,SAAU,EAAG,SAAU1B,CAAE,EAAI,EAAGC,GAAMA,EAAE,QAAQ,EACxD,MAAO,CAEL,SAAU,UAAK,CAAE,KAAM,CAAC,EAAG,MAAO,CAAE,EAEpC,SAAUD,GAAA,KAAAA,EAAK,CAAE,KAAM,CAAC,EAAG,MAAO,CAAE,CACtC,CACF,CACA,SAAS2B,IAAK,CACZ,IAAM,EAAI,EAAG,GAAM,CACjB,IAAI,EACJ,OAAQ,EAAI,EAAE,MAAM,WAAa,KAAO,OAAS,EAAE,MACrD,CAAC,EACD,SAAO,EAAAV,SAAE,IAAM,EAAI,EAAE,OAAO,CAAC,EAAG,IAAM,GAAK,MAAM,QAAQ,EAAE,KAAK,EAAI,EAAE,MAAM,OAAS,GAAI,CAAC,EAAI,EAAG,CAAC,CAAC,CAAC,CACtG,CACA,SAASW,GAAE,EAAG,CACZ,OAAO,GAAK,CAAC,OAAO,MAAM,CAAC,EAAI,EAAI,CACrC,CACA,SAASC,GAAG,EAAG7B,EAAG,CAChB,GAAM,CAAE,KAAMC,EAAG,KAAME,EAAG,MAAOG,CAAE,EAAI,EAAGT,GAAM,CA3RlD,IAAAC,EAAAY,EAAAC,EA4RI,IAAIZ,EAAGM,EAAGU,EAAG,EAAGF,EAChB,MAAO,CACL,KAAMe,IAAI9B,GAAAC,EAAIF,EAAE,MAAM,WAAa,KAAO,OAASE,EAAE,OAA3C,KAAAD,EAAoD,CAAC,EAC/D,KAAM8B,IAAIlB,GAAAK,GAAKV,EAAIR,EAAE,WAAa,KAAO,OAASQ,EAAE,WAAa,KAAO,OAASU,EAAE,OAAzE,KAAAL,EAAkF,CAAC,EAC7F,MAAOkB,IAAIjB,GAAAE,GAAK,EAAIhB,EAAE,WAAa,KAAO,OAAS,EAAE,WAAa,KAAO,OAASgB,EAAE,QAAzE,KAAAF,EAAmF,CAAC,CACjG,CACF,CAAC,EAAG,CAAE,aAAc,CAAE,EAAIT,EAAE,EAAGK,EAAIN,EAAIE,EAAGK,EAAI,CAAC,GAAG,CAAC,EAAE,QAAQ,EAAE,OAAQX,GAAMA,EAAIG,EAAIM,CAAC,EACtF,MAAO,CAEL,KAAML,EAEN,GAAIM,EAEJ,MAAOD,EAEP,KAAMH,EAEN,YAAaK,EAEb,iBAAmBX,GAAM,CACvB,EAAE,CACA,SAAU,CACR,KAAMuB,EAAEvB,CAAC,CACX,CACF,CAAC,CACH,CACF,CACF,CACA,SAASiC,GAAE,EAAG9B,EAAG,CACf,OAAO,EAAE,SAAWA,EAAE,OAAS,GAAK,EAAE,MAAOC,GAAMD,EAAE,KAAMG,GAAMF,EAAE,QAAUE,EAAE,OAASF,EAAE,QAAUE,EAAE,KAAK,CAAC,CAC9G,CACA,SAAS4B,GAAG,EAAG,CA3Tf,IAAAjC,EA4TE,IAAIqB,EAAGZ,EACP,IAAM,EAAI,EAAGC,GAAMA,EAAE,KAAK,EAAG,CAAE,aAAcP,CAAE,EAAIC,EAAE,EACrD,MAAO,CAEL,YAAcJ,GAAAqB,EAAI,EAAE,KAAMX,GAAM,CAC9B,IAAIC,EACJ,OAAOqB,GAAEtB,EAAE,MAAM,OAAQC,EAAI,EAAE,WAAa,KAAO,OAASA,EAAE,OAAS,CAAC,CAAC,CAC3E,CAAC,IAAM,KAAO,OAASU,EAAE,KAHX,KAAArB,GAGoBS,EAAI,EAAE,CAAC,IAAM,KAAO,OAASA,EAAE,GAEjE,QAAUC,GAAM,CACd,IAAMC,EAAI,EAAE,KAAMZ,GAAMA,EAAE,KAAOW,CAAC,EAClCC,GAAKR,EAAE,CACL,SAAU,CACR,KAAMQ,EAAE,MAAM,IAChB,CACF,CAAC,CACH,CACF,CACF,CACA,IAAMuB,GAAI,OAAO,mBAAqB,OAAO,wBAAyBC,GAAI,CAAC,EAAED,IAAK,OAAOA,IAAK,YAC9F,SAASE,IAAI,CACX,MAAO,CACL,UAAW,GACX,eAAgB,IAAM,CACtB,EACA,cAAe,IAAM,CACrB,CACF,CACF,CACA,SAASC,GAAE,CACT,SAAU,EAAI,QACd,eAAgBnC,EAAI,GACpB,SAAUC,EACV,QAASE,CACX,EAAI,CAAC,EAAG,CACN,GAAM,CAACG,EAAG,CAAC,KAAI,EAAA8B,UAAE,EAAE,EAAG7B,KAAI,EAAA8B,QAAE,IAAI,EAAG7B,KAAI,EAAAJ,aAAE,IAAM,CAC7C,IAAMP,EAAI,IAAImC,GACdnC,EAAE,KAAO,EAAGA,EAAE,eAAiBG,EAAGH,EAAE,QAAU,IAAM,EAAE,EAAE,EAAGI,IAAMJ,EAAE,SAAYE,GAAM,CACnF,IAAIgB,EAAG,EACP,GAAM,CAAE,WAAYV,CAAE,GAAK,GAAKU,EAAIhB,EAAE,UAAY,KAAO,OAASgB,EAAE,CAAC,IAAM,KAAO,OAAS,EAAE,CAAC,EAC9Fd,EAAEI,CAAC,CACL,GAAIF,IAAMN,EAAE,QAAWE,GAAMI,EAAEJ,EAAE,KAAK,GAAIF,EAAE,MAAQ,IAAM,EAAE,EAAE,EAAGU,EAAE,QAAUV,EAAGA,EAAE,MAAM,CAC1F,EAAG,CAAC,EAAGG,EAAGG,EAAGF,CAAC,CAAC,EAAGQ,KAAI,EAAAL,aAAE,IAAM,CAC5B,IAAIP,GACHA,EAAIU,EAAE,UAAY,MAAQV,EAAE,KAAK,CACpC,EAAG,CAACU,CAAC,CAAC,EACN,MAAO,CACL,UAAWD,EACX,eAAgBE,EAChB,cAAeC,CACjB,CACF,CACA,IAAM6B,GAAKL,GAAIE,GAAID,GC9UZ,SAASK,IAAa,CACzB,IAAMC,EAAU,CACZ,OAAQC,GAAU,EAClB,MAAOC,GAAS,CACpB,EAEM,CAAE,oBAAAC,EAAqB,cAAAC,CAAc,EAAIC,EAAe,EAE9D,MAAO,CACH,aAAaC,EAAoBC,EAAyB,CACtD,OAAOC,GAAaR,EAASM,EAAOC,CAAO,CAC/C,EACA,UAAUD,EAAoBC,EAAyB,CACnD,OAAOE,GAAUT,EAASM,EAAOC,CAAO,CAC5C,EACA,oBAAoBG,EAAeC,EAAeC,EAAiB,CAC/D,OAAOT,EAAoBO,EAAOC,EAAOC,CAAM,CACnD,EACA,cAAcF,EAAeC,EAAoD,CAC7E,OAAOP,EAAcM,EAAOC,CAAK,CACrC,EACA,qBAAqBL,EAAoBC,EAAyB,CAC9D,OAAOM,GAAqBb,EAASM,EAAOC,CAAO,CACvD,CACJ,CACJ,CC3DA,IAAAO,GAAoC,wBAyB7B,SAASC,EAA8BC,EAAgD,CAC1F,IAAMC,EAAQC,GAAS,EACjB,CAACC,EAAOC,CAAQ,KAAI,aAASJ,EAASC,EAAM,SAAS,CAAC,CAAC,EAC7D,OAAAA,EAAM,SAASD,EAAUI,CAAQ,KACjC,cAAU,IACC,IAAMH,EAAM,cAAcG,CAAQ,EAE1C,CAAC,CAAC,EACED,CACX,CCTO,SAASE,IAAc,CAC1B,OAAOC,EAAoBC,GAASA,CAAK,CAC7C,CCGO,SAASC,GAAcC,EAU5B,CACE,OAAOC,GAAkBD,CAAO,CACpC,CCNO,SAASE,IA+Bd,CACE,OAAOC,GAAsB,CACjC,CCSO,SAASC,GACZC,EACAC,EAsBF,CACE,OAAOC,GAAqBF,EAAIC,CAAS,CAC7C,CCzCO,SAASE,GAASC,EASvB,CACE,OAAOC,GAAaD,CAAE,CAC1B,CCtBO,SAASE,GACZC,EACAC,EAMF,CACE,OAAOC,GAAaF,EAAOC,CAAO,CACtC,CC7CO,SAASE,IAAkC,CAC9C,OAAOC,GAA4B,CACvC,CCiBO,SAASC,GAAQC,EAKtB,CACE,OAAOC,GAAYD,CAAW,CAClC,CCNO,SAASE,GACZC,EACAC,EAcF,CACE,OAAOC,GAAmBF,EAAOC,CAAQ,CAC7C,CCnBO,SAASE,IAAyD,CACrE,OAAOC,GAAc,CACzB,CC0CO,SAASC,IAAsE,CAClF,OAAOC,GAAgB,CAC3B,CCtCO,SAASC,IAKd,CAjDF,IAAAC,EAAAC,EAkDI,GAAM,CAAE,MAAAC,EAAO,SAAAC,CAAS,EAAIC,EAAoBC,GAASC,GAAKD,EAAO,QAAS,UAAU,CAAC,EACnF,CAAE,aAAAE,CAAa,EAAIC,GAAW,EAG9BC,EAAc,GAEpB,GAAI,EAACN,GAAA,MAAAA,EAAU,UACX,MAAO,CACH,QAAS,GACT,QAAS,GACT,SAAU,IAAM,CAAC,EACjB,SAAU,IAAM,CAAC,CACrB,EAGJ,IAAMO,GAAOT,GAAAD,EAAAE,EAAM,WAAN,YAAAF,EAAgB,OAAhB,KAAAC,EAAwB,EAC/BU,EAAWR,EAAS,SAAS,KAE7BS,EAAUF,EAAO,EACjBG,EAAUJ,GAAeN,EAAS,SAAS,KAAK,QAAUQ,EAkBhE,MAAO,CACH,QAAAC,EACA,QAAAC,EACA,SAnBa,IAAM,CACnB,GAAID,EAAS,CACT,IAAME,EAAU,KAAK,IAAI,EAAGJ,EAAOC,CAAQ,EAC3CJ,EAAa,CAAE,SAAU,CAAE,KAAMO,CAAQ,CAAE,CAAC,EAC5C,SAAS,EAAG,CAAC,CACjB,CACJ,EAcI,SAZa,IAAM,CACnB,GAAID,EAAS,CACT,IAAMC,EAAUJ,EAAOC,EACvBJ,EAAa,CAAE,SAAU,CAAE,KAAMO,CAAQ,CAAE,CAAC,EAC5C,SAAS,EAAG,CAAC,CACjB,CACJ,CAOA,CACJ,CCpEO,SAASC,GAAYC,EAAW,GAAI,CACvC,GAAM,CAAE,KAAAC,EAAM,KAAAC,CAAK,EAAI,EAAiBC,GAAM,CA1BlD,IAAAC,EAAAC,EAAAC,EAAAC,EA0BsD,OAC9C,MAAMF,GAAAD,EAAAD,EAAM,MAAM,WAAZ,YAAAC,EAAsB,OAAtB,KAAAC,EAA8B,EACpC,MAAME,GAAAD,EAAAH,EAAM,MAAM,WAAZ,YAAAG,EAAsB,OAAtB,KAAAC,EAA8B,CACxC,EAAE,EACI,CAAE,qBAAAC,CAAqB,EAAIC,GAAW,EAEtC,CAAE,SAAUC,CAAa,EAAIC,GAAgBX,CAAQ,EACrDY,EAAOJ,EAAqBK,GAAiB,CAAE,KAAAZ,EAAM,KAAAC,EAAM,SAAAF,CAAS,CAAC,CAAC,EAAE,IAAI,SAAS,EAG3F,SAASc,EAASC,EAAoB,CAClCA,GAAA,MAAAA,EAAO,iBACPL,EAAa,CACjB,CAEA,MAAO,CACH,SAAAI,EACA,KAAAF,CACJ,CACJ,CC7CA,IAAAI,GAA0B,wBAqBnB,SAASC,GACZC,EACAC,EAAkC,CAAC,EACnCC,EAAuB,OACzB,CACE,IAAMC,EAAWC,EAAoBC,GAASA,EAAM,SAAS,QAAQ,KAErE,cAAU,IAAM,CACZ,IAAMC,EAAQ,IAAI,YAAYN,EAAM,CAChC,OAAQC,CACZ,CAAC,EAEDC,EAAQ,cAAcI,CAAK,CAE/B,EAAG,CAACH,CAAQ,CAAC,CACjB,CCpCA,IAAAI,GAAqC,wBCCrC,IAAMC,GAAI,CACR,gBAAiB,MACjB,cAAe,QAEf,iBAAkB,CAAC,CACrB,EAAGC,GAAI,CACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QAEL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACP,EACA,SAASC,GAAEC,EAAI,CAAC,EAAG,CACjB,IAAMC,EAAI,CACR,GAAGJ,GACH,GAAGG,CACL,EACAA,EAAE,kBAAoBE,EAAGC,GAAM,CA1BjC,IAAAC,EA2BIH,EAAE,kBAAmBG,EAAAD,EAAE,SAAS,YAAY,EAAE,mBAAzB,KAAAC,EAA6C,CAAC,CACrE,CAAC,EACD,SAASC,EAAEF,EAAG,EAAG,CA7BnB,IAAAC,EA8BI,GAAM,CAAE,gBAAiBE,EAAG,iBAAkBC,EAAG,cAAeL,CAAE,EAAID,EAAGO,EAAI,UAAKF,EAAGG,GAAIL,EAAAN,GAAEU,CAAC,IAAH,KAAAJ,EAAQF,EACjG,GAAIM,KAAKD,EAAG,CACV,IAAMG,EAAIH,EAAEC,CAAC,EAAGG,EAAI,IAAI,KAAK,aAAaF,EAAG,CAC3C,YAAa,CAAC,CAACC,EAAE,kBACjB,sBAAuBA,EAAE,cACzB,sBAAuBA,EAAE,aAC3B,CAAC,EAAE,cAAcP,CAAC,EAAE,IAAKS,GAAMA,EAAE,OAAS,QAAUF,EAAE,kBAAoBE,EAAE,OAAS,UAAYF,EAAE,iBAAmBE,EAAE,KAAK,EAAE,KAAK,EAAE,EACtI,OAAOF,GAAK,MAAQA,EAAE,qBAAuB,GAAGA,EAAE,aAAa,GAAGC,CAAC,GAAK,GAAGA,CAAC,GAAGD,GAAK,KAAO,OAASA,EAAE,aAAa,EACrH,CACA,OAAO,IAAI,KAAK,aAAaD,EAAG,CAC9B,MAAO,WACP,SAAUD,CACZ,CAAC,EAAE,OAAOL,CAAC,CACb,CACA,MAAO,CACL,eAAgBE,CAClB,CACF,CACA,SAASQ,GAAEb,EAAG,CACZ,GAAM,CAAE,eAAgBC,CAAE,EAAIF,GAAEC,CAAC,EACjC,SAASK,EAAE,EAAGC,EAAG,CACf,IAAMC,EAAI,CAAC,EACX,OAAO,EAAE,QAAU,SAAWA,EAAE,UAAYN,EAAE,EAAE,MAAOK,CAAC,GAAI,EAAE,YAAc,SAAWC,EAAE,cAAgBN,EAAE,EAAE,UAAWK,CAAC,GAAI,OAAO,OAAO,CAAC,EAAG,EAAGC,CAAC,CACrJ,CACA,SAASJ,EAAE,EAAG,CACZ,OAAO,EAAE,QAAU,QAAU,EAAE,YAAc,MAC/C,CACA,OAAO,SAASG,EAAG,CACjB,GAAI,CAACH,EAAEG,CAAC,EACN,OAAOA,EACT,IAAMC,EAAIF,EAAEC,EAAGA,EAAE,iBAAiB,EAClC,OAAOC,EAAE,MAAQA,EAAE,KAAK,KAAKJ,CAAC,IAAMI,EAAE,KAAOA,EAAE,KAAK,IAAKL,GAAMC,EAAED,CAAC,EAAIG,EAAEH,EAAGI,EAAE,iBAAiB,EAAIJ,CAAC,GAAIK,CACzG,CACF,CD9BO,SAASO,IAAwB,CACpC,GAAM,CAAE,gBAAAC,CAAgB,EAAIC,GAAU,EAChCC,KAAqB,YAAQC,GAAuB,CAAC,CAAC,EAQ5D,MAAO,CAAE,UANM,gBACX,CAACC,EAAeC,IACLH,EAAmB,eAAeE,EAAOC,GAAA,KAAAA,EAAYL,CAAe,EAE/E,CAACE,EAAoBF,CAAe,CACxC,CACgB,CACpB,CEnBO,IAAMM,GAAsB,CAC/B,GAAGC,GACH,SAAU,OACV,aAAc,CAAC,CACnB,EAEO,SAASC,GAAYC,EAA2B,CAEnD,MAAO,CACH,GAFUC,GAAsBJ,GAAcG,CAAS,EAIvD,gBAAiB,IAAMA,CAC3B,CACJ,CAKO,IAAME,GAAeC,ECxC5B,IAAAC,GAAiC,wBCFjC,IAAAC,GAAiC,wBCCjC,IAAAC,GAA+B,wBAC/B,SAASC,IAAI,IACX,GAAAC,WAAE,IAAM,CACN,IAAMC,EAAI,OAAO,WAAW,IAAM,CAChCC,EAAE,MAAM,qDAAqD,CAC/D,EAAG,GAAG,EACNC,EAAE,IAAM,CACN,OAAO,aAAaF,CAAC,CACvB,CAAC,CACH,EAAG,CAAC,CAAC,CACP,CACA,IAAMC,GAAI,CACR,gBAAiB,MACjB,mBAAqBD,GAAMA,CAC7B,EFAA,IAAMG,GAAI,CACR,GAAGC,GACH,sBAAuB,GACvB,mBAAoB,EACtB,EACA,SAASC,GAAE,EAAI,CAAC,EAAG,CACjB,MAAO,CACL,SAAU,SACV,GAAGF,GACH,GAAG,CACL,CACF,CACA,SAASG,GAAE,CAAE,OAAQ,EAAG,MAAOC,EAAG,SAAU,CAAE,EAAG,CAC/C,IAAMC,EAAID,GAAA,KAAAA,EAAKE,GAAE,EACjB,OAAOC,GAAE,EAAmBF,EAAEG,GAAG,CAAE,MAAON,GAAE,CAAC,EAAG,SAA0BG,EAAEI,EAAG,CAAE,MAAOJ,EAAG,SAAU,CAAE,CAAC,CAAE,CAAC,CAC7G,CG5BA,IAAMK,GAAI,CACR,GAAGC,GACH,sBAAuB,GACvB,mBAAoB,EACtB,EACA,SAASC,GAAE,EAAG,CACZ,MAAO,CACL,SAAU,WACV,GAAGF,GACH,GAAG,CACL,CACF,CACA,SAASG,GAAE,CAAE,OAAQ,EAAG,MAAOC,EAAG,SAAUC,CAAE,EAAG,CAC/C,IAAMJ,EAAIG,GAAA,KAAAA,EAAKE,GAAE,EACjB,OAAOC,GAAE,EAAmBC,EAAEC,GAAG,CAAE,MAAOP,GAAE,CAAC,EAAG,SAA0BM,EAAEE,EAAG,CAAE,MAAOT,EAAG,SAAUI,CAAE,CAAC,CAAE,CAAC,CAC7G,CChBA,IAAAM,GAAiC,wBAwBjC,IAAMC,GAAI,CACR,GAAGC,GACH,YAAa,EACf,EACA,SAASC,GAAE,EAAG,CACZ,MAAO,CACL,SAAU,eACV,GAAGF,GACH,GAAG,CACL,CACF,CACA,SAASG,GAAE,CAAE,OAAQ,EAAG,MAAOC,EAAG,SAAUC,CAAE,EAAG,CAC/C,IAAMC,EAAIF,GAAA,KAAAA,EAAKG,GAAE,EACjB,OAAOC,GAAE,EAAmBH,EAAEI,GAAG,CAAE,MAAOP,GAAE,CAAC,EAAG,SAA0BG,EAAEK,EAAG,CAAE,MAAOJ,EAAG,SAAUD,CAAE,CAAC,CAAE,CAAC,CAC7G,CCxCA,IAAAM,EAA0B,kBCOnB,SAASC,GAAmBC,EAAmC,CAClE,GAAKA,EAGL,OAAI,OAAOA,GAAa,SACb,CACH,SAAAA,EACA,SAAU,MACd,EAEG,CACH,SAAU,OACV,GAAGA,CACP,CACJ,CCjBO,SAASC,GACZC,EACAC,EACAC,EAGF,CACE,IAAMC,EAAkBC,GAAmBJ,EAAO,mBAAmB,EAC/DK,EAAgBF,GAAmB,SAAS,cAAcA,EAAgB,QAAQ,EAElFG,EAASD,EAAgBA,EAAc,cAAc,MAAM,EAAIJ,EAAO,KAC5E,OAAOM,GAAmBN,EAAQC,EAAW,CAAE,KAAMI,CAAQ,CAAC,CAClE,CChBA,IAAAE,GAA0C,kBAC1CC,GAA2B,wBCC3B,IAAMC,GAAkB,4BASxB,SAASC,GAAQC,EAA2E,CACxF,MAAO,SAAUA,GAAU,OAAOA,EAAO,MAAS,UACtD,CAEA,SAASC,GAAMD,EAAwD,CACnE,MACI,OAAQA,GACR,OAAOA,EAAO,IAAO,YACrB,WAAYA,EAAO,IACnB,OAAOA,EAAO,GAAG,QAAW,UAEpC,CAEA,SAASE,GAAoBF,EAAoF,CAC7G,MAAO,uBAAwBA,GAAU,OAAOA,EAAO,oBAAuB,QAClF,CAEO,SAASG,GAAgBC,EAAkE,CA5BlG,IAAAC,EA6BI,GAAM,CAAE,MAAAC,EAAQ,GAAO,MAAAC,EAAQ,SAAS,MAAO,SAAAC,EAAW,OAAO,SAAS,IAAK,EAAIJ,GAAW,CAAC,EAE/F,GAAIE,EACAG,GAAmBF,EAAOC,CAAQ,MAC/B,CACH,GAAIT,GAAQ,MAAM,EAAG,CACjB,IAAMW,EAAW,OAAO,KAAKR,GAAoB,MAAM,EAAI,OAAO,mBAAqB,CAAC,CAAC,EAAE,OACvFS,GAAKA,EAAE,UAAU,EAAG,CAAC,GAAK,IAC9B,EAEA,GAAID,EAAS,OAAS,EAClB,QAAS,EAAI,EAAG,EAAIA,EAAS,OAAQ,IACjC,OAAO,KAAK,QAAS,YAAa,CAC9B,WAAYH,EACZ,cAAeC,EACf,QAASE,EAAS,CAAC,CACvB,CAAC,OAGL,OAAO,KAAK,QAAS,YAAa,CAC9B,WAAYH,EACZ,cAAeC,CACnB,CAAC,CAET,CACA,GAAIP,GAAM,MAAM,EACZ,GAAI,CACA,IAAMW,EAAM,IAAI,IAAIJ,CAAQ,EACtBK,EAAW,OAAO,GAAI,OAAO,GAC/BA,GAAA,YAAAA,EAAU,QAAS,KACnBR,EAAAQ,EAAS,CAAC,IAAV,MAAAR,EAAa,KAAK,WAAYO,EAAI,SAAWA,EAAI,QAEzD,OAASE,EAAO,CACZC,EAAO,KAAK,gCAAiCD,CAAK,CACtD,CAER,CACJ,CAEA,SAASL,GAAmBF,EAAeC,EAAwB,CAC/D,aAAa,QAAQV,GAAiB,KAAK,UAAU,CAAE,MAAAS,EAAO,SAAAC,CAAS,CAAC,CAAC,CAC7E,CAOA,SAASQ,IAAiC,CACtC,IAAMC,EAAc,aAAa,QAAQnB,EAAe,EACxD,GAAI,OAAOmB,GAAgB,SAAU,CACjC,aAAa,WAAWnB,EAAe,EACvC,GAAI,CAGA,IAAMoB,EAAe,KAAK,MAAMD,CAAW,EAC3Cd,GAAgBe,CAAK,CACzB,OAASP,EAAG,CACRI,EAAO,KAAKJ,CAAC,CACjB,CACJ,CACJ,CAEA,WAAWK,GAA0B,GAAI,EC5FzC,IAAAG,GAA8B,kBAIjBC,MAAU,kBAA2E,IAAM,CAAC,CAAC,EFQnG,SAASC,GAA4BC,EAGzC,CACC,SAAO,MAACC,GAAQ,SAAR,CAAiB,MAAOD,EAAM,UAAWA,EAAM,QAAS,CACpE,CAuEO,SAASE,GAAoBF,EAA8C,CAxFlF,IAAAG,EAAAC,EAAAC,EAAAC,EAAAC,EAyFI,GAAM,CAAE,GAAAC,EAAI,OAAAC,EAAQ,SAAAC,EAAU,YAAAC,EAAa,IAAAC,EAAK,IAAAC,EAAK,QAAAC,EAAS,GAAGC,CAAK,EAAIf,EACpEgB,EAAQC,EAAoBC,GAASA,EAAM,MAAM,KAAK,EACtD,CAAE,eAAAC,EAAgB,SAAAC,CAAS,EAAIC,GAAU,EACzCC,KAAW,eAAWrB,EAAO,EAE7BsB,EAAgB,CAClB,UAAW,EACf,EAEMC,EAAeC,GAA8B,CAC/C,GAAI,CACA,OAAO,IAAI,IACP,GAAGL,GAAY,SAAS,QAAQ,IAAIM,GAAoB,CACpD,CAACP,EAAe,OAAS,OAAO,EAAGM,CACvC,CAAC,CAAC,GACF,OAAO,SAAS,MACpB,EAAE,SAAS,CACf,OAASE,EAAO,CACZC,EAAO,KAAK,6BAA8BD,CAAK,EAC/C,MACJ,CACJ,EAEA,SAASE,GAAc,CAhH3B,IAAA1B,EAAAC,EAAAC,EAAAC,EAAAC,EAiHQ,GAAIP,EAAM,IAAK,CAGX,GAFA8B,EAAQC,IAAOA,GAAI,kBAAkB,eAAgB/B,EAAM,GAAI,CAAC,GAE5DG,EAAAH,EAAM,MAAN,MAAAG,EAAW,QAAS,CACpB,IAAIC,EAAAJ,EAAM,MAAN,MAAAI,EAAW,UAAW,CACtB4B,GAAgB,CACZ,MAAO,GACP,SAAUR,EAAYxB,EAAM,IAAI,OAAO,CAC3C,CAAC,EACD,SAAS,KAAOA,EAAM,IAAI,UAC1B,MACJ,CAEA,OAAOsB,EACH,CACI,OAAOjB,EAAAL,EAAM,MAAN,YAAAK,EAAW,QAClB,GAAIL,EAAM,OACJ,CACI,SAAU,CACN,OAAQ,CAACA,EAAM,MAAM,CACzB,CACJ,EACA,CAAC,CACX,EACAuB,CACJ,CACJ,CACAS,GAAgB,CACZ,MAAO,GACP,SAAUR,EAAYR,CAAK,CAC/B,CAAC,CACL,EAEIV,EAAAN,GAAA,YAAAA,EAAO,MAAP,MAAAM,EAAY,KAAON,GAAA,MAAAA,EAAO,IAC1B,SAAS,KAAQA,EAAM,OAAOO,EAAAP,GAAA,YAAAA,EAAO,MAAP,YAAAO,EAAY,KACnCP,EAAM,OACbsB,EACI,CACI,GAAGtB,EAAM,MACT,GAAIA,EAAM,OACJ,CACI,SAAU,CACN,OAAQ,CAACA,EAAM,MAAM,CACzB,CACJ,EACA,CAAC,CACX,EACAuB,CACJ,CAER,CAEA,OAAIf,KACO,MACHA,EACA,CACI,GAAIA,IAAO,OAAOL,EAAAH,EAAM,MAAN,MAAAG,EAAW,KACvB,CACI,KAAMH,EAAM,IAAI,GACpB,EACA,CAAC,EACP,GAAGe,EACH,QAAUkB,GAAsB,CA/KhD,IAAA9B,EAgLoB,OAAIH,EAAM,KACN8B,EAAQC,GAAOA,EAAI,kBAAkB,eAAgB/B,EAAM,GAAI,CAAC,GAE7DG,EAAAH,EAAM,UAAN,YAAAG,EAAA,KAAAH,EAAgBiC,EAC3B,CACJ,EACAjC,EAAM,QACV,KAIA,MAAC,OACG,MAAO,4BAA2BI,EAAAJ,EAAM,QAAN,KAAAI,EAAe,EAAE,GACnD,qBAAkBC,EAAAL,GAAA,YAAAA,EAAO,MAAP,YAAAK,EAAY,YAAWC,EAAAN,GAAA,YAAAA,EAAO,QAAP,YAAAM,EAAc,OACvD,iBAAgBN,EAAM,OAAOO,EAAAP,GAAA,YAAAA,EAAO,MAAP,YAAAO,EAAY,KACzC,QAAS,IAAM,CACXsB,EAAY,CAChB,EACA,UAAYI,GAAyB,CAC7BA,EAAM,MAAQ,SACdJ,EAAY,CAEpB,EACA,SAAU,GAET7B,EAAM,QACX,CAER,CG5MA,IAAAkC,GAA+C,kBAE/CC,GAA2B,wBAGpB,SAASC,GAAuBC,EAGpC,CACC,SAAO,MAACC,GAAQ,SAAR,CAAiB,MAAOD,EAAM,iBAAkBA,EAAM,QAAS,CAC3E,CAwBO,SAASE,GAAe,CAAE,SAAAC,EAAU,MAAAC,EAAO,MAAOC,CAAU,EAAwB,CACvF,IAAMC,KAAW,eAAWL,EAAO,EAEnC,SACI,MAAC,oBACG,MAAC,OACG,UAAW,2BAA2BI,GAAa,EAAE,GACrD,mBAAkBD,GAAA,YAAAA,EAAO,MACzB,QAAS,IAAM,CACPA,GACAE,EAASF,CAAK,CAEtB,EACA,UAAWG,GAAS,CACZA,EAAM,MAAQ,SAAWH,GACzBE,EAASF,CAAK,CAEtB,EACA,SAAU,GAETD,CACL,CACJ,CAER,CC1DA,IAAAK,GAA+C,kBAC/CC,GAAiC,wBAOlB,SAARC,GAA+B,CAAE,SAAAC,CAAS,EAAoC,CACjF,GAAM,CAACC,CAAK,KAAI,qBAAiB,EAEjC,OAAIA,GACAC,EAAO,MAAM,gCAAiCD,CAAK,KAGhD,MAAC,iBAAUD,CAAS,CAC/B,CChBe,SAARG,GAAkBC,EAAe,CACpC,IAAIC,EAEJ,OAAQC,GAAyB,CACzBD,GACA,aAAaA,CAAS,EAE1BA,EAAY,WAAWC,EAAUF,CAAK,CAC1C,CACJ,CCGO,SAASG,GAAe,CAAE,YAAAC,EAAa,QAAAC,CAAQ,EAAU,CAC5D,MAAO,CAAE,YAAaC,GAAM,EAAIF,GAAe,CAACC,EAAUD,CAAY,CAC1E,CTUA,eAAsBG,GAAiBC,EAAoBC,EAAgC,CACvF,GAAI,CAACD,EAAO,kBAAoBE,GAAe,EAC3C,OAEJ,IAAMC,EAAMC,EAAQ,kBAAkB,EAElCJ,EAAO,iBACP,MAAMK,GAAkBL,EAAO,gBAAiBA,EAAO,eAAe,EAG1E,IAAMM,EAAQC,GAAY,CACtB,SAAU,eACV,MAAOC,GAAaR,EAAQ,mBAAmB,CACnD,CAAC,EAEKS,EAAYC,GAAgBV,EAAO,aAAa,EAEhDW,EAAYC,GAAQZ,EAAO,iBAAkB,gBAAgB,EAC9D,OAAOa,GAAM,CA1CtB,IAAAC,EA0CyB,SAACA,EAAAD,EAAM,OAAN,MAAAC,EAAY,UAAU,SAASC,KAA0B,EAC1E,IAAIF,GAAS,CACV,IAAMG,EAAWC,GAAeJ,EAAOb,CAAM,EACvCkB,EAAUC,GAAcN,EAAOb,CAAM,EAE3C,GAAIA,EAAO,uBAAyBA,EAAO,oBAAqB,CAC5D,IAAMoB,EAAwB,SAAS,cAAc,KAAK,EAC1DA,EAAsB,UAAY,iCAClCP,EAAM,sBAAsB,WAAYO,CAAqB,KAE7D,aACI,KAACC,GAAA,QACG,KAACrB,EAAO,sBAAP,CAA6B,SAAUsB,GAASrB,EAAS,SAAS,CAAE,MAAAqB,CAAM,CAAC,EAAG,CACnF,EACAF,CACJ,CACJ,CAEA,IAAMG,EAAoB,IAAM,CAC5BjB,EAAM,YAAY,CACd,aAAcY,EAAQ,IAAI,CAC9B,CAAC,CACL,EAEAL,EAAM,aAAa,qBAAsB,cAAc,EACvDU,EAAkB,EAElB,IAAMC,EACDC,GACD,CAACH,EAAoBI,IAAkC,CACnDzB,EAAS,SAASqB,EAAOI,CAAO,EAChCD,EAAQ,KAAK,EACTH,EAAM,QACNJ,EAAQ,IAAII,EAAM,KAAK,EACvBC,EAAkB,EAClBV,EAAM,MAAQS,EAAM,MAE5B,EAEEK,EAAqB,MAAOC,GAAkB,CAjFhE,IAAAd,EAAAe,EAkFgBb,EAAS,KAAK,IACAa,GAAAf,EAAAR,EAAM,SAAS,IAAf,YAAAQ,EAAkB,QAAlB,YAAAe,EAAyB,SACzBD,GACV,MAAME,GAAU,CAAE,OAAA9B,EAAQ,MAAAM,CAAM,EAAG,CAAE,MAAOsB,CAAM,CAAC,EAEvDZ,EAAS,KAAK,CAClB,EAEAe,GAA0BlB,CAAK,EAE/B,IAAMmB,EAAOC,GAAUjC,EAAQa,EAAO,CAClC,QAASe,GAAS,CACVA,EAAM,QAAU5B,EAAO,uBACvBgB,EAAS,KAAK,EACdE,EAAQ,KAAK,EACbT,EAAU,SAAY,CAClB,GAAI,CACA,OAAO,MAAMqB,GACT,CAAE,OAAA9B,EAAQ,MAAAM,CAAM,EAChB,CACI,MAAOsB,CACX,CACJ,CACJ,OAASM,EAAK,CACVC,EAAO,MAAM,oBAAqBD,CAAG,EACrC,MACJ,CACJ,CAAC,GACMN,EAAM,SAAW,GAAK5B,EAAO,gBACpCgB,EAAS,KAAK,EACdE,EAAQ,KAAK,IAEbF,EAAS,KAAK,EACdE,EAAQ,KAAK,EAErB,EACA,QAAS,MAAMU,GAAS,CACpB,GAAIA,EAAM,QAAU5B,EAAO,sBAClB4B,GACDtB,EAAM,YAAY,CACd,YAAa,GACb,QAAS,EACb,CAAC,UAEEsB,EAAM,SAAW,GAAK5B,EAAO,gBAAkB,CAACkB,EAAQ,OAAO,EAAG,CACzE,GAAI,CAAClB,EAAO,iBACR,OAEJkB,EAAQ,KAAK,KAEb,aACI,KAACG,GAAA,QACG,KAACe,GAAA,CAAyB,OAAQpC,EAAQ,MAAOM,MAC7C,KAAC+B,GAAc,SAAd,CAAuB,MAAOrC,MAC3B,KAACsC,GAAA,CAAuB,gBAAiBd,EAAmBN,CAAO,MAC/D,KAAClB,EAAO,iBAAP,IAAwB,CAC7B,CACJ,CACJ,CACJ,EACAkB,EAAQ,OACZ,CACJ,CACJ,EACA,QAAS,MAAMU,GAAS,CACpB,GAAIA,EAAM,QAAU5B,EAAO,sBACvB2B,EAAmBC,CAAK,EAEnBA,GACDtB,EAAM,YAAY,CACd,YAAa,GACb,QAAS,EACb,CAAC,UAEEsB,EAAM,SAAW,GAAK5B,EAAO,gBAAkB,CAACkB,EAAQ,OAAO,EAAG,CACzE,GAAI,CAAClB,EAAO,kBAAoB,CAACA,EAAO,eACpC,OAEJkB,EAAQ,KAAK,CACjB,CACJ,EACA,SAAUU,GAAS,CACf,GAAIA,EAAM,QAAU5B,EAAO,sBAAuB,CAC9CgB,EAAS,KAAK,EACdE,EAAQ,KAAK,EACbA,EAAQ,IAAIU,CAAK,EACjBL,EAAkB,EAElB,IAAMgB,EAAcvB,EAAS,iBAAiB,EAC9C,GAAIuB,GAAe,EAAG,CAClBvB,EAAS,sBAAsBuB,CAAW,EAC1C,MACJ,CAEAtC,EAAS,SAAS,CACd,MAAO2B,CACX,CAAC,EAEDZ,EAAS,KAAK,CAClB,CACJ,EACA,UAAW,CAACwB,EAAQC,IAAQ,CACxB,GAAID,EAAO,QAAUxC,EAAO,sBAAuB,CAC/C,GAAIgB,EAAS,OAAO,GAChB,GAAIyB,IAAQ,YACRzB,EAAS,OAAO,UACTyB,IAAQ,UACfzB,EAAS,KAAK,UACPyB,IAAQ,QAAS,CACxB,IAAMF,EAAcvB,EAAS,iBAAiB,EAC9C,GAAIuB,GAAe,EAAG,CAClBvB,EAAS,sBAAsBuB,CAAW,EAC1C,MACJ,CACAvB,EAAS,KAAK,CAClB,EAGAyB,IAAQ,SACRzB,EAAS,KAAK,EACPyB,IAAQ,cACfzB,EAAS,KAAK,EACdE,EAAQ,KAAK,EAErB,CAEA,GAAIsB,EAAO,SAAW,GAAKxC,EAAO,gBAQ9B,GAPIkB,EAAQ,OAAO,IACXuB,IAAQ,YACRvB,EAAQ,OAAO,EACRuB,IAAQ,WACfvB,EAAQ,KAAK,GAGjBuB,IAAQ,SACRvB,EAAQ,KAAK,UACNuB,IAAQ,YACfvB,EAAQ,KAAK,UACNuB,IAAQ,QAAS,CACxB,IAAMF,EAAcrB,EAAQ,iBAAiB,EAC7C,GAAIqB,GAAe,EAAG,CAClBrB,EAAQ,sBAAsBqB,CAAW,EACzC,MACJ,CACArB,EAAQ,KAAK,CACjB,EAER,CACJ,CAAC,EAEDZ,EAAM,SAASoC,GAAgB,CAAC,CAAE,YAAAC,CAAY,IAAM,CAChD,GAAI,CAACA,GAAe,CAAC3C,EAAO,sBACxB,OAGJ,IAAMG,EAAMC,EAAQ,oBAAoB,KAExC,aACI,KAACiB,GAAA,QACG,KAACe,GAAA,CAAyB,OAAQpC,EAAQ,MAAOM,MAC7C,KAAC+B,GAAc,SAAd,CAAuB,MAAOrC,MAC3B,KAAC4C,GAAA,CAA4B,SAAUpB,EAAmBR,CAAQ,MAC9D,KAAChB,EAAO,sBAAP,IAA6B,CAClC,CACJ,CACJ,CACJ,EACAgB,EAAS,OACb,EACAb,EAAI,CACR,CAAC,EAED,IAAM0C,EAAkBC,GAAiB,CAAC9B,EAAS,QAASH,CAAK,EAAG,IAAM,CACtEG,EAAS,KAAK,CAClB,CAAC,EAEK+B,EAAiBD,GAAiB,CAAC5B,EAAQ,QAASL,CAAK,EAAG,IAAM,CACpEK,EAAQ,KAAK,CACjB,CAAC,EAED,MAAO,CACH,SAAU,CACNc,EAAK,QAAQ,EACbhB,EAAS,QAAQ,EACjBE,EAAQ,QAAQ,EAChB2B,EAAgB,QAAQ,EACxBE,EAAe,QAAQ,CAC3B,CACJ,CACJ,CAAC,EAEL,OAAA5C,EAAI,EAEG,CACH,QAAS,IAAM,CACXQ,EAAU,QAAQqC,GAAK,CACnBA,EAAE,QAAQ,CACd,CAAC,CACL,CACJ,CACJ,CAEA,SAASC,GAAepC,EAAyBG,EAA0BhB,EAAoB,CA5R/F,IAAAc,EA6RI,IAAMoC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,6BAEpBlC,EAAS,MAAM,QAAU,QAEzBF,EAAAD,EAAM,aAAN,MAAAC,EAAkB,aAAaoC,EAASrC,EAAM,aAC9CqC,EAAQ,YAAYrC,CAAK,EAEzB,IAAMsC,EAAkBC,GAAmBpD,EAAO,mBAAmB,EAC/DqD,EAAiBF,GAAmB,SAAS,cAAcA,EAAgB,QAAQ,EAEzF,GAAIE,EAAgB,CAChB,IAAMC,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,UAAY,sBACjBA,EAAK,YAAYtC,CAAQ,EACrBmC,EAAgB,WAAa,QAC7BE,EAAe,QAAQC,CAAI,EAE3BD,EAAe,YAAYC,CAAI,CAEvC,MACIJ,EAAQ,YAAYlC,CAAQ,EAGhC,IAAMuC,EAAmB,CAACC,EAAwBC,IAA2B,CArTjF,IAAA3C,EAAAe,GAsTQf,EAAAE,EACK,cAAc,0DAA0D,IAD7E,MAAAF,EAEM,UAAU,OAAO,oCACvBe,EAAA2B,EAAYC,CAAc,IAA1B,MAAA5B,EAA6B,UAAU,IAAI,kCAC/C,EAEM6B,EAAqBC,GAAsC,CAC7D,IAAMC,EAAW,MAAM,KAAK5C,EAAS,uBAAuB,yBAAyB,CAAC,EAEhFuB,EAAcqB,EAAS,KAAKC,GAC1BA,EAAK,UAAU,SAAS,iCAAiC,GACrDF,GACAE,EAAK,UAAU,OAAO,iCAAiC,EAEpD,IAEJ,EACV,EAED,OAAOtB,EAAcqB,EAAS,QAAQrB,CAAW,EAAI,EACzD,EACA,MAAO,CACH,QAASvB,EACT,KAAM,IAAM,CACRA,EAAS,MAAM,QAAU,MAC7B,EACA,KAAM,IAAM,CACRA,EAAS,MAAM,QAAU,EAC7B,EACA,QAAS,IAAM,CAnVvB,IAAAF,GAoVYA,EAAAoC,EAAQ,gBAAR,MAAApC,EAAuB,YAAYoC,EACvC,EACA,OAAQ,IAAMlC,EAAS,MAAM,UAAY,OACzC,OAAQ,IAAM,CACV,IAAM4C,EAAW,MAAM,KAAK5C,EAAS,uBAAuB,yBAAyB,CAAC,EAChF8C,EAAQJ,EAAkB,EAAI,EACpCH,EAAiBK,EAAUE,GAAS,EAAIA,EAAQ,EAAI,CAAC,CACzD,EACA,KAAM,IAAM,CACR,IAAMF,EAAW,MAAM,KAAK5C,EAAS,uBAAuB,yBAAyB,CAAC,EAChF8C,EAAQJ,EAAkB,EAAI,EACpCH,EAAiBK,GAAWE,GAAS,EAAIA,EAAQF,EAAS,QAAU,CAAC,CACzE,EACA,UAAWL,EACX,iBAAkBG,EAClB,sBAAwBK,GAA6B,CAnW7D,IAAAjD,EAAAe,EAoWY,IAAM+B,EAAW,MAAM,KAAK5C,EAAS,iBAA8B,0BAA0B,CAAC,GAC9FF,EAAA8C,EAASG,CAAgB,IAAzB,MAAAjD,EAA4B,QAC5B,IAAMc,GAAQC,EAAA+B,EAASG,CAAgB,IAAzB,YAAAlC,EAA4B,aAAa,oBACnDD,IACAf,EAAM,MAAQe,EAEtB,CACJ,CACJ,CAEA,SAASX,GAAeJ,EAAyBb,EAAoB,CACjE,IAAMgB,EAAW,SAAS,cAAc,KAAK,EAG7C,MAAO,CACH,GAHSiC,GAAepC,EAAOG,EAAUhB,CAAM,EAI/C,QAASgB,CACb,CACJ,CAEA,IAAMgD,GAAa,iCAEnB,SAAS7C,GAAcN,EAAyBb,EAAoB,CAChE,IAAMgB,EAAW,SAAS,cAAc,KAAK,EAG7C,MAAO,CACH,GAHSiC,GAAepC,EAAOG,EAAUhB,CAAM,EAI/C,QAASgB,EACT,IAAMY,GAAkB,CAEpB,IAAMqC,GADWC,GAA8BF,EAAU,GAAK,CAAC,GAChC,OAAOhB,GAAKA,IAAMpB,CAAK,EAAE,MAAM5B,EAAO,YAAc,CAACA,EAAO,YAAc,CAAC,EAC1GiE,EAAc,KAAKrC,CAAK,EACxBuC,GAAoBH,GAAYC,CAAa,CACjD,EACA,IAAK,IAAM,CACP,IAAMG,EAA0BF,GAA8BF,EAAU,GAAK,CAAC,EAK9E,OAJqBI,EACfA,EAAwB,QAAQ,EAAE,OAAQC,GAAc,CAAC,CAACA,CAAC,EAC3D,MAGV,CACJ,CACJ,CU7Ye,SAARC,GAA0C,CAAE,SAAAC,EAAU,GAAGC,CAAK,EAA6B,CAC9F,MAAO,CACH,GAAGA,EACH,SAAU,CACN,GAAGD,EACH,GAAIA,GAAA,MAAAA,EAAU,KAAO,CAAE,KAAME,EAAYF,EAAS,IAAI,CAAE,EAAI,CAAC,EAC7D,GAAIA,GAAA,MAAAA,EAAU,KAAO,CAAE,KAAME,EAAYF,EAAS,IAAI,CAAE,EAAI,CAAC,CACjE,CACJ,CACJ,CCZA,IAAAG,EAAyC,kBC8BzC,eAAsBC,GAAe,CAAE,SAAAC,EAAU,QAAAC,EAAU,GAAI,EAA0C,CAErG,OADiB,MAAMC,GAAgB,CAAE,SAAAF,EAAU,QAAAC,CAAQ,CAAC,GAC5C,CAAC,CACrB,CAMO,SAASC,GAAgB,CAAE,SAAAF,EAAU,QAAAC,EAAU,GAAI,EAAqC,CAC3F,OAAO,IAAI,QAAQ,CAACE,EAASC,IAAW,CACpC,IAAMC,EAAWC,GAAQN,CAAQ,EACjC,GAAIK,EAAS,OAAS,EAClB,OAAOF,EAAQE,CAAQ,EAG3B,IAAME,EAAW,IAAI,iBAAiB,IAAM,CACxC,IAAMF,EAAWC,GAAQN,CAAQ,EAC7BK,EAAS,OAAS,IAClBE,EAAS,WAAW,EACpB,aAAaC,CAAK,EAClBL,EAAQE,CAAQ,EAExB,CAAC,EAEKG,EAAQ,WAAW,IAAM,CAC3BD,EAAS,WAAW,EACpBE,EAAO,KAAK,cAAcR,CAAO,+BAA+BD,CAAQ,EAAE,EAC1EG,EAAQ,CAAC,CAAC,CACd,EAAGF,CAAO,EAEVM,EAAS,QAAQ,SAAS,KAAM,CAC5B,UAAW,GACX,QAAS,EACb,CAAC,CACL,CAAC,CACL,CDxDA,eAAsBG,GAClBC,EACAC,EACA,CACI,YAAAC,EACA,aAAAC,CACJ,EAIa,CACb,GAAI,CAACD,GAAe,CAACC,EACjB,OAGJ,IAAMC,EAAU,MAAMC,GAAgB,CAClC,SAAUH,EACV,QAAS,GACb,CAAC,EAEKI,EAASF,EAAQ,CAAC,EAExB,GAAI,CAACE,EAAQ,CACTC,EAAO,KAAK,2BAA2BL,CAAW,qCAAqC,EACvF,MACJ,CAEIE,EAAQ,OAAS,GACjBG,EAAO,KACH,wCAAwCL,CAAW,kDACvD,EAGAF,EAAO,iBACP,MAAMA,EAAO,gBAAgB,EAGjCQ,GAAqBF,CAAM,EAC3B,IAAMG,EAAMC,EAAQ,cAAc,EAE5BC,EAAWV,EAAM,SAAS,EAAE,SAC5BW,EAAc,CAChB,MAAAX,EACA,OAAAD,EACA,OAAAM,EACA,kBAAmBH,CACvB,EAEA,GAAIQ,IAAa,SACbE,GAAoBD,CAAW,UACxBD,IAAa,WACpBG,GAAwBF,CAAW,MAEnC,OAAM,IAAI,MAAM,0BAA0BD,CAAQ,EAAE,EAGxDF,EAAI,CACR,CASA,SAASI,GAAoB,CAAE,MAAAZ,EAAO,OAAAD,EAAQ,OAAAM,EAAQ,kBAAAS,CAAkB,EAAgB,IACpF,aACI,KAACC,GAAA,QACG,KAACC,GAAA,CAAmB,MAAOhB,EAAO,OAAQD,MACtC,KAACkB,GAAc,SAAd,CAAuB,MAAOlB,MAC3B,KAACe,EAAA,IAAkB,CACvB,CACJ,CACJ,EACAT,CACJ,CACJ,CAEA,SAASQ,GAAwB,CAAE,MAAAb,EAAO,OAAAD,EAAQ,OAAAM,EAAQ,kBAAAS,CAAkB,EAAgB,IACxF,aACI,KAACC,GAAA,QACG,KAACG,GAAA,CAAqB,MAAOlB,EAAO,OAAQD,MACxC,KAACkB,GAAc,SAAd,CAAuB,MAAOlB,MAC3B,KAACe,EAAA,IAAkB,CACvB,CACJ,CACJ,EACAT,CACJ,CACJ,CE9EA,eAAsBc,GAASC,EAAoBC,EAA6B,CAC5E,IAAMC,EAAMC,EAAQ,UAAU,EAC9BC,GAAoBJ,EAAO,kBAAkB,EAC7CI,GAAoBJ,EAAO,mBAAmB,EAE9CC,EAAM,SAASI,GAAgB,CAAC,CAAE,YAAAC,CAAY,IAAM,CAC3CA,IAIDL,EAAM,SAAS,EAAE,WAAa,WAC9BM,GAAgBP,EAAQC,EAAO,CAC3B,YAAaD,EAAO,oBACpB,aAAcA,EAAO,iBACzB,CAAC,EAEDO,GAAgBP,EAAQC,EAAO,CAC3B,YAAaD,EAAO,mBACpB,aAAcA,EAAO,aACzB,CAAC,EAGDA,EAAO,oBACPQ,GAAmB,EAE3B,CAAC,EAEDP,EAAM,SACF,CAAC,CAAE,MAAAQ,EAAO,aAAAC,CAAa,KAAO,CAAE,MAAAD,EAAO,aAAAC,CAAa,GACpD,CAAC,CAAE,MAAAD,EAAO,aAAAC,CAAa,IAAM,CACzBC,GAAeC,GAAa,CAAE,OAAAZ,EAAQ,MAAAC,CAAM,EAAGQ,EAAO,CAAE,aAAAC,CAAa,CAAC,CAAC,EACvEG,GAAgB,CACpB,CACJ,EAEAC,GAAqBd,EAAQC,CAAK,EAClCc,GAAmB,IAAM,CACrBD,GAAqBd,EAAQC,CAAK,CACtC,CAAC,EAEDC,EAAI,CACR,CAEO,SAASc,GAAehB,EAAoBC,EAAc,CAjEjE,IAAAgB,EAAAC,EAAAC,EAAAC,EAkEI,IAAMC,EAAeC,GAAaC,GAAoB,SAAS,MAAM,CAAC,EAChEC,EAAiB,OAAO,OAAOxB,EAAO,cAAc,EACpDyB,EAA4BC,GAAYL,EAAcrB,EAAO,cAAc,GAAK,CAAC,EACnFyB,EAAa,UAAY,CAACA,EAAa,SAAS,OAEhDA,EAAa,SAAS,MAAOP,GAAAD,EAAAhB,EAAM,gBAAgB,EAAE,QAAxB,YAAAgB,EAA+B,WAA/B,YAAAC,EAAyC,MAE1E,IAAMS,EAAsB,OAAO,QAAQN,CAAY,EAAE,OAAgC,CAACO,EAAMC,KACvFL,EAAe,SAASK,EAAI,CAAC,CAAC,IAC/BD,EAAKC,EAAI,CAAC,CAAC,EAAIA,EAAI,CAAC,GAEjBD,GACR,CAAC,CAAC,EAECE,EAAgBC,GAAoB/B,CAAM,EAC1CgC,EAAUC,GACZ,IAAIb,GAAAD,EAAAnB,EAAO,oBAAP,YAAAmB,EAA0B,IAAIe,GAEtBzB,GAAmByB,EAAE,OAAOzB,EAAOqB,CAAa,KAFxD,KAAAV,EAGE,CAAC,CACX,EAGMe,EAA4BF,GAAKD,EAASI,EAAwB,EAAEX,CAAY,EAChFhB,EAAQ4B,EAAUpC,EAAM,gBAAgB,EAAE,MAAOkC,CAAY,EAE7DzB,EAAwCsB,EAAQL,CAAmB,EAEzE,MAAO,CAAE,MAAAlB,EAAO,aAAAC,CAAa,CACjC,CAEA,SAASI,GAAqBd,EAAoBC,EAAoB,CAjGtE,IAAAgB,EAkGI,GAAM,CAAE,MAAAR,EAAO,aAAAC,CAAa,EAAIM,GAAehB,EAAQC,CAAK,EACtDqC,GAAU,CAACtC,EAAO,UAAY,SAAS,WAAaA,EAAO,WAAa,CAAC,EAACS,GAAA,MAAAA,EAAO,OACjF8B,GAAatB,EAAAjB,EAAO,iBAAP,YAAAiB,EAAA,KAAAjB,GAEnB,GACKsC,GAAUrC,EAAM,SAAS,EAAE,WAAa,UACxCsC,GAActC,EAAM,SAAS,EAAE,WAAa,WAC/C,CACE,GAAID,EAAO,UAAYwC,GAAe,EAAG,CACrCC,GAAezC,EAAQS,CAAK,EAC5B,MACJ,CAEAiC,GAAU,CAAE,OAAA1C,EAAQ,MAAAC,CAAM,EAAGQ,EAAO,CAAE,aAAAC,CAAa,CAAC,EACpD,MACJ,CAEIT,EAAM,SAAS,EAAE,aACjB,SAAS,OAAO,CAExB,CCtHe,SAAR0C,GAA+BC,EAA0D,CAC5F,OAAO,OAAO,QAAQA,CAAO,EAAE,OAAgC,CAACC,EAAiB,CAACC,EAAKC,CAAK,IAAM,CAC9F,IAAMC,EAAaF,EAAI,MAAM,GAAG,EAC5BG,EAAeJ,EAEnB,QAASK,EAAI,EAAGA,EAAIF,EAAW,OAAS,EAAGE,IAAK,CAC5C,IAAMC,EAAYH,EAAWE,CAAC,EACzBD,EAAaE,CAAS,IACvBF,EAAaE,CAAS,EAAI,CAAC,GAG/BF,EAAeA,EAAaE,CAAS,CACzC,CAEA,IAAMC,EAAUJ,EAAWA,EAAW,OAAS,CAAC,EAChD,OAAAC,EAAaG,CAAO,EAAIL,EAEjBF,CACX,EAAG,CAAC,CAAC,CACT,CCnBe,SAARQ,GAAgCC,EAAwCC,EAAS,GAA4B,CAChH,IAAMC,EAAiC,CAAC,EAExC,cAAO,QAAQF,CAAa,EAAE,QAAQ,CAAC,CAACG,EAAKC,CAAK,IAAM,CACpD,IAAMC,EAAYJ,EAAS,GAAGA,CAAM,IAAIE,CAAG,GAAKA,EAE5C,OAAOC,GAAU,UAAYA,IAAU,KAEvC,OAAO,OAAOF,EAAQH,GAAeK,EAAOC,CAAS,CAAC,EAGtDH,EAAOG,CAAS,EAAID,CAE5B,CAAC,EAEMF,CACX,CCVe,SAARI,GAAuC,CAC1C,OAAAC,EACA,OAAAC,CACJ,EAGG,CACC,MAAO,CACH,OAAoCC,EAAUC,EAAwB,CAClE,OAAOD,EAAM,SAAW,CAAE,GAAGA,EAAO,SAAUF,EAAOE,EAAM,SAAUC,CAAO,CAAE,EAAID,CACtF,EACA,OAAqCA,EAAUC,EAAwB,CACnE,OAAOD,EAAM,SAAW,CAAE,GAAGA,EAAO,SAAUD,EAAOC,EAAM,SAAUC,CAAO,CAAE,EAAID,CACtF,CACJ,CACJ,CCrBO,SAASE,GAAYC,EAAeC,EAA2B,CAClE,OAAOD,EAAM,QAAQ,OAAQC,CAAS,CAC1C,CAEO,SAASC,GAAYF,EAAeC,EAA2B,CAElE,IAAME,EAAQ,IAAI,OAAO,KAAKF,CAAS,GAAI,GAAG,EAC9C,OAAOD,EAAM,QAAQG,EAAO,KAAK,CACrC,CCJA,SAASC,GAAWC,EAAcC,EAA2C,CACzE,GAAM,CAACC,EAAKC,CAAG,EAAIH,EAAK,MAAMC,CAAS,EACjCG,EAAgC,CAAC,EACvC,OAAID,IACAC,EAAMD,EAAI,SAAS,GAAG,EAAI,KAAO,KAAK,EAAIE,GAAYF,EAAI,QAAQ,aAAc,EAAE,EAAGF,CAAS,GAE9FC,IACAE,EAAMF,EAAI,SAAS,GAAG,EAAI,KAAO,KAAK,EAAIG,GAAYH,EAAI,QAAQ,aAAc,EAAE,EAAGD,CAAS,GAE3FG,CACX,CAEA,IAAME,GAAkB,CACpB,OAAOC,EAA6B,CAChC,OAAOA,EAAU,MAAM,IAAI,EAAE,IAAIC,GAASH,GAAYG,EAAO,GAAG,CAAC,CACrE,EACA,OAAOC,EAA2B,CAC9B,OAAOA,EAAQ,IAAID,GAASE,GAAYF,EAAO,GAAG,CAAC,EAAE,KAAK,IAAI,CAClE,CACJ,EAEMG,GAAiB,CACnB,OAAOC,EAAkBX,EAA6C,CAClE,OAAOW,EAAS,MAAM,GAAG,EAAE,IAAIZ,GAAQD,GAAWC,EAAMC,CAAS,CAAC,CACtE,EACA,OAAOY,EAAqCC,EAAgC,CACxE,OAAOD,EACF,IAAIE,GAAQ,CACT,IAAMC,EAAMD,EAAK,MAAQA,EAAK,GAAK,IAAIA,EAAK,EAAE,GAAK,IAC7CE,EAAMF,EAAK,MAAQA,EAAK,GAAK,GAAGA,EAAK,EAAE,IAAM,IACnD,MAAO,CAACC,EAAKC,CAAG,EACX,IAAIT,GAASE,GAAYF,EAAOM,EAAQ,oBAAoB,CAAC,EAC7D,KAAKA,EAAQ,oBAAoB,CAC1C,CAAC,EACA,KAAK,GAAG,CACjB,CACJ,EAEOI,GAAQ,CACX,OAAOC,EAAeX,EAAeM,EAA2C,CAC5E,GAAIN,EAAM,SAAS,IAAI,EAAG,CACtB,IAAMY,EAAe,mBAAmBZ,CAAK,EAC7C,MAAO,CAAE,MAAAW,EAAO,MAAOR,GAAe,OAAOS,EAAc,IAAI,CAAE,CACrE,SAAWZ,EAAM,SAASM,EAAQ,oBAAoB,EAClD,MAAO,CAAE,MAAAK,EAAO,MAAOR,GAAe,OAAOH,EAAOM,EAAQ,oBAAoB,CAAE,EAEtF,MAAO,CAAE,MAAAK,EAAO,MAAOb,GAAgB,OAAOE,CAAK,CAAE,CACzD,EACA,OAAO,CAAE,MAAAW,EAAO,MAAAf,EAAO,MAAAI,CAAM,EAAsBM,EAAwB,CACvE,OAAIV,EACO,CAAE,CAACe,CAAM,EAAGR,GAAe,OAAOP,EAAOU,CAAO,CAAE,EAClDN,EACA,CAAE,CAACW,CAAM,EAAGb,GAAgB,OAAOE,CAAK,CAAE,EAE9C,CAAC,CACZ,CACJ,EC3CA,IAAOa,GAAQC,GAA0E,CACrF,OAAO,CAAE,OAAAC,EAAQ,GAAGC,CAAK,EAAGC,EAAS,CACjC,GAAI,CAACF,EAAQ,OAAOC,EACpB,IAAME,EAAmBH,EAAO,OAA+B,CAACI,EAAKC,KAC1D,CAAE,GAAGD,EAAK,GAAGE,GAAe,OAAOD,EAAaH,CAAO,CAAE,GACjE,CAAC,CAAC,EACCK,EAAiBC,GAAcL,CAAgB,EACrD,MAAO,CAAE,GAAGF,EAAM,OAAQM,CAAe,CAC7C,EACA,OAAO,CAAE,OAAAP,EAAQ,GAAGC,CAAK,EAAGC,EAAS,CACjC,GAAI,CAACF,EAAQ,OAAOC,EACpB,IAAMQ,EAAmBC,GAAeV,CAAM,EACxCW,EAAiB,OAAO,QAAQF,CAAgB,EAAE,IAAI,CAAC,CAACG,EAAOC,CAAK,IACtEP,GAAe,OAAOM,EAAOC,EAAOX,CAAO,CAC/C,EACA,MAAO,CAAE,GAAGD,EAAM,OAAQU,CAAe,CAC7C,CACJ,CAAC,ECrBD,IAAOG,GAAQC,GAA8D,CACzE,OAAO,CAAE,KAAAC,EAAM,GAAGC,CAAK,EAAG,CACtB,GAAI,CAACD,EAAM,OAAOC,EAClB,IAAMC,EAAaF,EAAK,IAAI,CAAC,CAAE,MAAAG,EAAO,MAAAC,CAAM,IAAM,GAAGD,CAAK,IAAIC,CAAK,EAAE,EAAE,KAAK,GAAG,EAC/E,MAAO,CAAE,GAAGH,EAAM,KAAMC,CAAW,CACvC,EACA,OAAO,CAAE,KAAAF,EAAM,GAAGC,CAAK,EAAG,CACtB,GAAI,CAACD,EAAM,OAAOC,EAClB,GAAI,OAAOD,GAAS,SAAU,CAC1B,IAAMK,EAAW,OAAO,QAAQL,CAAI,EAAE,IAAI,CAAC,CAACG,EAAOC,CAAK,KAAO,CAC3D,MAAAD,EACA,MAAAC,CACJ,EAAE,EACF,MAAO,CAAE,GAAGH,EAAM,KAAMI,CAAS,CACrC,CACA,IAAMA,EAAWL,EACZ,MAAM,GAAG,EACT,OAAO,OAAO,EACd,IAAIM,GAAKA,EAAE,MAAM,GAAG,CAAC,EACrB,IAAI,CAAC,CAACH,EAAOC,CAAK,KAAO,CAAE,MAAAD,EAAO,MAAAC,CAAM,EAAE,EAC/C,MAAO,CAAE,GAAGH,EAAM,KAAMI,CAAS,CACrC,CACJ,CAAC,ECtBD,IAAOE,GAAQC,GAAiF,CAC5F,OAAO,CAAE,KAAAC,EAAO,EAAG,KAAAC,EAAM,GAAGC,CAAK,EAAG,CAChC,GAAI,CAACD,EAAM,OAAOC,EAClB,IAAMC,EAAO,KAAK,MAAMH,EAAOC,CAAI,EAAI,EACvC,MAAO,CAAE,GAAGC,EAAM,KAAAC,EAAM,KAAAF,CAAK,CACjC,EACA,OAAO,CAAE,KAAAE,EAAO,EAAG,KAAAF,EAAM,GAAGC,CAAK,EAAG,CAChC,GAAI,CAACD,EAAM,OAAOC,EAClB,IAAMF,GAAQG,EAAO,GAAKF,EAC1B,MAAO,CAAE,GAAGC,EAAM,KAAAF,EAAM,KAAAC,CAAK,CACjC,CACJ,CAAC,ECjBD,SAASG,GAAOC,EAAoBC,EAAwB,CACxD,IAAMC,EAAKC,GAAgB,OAAOH,EAAOC,CAAO,EAC1CG,EAAKC,GAAuB,OAAOH,EAAID,CAAO,EACpD,OAAOK,GAAyB,OAAOF,EAAIH,CAAO,CACtD,CAEA,SAASM,GAAOP,EAAqBC,EAAwB,CACzD,IAAMC,EAAKC,GAAgB,OAAOH,EAAOC,CAAO,EAC1CG,EAAKC,GAAuB,OAAOH,EAAID,CAAO,EACpD,OAAOK,GAAyB,OAAOF,EAAIH,CAAO,CACtD,CAKA,IAAOO,GAAQ,CACX,OAAAT,GACA,OAAAQ,EACJ,EChBO,SAASE,GAAWC,EAAqC,CAC5D,IAAMC,EAAaC,EAAUC,GAAeH,CAAM,EAElD,OAAIC,EAAW,uBAAyB,CAACA,EAAW,oBAChDA,EAAW,kBAAoB,CAACG,EAAc,GAGlDH,EAAW,eAAiB,CAACI,EAASC,IAAY,CAhBtD,IAAAC,EAiBQ,GAAIP,EAAO,UAAYQ,GAAe,EAClC,MAAM,IAAI,MAAM,8BAA8B,EAElD,IAAMC,EAAQJ,EAAQ,MAChBK,EAAgBJ,EACtBG,EAAM,YAAY,CACd,cAAcF,EAAAG,EAAc,eAAd,KAAAH,EAA8B,CAAC,CACjD,CAAC,CACL,EAEAN,EAAW,cAAgB,CAACU,EAAOC,EAAOC,EAAGC,IAAa,CAClDd,EAAO,UAAYc,IAAa,iBAC5BC,GAAeJ,CAAK,EACpBK,GAAef,EAAYW,CAAK,EAEhCK,EAAO,KAAK,+BAAgCN,CAAK,EAG7D,EAEAV,EAAW,OAAS,CAChB,cAAeA,EAAW,cAC1B,WAAYA,EAAW,QACvB,cAAeA,EAAW,aAC9B,EAEOA,CACX,CCTA,eAAsBiB,GAAKC,EAA+B,CACtD,IAAMC,EAAMC,EAAQ,MAAM,EACpBC,EAAaC,GAAWJ,CAAM,EAC9BK,EAAM,MAAM,IAAI,QAAQC,CAAO,EAC/B,CAAE,cAAAC,EAAe,kBAAAC,CAAkB,EAAIH,EAAI,SAAS,YAAY,EAEhEI,EAAeF,GAAiBJ,EAAW,mBAC3CO,EAAqBH,GAAiBJ,EAAW,iBACjDQ,EAAmBH,GAAqBL,EAAW,oBAEzD,GAAIM,GAAgBC,EAAoB,CACpCE,GAA4BT,CAAU,EACtC,IAAMU,EAAYC,GAAY,CAC1B,MAAOC,GAAaZ,EAAY,WAAW,EAC3C,SAAU,QACd,CAAC,EACGM,GACAO,GAASb,EAAYU,CAAS,EAE9BH,GACAO,GAAiBd,EAAY,CACzB,SAAU,CAACe,EAAOC,IAAY,CACtBD,EAAM,OACNZ,EAAQD,GAAOA,EAAI,mBAAmBa,EAAM,KAAM,CAAC,EAEnDf,EAAW,kBAAqBA,EAAW,UAAYiB,GAAe,EAClE,OAAOjB,EAAW,kBAAqB,WACvCA,EAAW,iBAAiBe,EAAOC,CAAO,EAE1C,SAAS,KAAOE,GAAWC,GAAa,CAAE,OAAQnB,EAAY,MAAOU,CAAU,EAAGK,CAAK,CAAC,EAG5FK,GAAU,CAAE,OAAQpB,EAAY,MAAOU,CAAU,EAAGK,EAAOC,CAAO,CAE1E,CACJ,CAAC,CAET,CAEA,GAAIR,IAEA,MAAMa,GAAS,EAEXrB,EAAW,eAAe,GAAG,CAC7B,IAAMsB,EAAgBX,GAAY,CAC9B,MAAOC,GAAaZ,EAAY,eAAe,EAC/C,SAAU,UACd,CAAC,EACDa,GAASb,EAAYsB,CAAa,CACtC,CAEJxB,EAAI,CACR,CCvFA,IAAAyB,GAAqC,kBAsB9B,SAASC,GAAkB,CAAE,SAAAC,EAAU,SAAAC,CAAS,EAA2B,CAC9E,SACI,MAAC,QAAK,MAAM,gBACPD,GAAA,MAAAA,EAAU,SACP,MAAC,YACIC,EAAU,OACX,MAAC,QAAK,MAAM,0BAAyB,SAC9B,MAAC,YAAMD,EAAS,KAAM,CAC7B,CACJ,EAEAC,CAER,CAER,CCrCA,IAAAC,EAA2C,kBCA3C,IAAAC,GAAgD,kBCAhD,IAAAC,GAA8D,kBAgBvD,SAASC,GAAe,CAAE,SAAAC,EAAU,OAAAC,EAAQ,iBAAkBC,CAAQ,EAAwB,CACjG,OAAOA,KAAU,MAACA,EAAA,CAAQ,iBAAkBF,EAAU,OAAQC,EAAQ,KAAK,MAAC,iBAAUD,CAAS,CACnG,CDwCO,SAASG,GAAmB,CAC/B,cAAAC,EACA,iBAAAC,EACA,IAAAC,EACA,iBAAAC,EACA,2BAA4BC,EAA6BC,GACzD,wBAAAC,EAA0B,CAC9B,EAA4B,CAjE5B,IAAAC,EAAAC,EAkEI,IAAMC,GAAQF,EAAAL,EAAI,SAAJ,YAAAK,EAAY,KAAMG,GAA6B,SAAUA,GAAKA,EAAE,QAAUV,GAExF,OAAIQ,EAAAC,GAAA,YAAAA,EAAO,OAAP,MAAAD,EAAa,UAET,0BACI,MAACG,GAAA,CAAe,iBAAkBV,GAAmBE,CAAiB,EACrEM,EAAM,KAAK,MAAM,EAAGH,CAAuB,EAAE,IAAI,CAACM,EAAUC,IAAU,CAxEvF,IAAAN,EAyEoB,SACI,MAACI,GAAA,CACG,iBAAkBV,EAClB,KAAKM,EAAAK,EAAS,QAAT,KAAAL,EAAkBM,EACvB,OAAQ,CACJ,MAAO,CAACD,EAAS,KAAK,EACtB,MAAOZ,CACX,MAEA,MAACI,EAAA,CAA2B,SAAUQ,GACjCT,CACL,CACJ,CAER,CAAC,CACL,KAID,MAACQ,GAAA,CAAe,iBAAkBV,GAAmBE,CAAiB,CACjF,CDhCO,SAASW,GAAS,CACrB,KAAAC,EACA,iBAAkBC,EAClB,iBAAkBC,EAClB,2BAAAC,EAA6BC,GAC7B,mBAAAC,EAAqB,GACrB,wBAAAC,EAA0B,CAC9B,EAAkB,CApElB,IAAAC,EAAAC,EAAAC,EAqEI,GAAM,CAACC,EAAc,GAAGC,CAAY,EAAIX,GAAA,KAAAA,EAAQ,CAAC,EAE3CY,GAAgBH,GAAAD,GAAAD,EAAAP,GAAA,YAAAA,EAChB,KAAKa,GAAI,CAxEnB,IAAAN,EAyEY,OAAAA,EAAAM,GAAA,YAAAA,EAAK,SAAL,YAAAN,EAAa,KAAMO,GAAkC,CAzEjE,IAAAP,EAyEoE,eAAUO,KAASP,EAAAO,GAAA,YAAAA,EAAO,OAAP,YAAAP,EAAa,QAAS,QAFnF,YAAAA,EAIhB,SAJgB,YAAAC,EAIR,KAAMM,GAAkC,CA3E1D,IAAAP,EA2E6D,eAAUO,KAASP,EAAAO,GAAA,YAAAA,EAAO,OAAP,YAAAP,EAAa,QAAS,MAJ5E,YAAAE,EAIgF,MAEtG,OAAIG,GAAiBF,GAAgBL,KAE7B,KAAC,mBACG,KAACU,GAAA,CACG,IAAKL,EACL,cAAeE,EACf,oBAAkB,KAACV,EAAA,CAAQ,IAAKQ,EAAc,EAC9C,iBAAkB,CAAC,CAAE,iBAAAM,EAAkB,OAAAC,CAAO,IACnChB,KACH,KAACA,EAAA,CAAQ,iBAAkBe,EAAkB,IAAKN,EAAc,OAAQO,EAAQ,KAEhF,KAACf,EAAA,CAAQ,IAAKQ,EAAc,EAGpC,2BAA4BP,EAC5B,wBAAyBG,EAC7B,EACCK,GAAA,YAAAA,EAAc,IAAI,CAACE,EAAKK,IACdjB,KACH,KAACA,EAAA,CAAQ,IAAK,GAAGY,EAAI,OAAO,IAAIK,CAAK,IAAK,oBAAkB,KAAChB,EAAA,CAAQ,IAAKW,EAAK,EAAI,IAAKA,EAAK,KAE7F,KAACX,EAAA,CAAQ,IAAKW,EAAK,EAG/B,EAIDb,GAAA,YAAAA,EAAM,IAAI,CAACa,EAAKK,IACZjB,KACH,KAACA,EAAA,CAAQ,IAAK,GAAGY,EAAI,OAAO,IAAIK,CAAK,IAAK,oBAAkB,KAAChB,EAAA,CAAQ,IAAKW,EAAK,EAAI,IAAKA,EAAK,KAE7F,KAACX,EAAA,CAAQ,IAAKW,EAAK,EAG/B,CGhHA,IAAAM,GAAuD,kBACvDC,GAAkC,wBCDlC,IAAMC,GAAiBC,GAAcA,EAK9B,SAASC,GAAUC,EAAkCC,EAASJ,GAAe,CAChF,OAAO,OAAO,KAAKG,CAAO,EACrB,OAAOE,GAAKF,EAAQE,CAAC,CAAC,EACtB,IAAID,CAAM,EACV,KAAK,GAAG,CACjB,CCLO,SAASE,KAAQC,EAAwB,CAEhD,CAKO,SAASC,GAAWC,EAAe,CAAE,IAAAC,EAAK,IAAAC,CAAI,EAAyC,CAC1F,OAAIF,GAASC,EACFA,EAGPD,GAASE,EACFA,EAGJF,CACX,CAKO,SAASG,GAAkBH,EAAe,CAAE,IAAAC,EAAK,IAAAC,CAAI,EAA0C,CAClG,OAAOF,EAAQC,GAAOD,EAAQE,CAClC,CAKA,SAASE,GAAaC,EAAsB,CACxC,IAAMC,EAAaD,EAAK,SAAS,EAC3BE,EAAWD,EAAW,QAAQ,GAAG,EACnCE,EAAY,EAEhB,OAAID,IAAa,KACbC,EAAYF,EAAW,OAASC,EAAW,GAGxCC,CACX,CAcA,SAASC,GAAgBT,EAAe,CAAE,MAAAU,EAAO,KAAAL,EAAM,IAAAJ,CAAI,EAA4B,CACnF,IAAMU,EAAS,OAAO,KAAKD,CAAK,EAAE,IAAI,MAAM,EAE5C,GAAIL,GAAQ,MAAQA,EAAO,EAAG,CAC1B,IAAMO,EAAc,KAAK,OAAOZ,EAAQC,GAAOI,CAAI,EAAIA,EAAOJ,EAC9DU,EAAO,KAAKC,CAAW,CAC3B,CAEA,IAAMC,EAAQF,EAAO,IAAIG,GAAS,KAAK,IAAId,EAAQc,CAAK,CAAC,EAEzD,OAAOH,EAAOE,EAAM,QAAQ,KAAK,IAAI,GAAGA,CAAK,CAAC,CAAC,GAAKZ,CACxD,CAKO,SAASc,GAAWf,EAAe,CAAE,KAAAK,EAAM,MAAAK,EAAO,IAAAT,CAAI,EAA4B,CACrF,IAAMe,EAAeP,GAAgBT,EAAO,CAAE,KAAAK,EAAM,MAAAK,EAAO,IAAAT,CAAI,CAAC,EAEhE,OAGII,GAAQ,MAAQA,GAAQ,EAAIW,EAAe,OAAOA,EAAa,QAAQZ,GAAaC,CAAI,CAAC,CAAC,CAElG,CAKO,SAASY,GAAwBC,EAAmBC,EAAyB,CAChF,IAAMC,EAASD,EAAO,sBAAsB,EAE5C,OAAOD,EAAWE,EAAO,IAAMA,EAAO,OAAS,EAAIA,EAAO,KAAOA,EAAO,MAAQ,CACpF,CAKO,SAASC,GAAiBH,EAAmBI,EAA2B,CAC3E,OAAOJ,EAAWI,EAAM,QAAUA,EAAM,KAC5C,CAKO,SAASC,GAAiBL,EAAmBI,EAA2B,CAC3E,OAAOJ,EAAWI,EAAM,QAAQ,CAAC,EAAG,QAAUA,EAAM,QAAQ,CAAC,EAAG,KACpE,CAIO,SAASE,GAAkBF,EAAcG,EAA6B,CACzE,OAAOA,EAAQ,KAAKN,GAAUG,EAAM,SAAWH,CAAM,CACzD,CAKO,SAASO,GAAuBJ,EAA4B,CAC/D,OAAOA,EAAM,QAAQ,OAAS,GAAMA,EAAM,KAAK,YAAY,IAAM,YAAcA,EAAM,QAAQ,OAAS,CAC1G,CCtHA,IAAAK,GAAuB,kBAuBhB,SAASC,GAAM,CAAE,IAAAC,EAAK,IAAAC,EAAK,WAAAC,EAAY,WAAAC,EAAY,MAAAC,EAAO,SAAAC,EAAU,SAAAC,EAAU,cAAAC,CAAc,EAAe,CAC9G,IAAMC,EAAY,OAAO,KAAKJ,CAAK,EAG7BK,EADO,KADMD,EAAU,OACI,GACR,GAEnBE,EAAQT,EAAMD,EAEdW,EAAWH,EACZ,IAAI,MAAM,EACV,KAAK,CAACI,EAAGC,IAAMD,EAAIC,CAAC,EACpB,IAAIC,GAAS,CACV,IAAMC,EACD,CAACV,GAAYS,IAAUX,GAAgBE,GAAYS,GAASX,GAAcW,GAASZ,EAElFc,EAAUC,GACZ,CACI,OAAAF,EACA,KAAM,EACV,EACAG,GAAM,GAAGX,CAAa,GAAGW,CAAE,EAC/B,EAEMC,EAA2Bb,EAC3B,CACI,aAAc,OACd,OAAQ,IAAKQ,EAAQd,GAAOU,EAAS,GAAG,GAC5C,EACA,CACI,MAAO,GAAGD,CAAS,IACnB,WAAY,GAAG,CAACA,EAAY,CAAC,IAC7B,KAAM,IAAKK,EAAQd,GAAOU,EAAS,GAAG,GAC1C,EAEAU,EAAYhB,EAAMU,CAAK,EAE7B,SACI,MAAC,QAAK,MAAOE,EAAS,MAAOG,EAAO,IAAK,OAAOL,CAAK,GAChDM,CACL,CAER,CAAC,EAEL,SAAO,MAAC,OAAI,MAAO,GAAGb,CAAa,SAAUI,CAAS,CAC1D,CCnEA,IAAAU,GAAuB,kBAyBhB,SAASC,GAAM,CAClB,IAAAC,EACA,IAAAC,EACA,KAAAC,EACA,WAAAC,EACA,WAAAC,EACA,MAAAC,EACA,KAAAC,EACA,SAAAC,EACA,SAAAC,EACA,cAAAC,CACJ,EAAe,CACX,IAAMC,EAAQT,EAAMD,EAEdW,EAAWC,GAAWP,EAAOC,EAAMJ,EAAMF,EAAKC,CAAG,EAAE,IAAIY,GAAS,CAClE,IAAMC,EAAS,GAAI,KAAK,IAAID,EAAQb,CAAG,EAAIU,EAAS,GAAG,IACjDK,EAA2BP,EAAW,CAAE,OAAQM,CAAO,EAAI,CAAE,KAAMA,CAAO,EAC1EE,EAAU,CAACT,GAAYM,IAAUT,GAAgBG,GAAYM,GAAST,GAAcS,GAASV,EAE7Fc,EAAUC,GAAU,CAAE,OAAAF,EAAQ,IAAK,EAAK,EAAGG,GAAM,GAAGV,CAAa,GAAGU,CAAE,EAAE,EAE9E,SAAO,MAAC,QAAK,MAAOF,EAAS,MAAOF,EAAO,IAAK,OAAOF,CAAK,EAAG,CACnE,CAAC,EAED,SAAO,MAAC,OAAI,MAAO,GAAGJ,CAAa,SAAUE,CAAS,CAC1D,CAKA,SAASC,GAAWP,EAAoBC,EAAeJ,EAAcF,EAAaC,EAAuB,CACrG,IAAMmB,EAAS,OAAO,KAAKf,CAAK,EAAE,IAAI,MAAM,EAE5C,GAAIC,GAAQJ,EAAO,EACf,QAAS,EAAIF,EAAK,GAAKC,EAAK,EAAI,EAAIC,EAC5BkB,EAAO,QAAQ,CAAC,IAAM,IACtBA,EAAO,KAAK,CAAC,EAKzB,OAAOA,CACX,CJSA,IAAMC,GAAe,CACjB,KAAM,EACN,OAAQ,EACR,MAAO,EACP,KAAM,EACN,QAAS,CACb,EAOO,SAASC,GAAe,CAC3B,IAAAC,EAAM,EACN,IAAAC,EAAM,IACN,KAAAC,EAAO,EACP,MAAAC,EAAQ,CAAC,EACT,KAAAC,EAAO,GACP,SAAAC,EAAW,GACX,SAAAC,EAAW,GACX,SAAAC,EAAW,GACX,UAAAC,EAAY,eACZ,cAAAC,EAAgB,GAChB,SAAAC,EACA,OAAAC,EAAS,CAAC,EACV,QAAAC,EAAU,CAAC,EACX,OAAAC,EAAS,CAAC,EACV,WAAAC,EAAa,EACb,WAAAC,EAAa,EACb,kBAAAC,EACA,aAAAC,EAAe,KACf,YAAAC,EAAc,CAAC,EACf,QAAAC,EAAUC,EACV,MAAAC,EAAQD,EACR,OAAAE,EAASF,EACT,cAAAG,EAAgBH,CACpB,EAAwB,CAIpB,IAAMI,KAAa,WAAO,CAAC,EACrBC,KAAY,WAA8B,IAAI,KAKpD,cAAU,IAAM,CACRT,GACAA,EAAkBS,EAAU,OAAO,CAG3C,EAAG,CAAC,CAAC,KAKL,cAAU,IAAM,CAGZ,GAFAC,GAAqB,EAEjBT,IAAiB,KAIrB,OAAAU,GAAuB,EACvBC,GAAuB,EAEhB,IAAM,CACTF,GAAqB,CACzB,CAEJ,CAAC,EAED,IAAMG,EAAUC,GACZ,CACK,aAAe,CAAC,CAAC,OAAO,KAAK3B,CAAK,EAAE,OACrC,SAAAG,EACA,SAAAC,EACA,CAACC,CAAS,EAAG,EACjB,EACAuB,GAAMtB,EAAgBsB,CAC1B,EAKA,SAASC,GAAYC,EAAyB,CAC1C,GAAIA,EAAM,SAAWnC,GAAa,KAC9B,OAGJ,IAAIoC,EAAmBC,GAAiB7B,EAAU2B,CAAK,EAEvD,GAAIG,GAAkBH,EAAOf,CAAW,GAAKe,EAAM,kBAAkB,QAAS,CAC1E,IAAMI,GAAiBC,GAAwBhC,EAAU2B,EAAM,MAAM,EACrET,EAAW,QAAUU,EAAWG,GAChCH,EAAWG,EACf,MACIb,EAAW,QAAU,EAGzBL,EAAQe,CAAQ,CACpB,CAKA,SAASK,GAAaN,EAAyB,CAC3C,GAAIO,GAAuBP,CAAK,EAC5B,OAGJ,IAAIC,EAAmBO,GAAiBnC,EAAU2B,CAAK,EAEvD,GAAIG,GAAkBH,EAAOf,CAAW,GAAKe,EAAM,kBAAkB,QAAS,CAC1E,IAAMI,GAAiBC,GAAwBhC,EAAU2B,EAAM,MAAM,EACrET,EAAW,QAAUU,EAAWG,GAChCH,EAAWG,EACf,MACIb,EAAW,QAAU,EAGzBL,EAAQe,CAAQ,CACpB,CAKA,SAASQ,GAAYT,EAAyB,CAC1C,GAAI,CAACR,EAAU,QAAS,CACpBJ,EAAM,EAEN,MACJ,CAEA,IAAMa,EAAWC,GAAiB7B,EAAU2B,CAAK,EACjDX,EAAOY,EAAWV,EAAW,OAAO,CACxC,CAKA,SAASmB,GAAYV,EAAyB,CAC1C,GAAI,CAACR,EAAU,SAAWe,GAAuBP,CAAK,EAAG,CACrDZ,EAAM,EAEN,MACJ,CAEA,IAAMa,EAAWO,GAAiBnC,EAAU2B,CAAK,EACjDX,EAAOY,EAAWV,EAAW,OAAO,CACxC,CAKA,SAASoB,IAAmB,CACxBvB,EAAM,EACNE,EAAcV,CAAM,CACxB,CAKA,SAASc,IAA+B,CACpC,SAAS,iBAAiB,YAAae,EAAW,EAClD,SAAS,iBAAiB,UAAWE,EAAU,CACnD,CAKA,SAAShB,IAA+B,CACpC,SAAS,iBAAiB,YAAae,EAAW,EAClD,SAAS,iBAAiB,WAAYC,EAAU,CACpD,CAKA,SAASlB,IAA6B,CAClC,SAAS,oBAAoB,YAAagB,EAAW,EACrD,SAAS,oBAAoB,UAAWE,EAAU,EAElD,SAAS,oBAAoB,YAAaD,EAAW,EACrD,SAAS,oBAAoB,WAAYC,EAAU,CACvD,CAKA,SACI,MAAC,OACG,MAAOf,EACP,IAAKJ,EACL,aAAclB,EAAWa,EAAOmB,GAChC,YAAahC,EAAWa,EAAOY,OAE/B,MAAC,OAAI,MAAO,GAAGvB,CAAa,OAAQ,EACnCE,KACD,MAACkC,GAAA,CACG,SAAUvC,EACV,MAAOH,EACP,KAAMC,EACN,KAAMF,EACN,SAAUG,EACV,WAAYS,EACZ,WAAYC,EACZ,IAAKd,EACL,IAAKD,EACL,cAAeS,EACnB,EACCG,KACD,MAACkC,GAAA,CACG,SAAUxC,EACV,MAAOH,EACP,SAAUE,EACV,WAAYS,EACZ,WAAYC,EACZ,IAAKd,EACL,IAAKD,EACL,cAAeS,EACnB,EACCC,CACL,CAER,CK9SA,IAAAqC,GAA0C,kBAC1CC,GAAkC,wBAqC3B,SAASC,GAAO,CACnB,IAAAC,EACA,IAAAC,EACA,MAAAC,EACA,SAAAC,EACA,SAAAC,EACA,SAAAC,EACA,MAAAC,EACA,OAAAC,EACA,cAAAC,EACA,MAAAC,EACA,SAAAC,EACA,MAAAC,CACJ,EAAgB,CACZ,IAAMC,KAAa,WAA2B,IAAI,KAElD,cAAU,IAAM,CACRP,GAAYO,EAAW,SACvBA,EAAW,QAAQ,MAAM,CAEjC,EAAG,CAACP,CAAQ,CAAC,EAEb,IAAMQ,EAA2BV,EAC3B,CACI,OAAQ,GAAGI,CAAM,GACrB,EACA,CACI,KAAM,GAAGA,CAAM,GACnB,EAEAO,EAAUC,GACZ,CACI,SAAAV,EACA,OAAQ,GACR,CAAC,UAAUC,CAAK,EAAE,EAAG,EACzB,EACAU,GAAM,GAAGR,CAAa,GAAGQ,CAAE,EAC/B,EAKA,SAASC,EAAYC,EAAmC,CACpDP,EAAMO,CAAO,EACTA,IACAN,EAAW,QAAUM,EAE7B,CAEA,SACI,MAAC,OACG,MAAOJ,EACP,MAAOD,EACP,KAAK,SACL,SAAU,GACV,mBAAkBV,EAAW,WAAa,aAC1C,gBAAe,GACf,gBAAeH,EACf,gBAAeC,EACf,gBAAeC,EACf,aAAYO,EACZ,IAAKQ,MAEL,MAAC,QAAK,MAAO,GAAGT,CAAa,OAAQE,CAAS,CAClD,CAER,CCxGA,IAAAS,GAAoC,kBCApC,IAAAC,GAAuB,kBAyBhB,SAASC,GAAM,CAAE,SAAAC,EAAU,SAAAC,EAAU,MAAAC,EAAO,OAAAC,EAAQ,OAAAC,EAAQ,cAAAC,CAAc,EAAe,CAC5F,IAAMC,EAA2B,CAAC,EAElC,OAAKL,IACDK,EAAM,WAAa,UAGnBN,GACAM,EAAM,OAAS,GAAGH,CAAM,IACxBG,EAAM,OAAS,GAAGF,CAAM,MAExBE,EAAM,KAAO,GAAGH,CAAM,IACtBG,EAAM,MAAQ,GAAGF,CAAM,QAGpB,MAAC,OAAI,MAAO,GAAGC,CAAa,SAASA,CAAa,SAASH,CAAK,GAAI,MAAOI,EAAO,CAC7F,CDpCA,IAAAC,EAAyD,wBAsClD,SAASC,GAAYC,EAAsC,CAC9D,GAAM,CACF,MAAAC,EAAQ,EACR,WAAAC,EAAa,GACb,SAAAC,EAAW,GACX,MAAAC,EAAQ,KACR,aAAAC,EAAe,KACf,IAAAC,EAAM,EACN,IAAAC,EAAM,IACN,cAAAC,EAAgB,GAChB,aAAAC,EAAe,OACf,KAAAC,EAAO,EACP,MAAAC,EAAQ,CAAC,EACT,KAAAC,EAAO,GACP,SAAAC,EAAW,GACX,SAAAC,EAAW,GACX,SAAAC,EAAW,GACX,UAAAC,EAAY,eACZ,eAAAC,EAAiBC,EACjB,cAAAC,EAAgBD,EAChB,SAAAE,EACA,SAAAC,CACJ,EAAIrB,EAKE,CAACsB,EAAaC,CAAc,KAAI,YAAkC,MAAS,EAC3E,CAACC,EAAQC,CAAS,KAAI,YAAmB,CAAC,CAAC,EAC3C,CAACC,EAAQC,EAAS,KAAI,YAAwB,IAAI,EAClD,CAACC,GAAQC,EAAS,KAAI,YAAiB,CAAC,EACxCC,MAAe,eAAyCC,GAAW,CACrEC,GAAU,QAAUD,CACxB,EAAG,CAAC,CAAC,EAICC,MAAY,UAA8B,IAAI,EAI9CC,MAAc,UAAkB,CAAC,CAAC,KAExC,aAAU,IAAM,CACZ,IAAMC,EAAe,CAAC,GAAG,MAAMjC,EAAQ,CAAC,CAAC,EAAE,IAAI,IAAMK,CAAG,EAElD6B,EAAS/B,GAAS,KAAOA,EAAQC,GAAgB,KAAOA,EAAe6B,EAE7ET,EAAUU,EAAO,IAAI/B,GAASgC,GAAgBhC,CAAK,CAAC,CAAC,EACrDyB,GAAUL,EAAO,CAAC,IAAMjB,EAAM,EAAIiB,EAAO,OAAS,CAAC,CAEvD,EAAG,CAAC,CAAC,EAEL,IAAMa,MAAiB,UAAOb,CAAM,EAC9Bc,MAAgB,UAAOtC,CAAK,KAElC,aAAU,IAAM,CACZ,GAAI,EAAEI,GAAS,OAAOE,GAAQ,UAAY,OAAOC,GAAQ,UACrD,OAIJ,IAAMgC,GADYnC,GAASiC,GAAe,SACb,IAAIG,GAAeJ,GAAgBI,EAAaF,GAAc,OAAO,CAAC,EAG/FC,EAAW,SAAWF,GAAe,QAAQ,QAC7CE,EAAW,MAAM,CAACC,EAAaC,IAAUD,IAAgBH,GAAe,QAAQI,CAAK,CAAC,IAK1FhB,EAAUc,CAAU,EAEhBF,GAAe,QAAQ,KAAKG,GAAeE,GAAkBF,EAAa,CAAE,IAAAlC,EAAK,IAAAC,CAAI,CAAC,CAAC,GACvFa,EAASmB,CAAU,EAG3B,EAAG,CAACnC,EAAOE,EAAKC,CAAG,CAAC,EAEpB,IAAMoC,EAAUnB,EAAO,IAAIpB,GAASwC,GAAWxC,CAAK,CAAC,EAE/CyC,EAAUrB,EAAO,IAAI,CAACpB,EAAOqC,OAC/B,MAACK,GAAA,CACG,SAAUhC,EACV,SAAUC,EACV,SAAUW,IAAWe,EACrB,IAAKnC,EACL,IAAKC,EACL,MAAOH,EACP,MAAOqC,EAAQ,EACf,OAAQE,EAAQF,CAAK,EACrB,cAAejC,EACf,MAAQuC,GAA6B,CACjCC,GAAWD,EAAMN,CAAK,CAC1B,EACA,IAAK,UAAUA,CAAK,GACpB,MAAOA,EAAQ,cAAgB,eAE9BhC,EAAaL,CAAK,CACvB,CACH,EAEK6C,GAASzB,EAAO,MAAM,EAAG,EAAE,EAAE,IAAI,CAAC0B,EAAQT,IAAU,CACtD,IAAMU,EAAYV,EAAQ,EAE1B,SACI,MAACW,GAAA,CACG,SAAUtC,EACV,SAAU,GACV,MAAOqC,EACP,OAAQR,EAAQF,CAAK,EACrB,OAAQE,EAAQQ,CAAS,EAAKR,EAAQF,CAAK,EAC3C,cAAejC,EACf,IAAK,SAASiC,CAAK,GACvB,CAER,CAAC,EAKD,SAASO,GAAWD,EAA0BN,EAAgB,EAAG,CACxDM,EAEMA,aAAgB,cACvBd,GAAY,QAAQQ,CAAK,EAAIM,GAF7B,OAAOd,GAAY,QAAQQ,CAAK,CAIxC,CAKA,SAASY,IAAyB,CAC9B,IAAMC,EAAStB,GAAU,QAEzB,GAAI,CAACsB,EACD,MAAO,GAGX,IAAMC,EAAOD,EAAO,sBAAsB,EAE1C,OAAOxC,EAAWyC,EAAK,IAAMA,EAAK,IACtC,CAKA,SAASC,GAAeC,EAA0B,CAC9C,IAAMC,EAAcD,EAAWJ,GAAe,EAG9C,OAFkBjB,GAAgBuB,GAAUD,CAAW,CAAC,CAG5D,CAKA,SAASC,GAAUC,EAAwB,CACvC,IAAMC,EAAQ,KAAK,IAAI,KAAK,IAAID,EAAQ,CAAC,EAAIE,GAAgB,CAAC,EAG9D,OAFchD,GAAY,EAAI+C,IAAUtD,EAAMD,GAAOA,EAAMuD,GAAStD,EAAMD,GAAOA,CAGrF,CAEA,SAASwD,IAA0B,CAC/B,IAAMR,EAAStB,GAAU,QAEzB,OAAKsB,EAIExC,EAAWwC,EAAO,aAAeA,EAAO,YAHpC,CAIf,CAKA,SAASV,GAAWxC,EAAuB,CAGvC,OAFeA,EAAQE,IAAQC,EAAMD,GAEtB,GACnB,CAKA,SAASyD,GAAaC,EAA8D,CACxD,CAAC5D,GAGrBqB,EAAUuC,EAAS,MAAM,EACrBA,EAAS,QACTrC,GAAUqC,EAAS,MAAM,GAEtB,OAAOA,EAAS,QAAW,aAClCrC,GAAUqC,EAAS,MAAM,EAE7B5C,EAAS4C,EAAS,MAAM,CAC5B,CAKA,SAASC,GAAQR,EAAwB,CACrCxC,GAAA,MAAAA,EAAiBO,GAEjB,IAAMpB,EAAQoD,GAAeC,CAAQ,EAE/BS,EAAeC,GAAgB/D,CAAK,EACpCgE,EAAkBC,GAAmBjE,EAAO8D,CAAY,EAE9DvC,GAAUyC,CAAe,EACzBvC,GAAUuC,CAAe,EAEzB,IAAME,EAAY9C,EAAO4C,CAAe,EAExC,GAAIhE,IAAUkE,EACV,OAGJ,IAAM/B,EAAa,CAAC,GAAGf,CAAM,EAC7Be,EAAW6B,CAAe,EAAIhE,EAC9B2D,GAAa,CAAE,OAAQxB,CAAW,CAAC,CACvC,CAKA,SAASgC,GAAOd,EAAwB,CACpC,GAAI/B,GAAU,KACV,OAGJ,IAAMtB,EAAQoD,GAAeC,CAAQ,EAC/Be,EAAWhD,EAAOE,CAAM,EAE9B,GAAItB,IAAUoE,EACV,OAGJ,IAAMjC,EAAa,CAAC,GAAGf,CAAM,EAC7Be,EAAWb,CAAM,EAAItB,EAErB,IAAIqE,EAAa/C,EAEjB,GAAIvB,IAAa,GAAO,CACpB,IAAMuE,EAAgBlD,EAAOiD,CAAU,EACvCE,GAAuBpC,EAAYkC,EAAYC,CAAc,CACjE,MAAWxE,IACPqC,EAAW,KAAK,CAACqC,EAAGC,KAAMD,EAAIC,EAAC,EAC/BJ,EAAalC,EAAW,QAAQnC,CAAK,GAGzC2D,GAAa,CACT,OAAQU,EACR,OAAQlC,CACZ,CAAC,CACL,CAKA,SAASuC,IAAc,CACnBnD,GAAU,IAAI,CAClB,CAMA,SAASS,GAAgBhC,EAAe2E,EAAuC,CAAC,EAAW,CACvF,IAAMC,EAAc,CAAE,IAAA1E,EAAK,IAAAC,EAAK,WAAAL,EAAY,MAAAS,EAAO,KAAAD,EAAM,GAAGqE,CAAU,EACtE,OAAOE,GAAWC,GAA+BC,GAAW/E,EAAO4E,CAAW,EAAGA,CAAW,EAAGA,CAAW,CAC9G,CAKA,SAASb,GAAgB/D,EAAuB,CAC5C,IAAI8D,EAAuB,EAE3B,QAASkB,EAAI,EAAGC,EAAI7D,EAAO,OAAS,EAAG4D,EAAIC,EAAGD,IACtChF,EAAQoB,EAAO4D,CAAC,IAChBlB,EAAekB,GAIvB,OAAI,KAAK,IAAI5D,EAAO0C,EAAe,CAAC,EAAK9D,CAAK,EAAI,KAAK,IAAIoB,EAAO0C,CAAY,EAAK9D,CAAK,IACpF8D,GAAgB,GAGbA,CACX,CAKA,SAASG,GAAmBjE,EAAe8D,EAA8B,CACrE,IAAIE,EAA0BF,EAExBoB,EAAYpB,EAAe,EAGjC,OAFuB1C,EAAO8D,CAAS,IAAM9D,EAAO0C,CAAY,IAGxD1C,EAAOI,EAAM,IAAMJ,EAAO0C,CAAY,EACtCE,EAAkBxC,GAElBwC,EAAkBkB,EAGlBlF,IAAUoB,EAAO8D,CAAS,IAC1BlB,EAAkBhE,EAAQoB,EAAO8D,CAAS,EAAKpB,EAAeoB,IAI/DlB,CACX,CAKA,SAASO,GAAuBnD,EAAkBE,EAAgBgD,EAA6B,CAC3F,IAAMa,EAAY,OAAOpF,CAAQ,EAC3BC,EAAQoB,EAAOE,CAAM,EAEvB8D,EAAY,EAYhB,GAVIhE,EAAOE,EAAS,CAAC,EAAKtB,EAASmF,IAE/BC,EAAY,GAGZpF,EAASoB,EAAOE,EAAS,CAAC,EAAK6D,IAE/BC,EAAY,IAGZA,IAAc,EACd,OAGJ,IAAMf,GAAa/C,EAAS8D,EACtBC,GAAaD,GAAahE,EAAOiD,EAAU,EAAKrE,GAEjDsF,GAAWlE,EAAQiD,GAAYe,EAAWD,EAAYE,EAAU,IAEjEjE,EAAOE,CAAM,EAAIgD,EAEzB,CAKA,SAASgB,GAAWlE,EAAkBE,EAAgB8D,EAAmBG,EAAyB,CAC9F,IAAMjB,EAAgBlD,EAAOE,CAAM,EAC/BkE,EAAepE,EAAOE,CAAM,EAEhC,KAAO8D,GAAaI,EAAgBlB,GAAkBiB,GAAQ,CAC1D,GAAI,CAACE,GAAmBrE,EAAQE,EAAQ8D,CAAS,EAG7C,OAAAhE,EAAOE,CAAM,EAAIgD,EAEV,GAGXkB,EAAepE,EAAOE,CAAM,CAChC,CAIA,MAAO,EACX,CAKA,SAASmE,GAAmBrE,EAAkBE,EAAgB8D,EAA4B,CACtF,IAAMM,EAASC,GAAU,EAEnBC,EADaF,EAAO,QAAQtE,EAAOE,CAAM,CAAE,EACb8D,EAEpC,GAAIQ,GAAkBF,EAAO,QAAUE,EAAiB,EAEpD,MAAO,GAGX,IAAMvB,GAAa/C,EAAS8D,EACtBS,GAAYH,EAAOE,CAAc,EAEjCT,GAAY,OAAOpF,CAAQ,EAE3BsF,GAAaD,GAAahE,EAAOiD,EAAU,EAAKwB,IAEtD,OAAKP,GAAWlE,EAAQiD,GAAYe,EAAWD,GAAYE,EAAU,GAMrEjE,EAAOE,CAAM,EAAIuE,GAEV,IANI,EAOf,CAMA,SAASF,IAAsB,CAC3B,IAAMG,EAAQ5E,EAEd,GAAI,CAAC4E,GAASA,EAAM,QAAUvF,GAASuF,EAAM,OAASxF,EAAM,CACxD,IAAMyF,EAAe,CAAE,GAAGxF,CAAM,EAEhC,GAAID,GAAQ,MAAQA,EAAO,EACvB,QAAS0F,EAAQ9F,EAAK8F,GAAS7F,EAAK6F,GAAS1F,EACzCyF,EAAaC,CAAK,EAAI,OAAOA,CAAK,EAI1C,IAAMN,EAAS,OAAO,KAAKK,CAAY,EAAE,IAAI,MAAM,EAEnDL,EAAO,KAAK,CAAClB,EAAGC,IAAMD,EAAIC,CAAC,EAC3BtD,EAAe,CAAE,MAAAZ,EAAO,KAAAD,EAAM,OAAAoF,CAAO,CAAC,CAC1C,CAEA,OAAOxE,GAAA,YAAAA,EAAa,SAAU,CAAC,CACnC,CAKA,SAAS4D,GAA+B9E,EAAe,CAAE,WAAAF,CAAW,EAAoC,CACpG,GAAI,CAACA,GAAcwB,GAAU,KAAM,CAC/B,GAAIA,EAAS,GAAKtB,GAASoB,EAAOE,EAAS,CAAC,EACxC,OAAOF,EAAOE,EAAS,CAAC,EAE5B,GAAIA,EAASF,EAAO,OAAS,GAAKpB,GAASoB,EAAOE,EAAS,CAAC,EACxD,OAAOF,EAAOE,EAAS,CAAC,CAEhC,CAEA,OAAOtB,CACX,CAEA,SACI,MAACiG,GAAA,CACG,IAAK/F,EACL,IAAKC,EACL,SAAUO,EACV,SAAUC,EACV,cAAeP,EACf,OAAQyC,GACR,QAASJ,EACT,OAAQrB,EACR,WAAYA,EAAOA,EAAO,OAAS,CAAC,EACpC,WAAYA,EAAO,CAAC,EACpB,YAAaS,GAAY,QACzB,aAAcP,EACd,KAAMhB,EACN,MAAOC,EACP,KAAMC,EACN,SAAUC,EACV,UAAWG,EACX,eAAgBC,EAChB,cAAeE,EACf,SAAUC,EACV,QAAS6C,GACT,MAAOa,GACP,OAAQP,GACR,kBAAmBzC,GACnB,aAAcrB,GAEbY,CACL,CAER,CExgBA,IAAAiF,GAA4B,kBAkDrB,SAASC,GAAYC,EAAyB,CACjD,GAAM,CAAE,IAAAC,EAAK,IAAAC,EAAK,MAAAC,EAAO,YAAAC,CAAY,EAAIC,GAASL,EAAM,EAAE,EAE1D,OAAO,OAAOC,GAAQ,UAAY,OAAOC,GAAQ,UAAYD,IAAQC,KACjE,MAACI,GAAA,CACG,IAAK,gBAAgBL,CAAG,IAAIC,CAAG,IAAIC,EAAM,KAAK,GAAG,CAAC,GAClD,cAAeH,EAAM,eAAiB,MACtC,UAAWA,EAAM,WAAa,eAC9B,SAAU,CAAC,CAACO,EAAMC,CAAE,IAAM,CAClBR,EAAM,SACNA,EAAM,QAAQ,CAAC,KAAK,MAAMO,GAAQN,CAAG,EAAG,KAAK,KAAKO,GAAMN,CAAG,CAAC,CAAC,CAErE,EACA,cAAe,CAAC,CAACK,EAAMC,CAAE,IAAM,CAC3BJ,EAAY,CAACG,EAAMC,CAAE,CAAC,CAC1B,EACA,aAAc,CAAC,KAAK,MAAML,EAAM,CAAC,GAAKF,CAAG,EAAG,KAAK,KAAKE,EAAM,CAAC,GAAKD,CAAG,CAAC,EACtE,IAAK,KAAK,MAAMD,CAAG,EACnB,IAAK,KAAK,KAAKC,CAAG,EAClB,aAAcF,EAAM,YACxB,KAEA,MAAC,gBAAS,CAElB,CC1EA,IAAAS,GAAkB,kBA4CX,IAAMC,GACT,CAACC,GAAM,GAAKC,GAA8B,EAAIC,GAA6BC,GAKxE,SAASA,GAAuB,CAAE,kBAAAC,EAAmB,GAAGC,CAAU,EAAwB,CAE7F,SAAO,MAACC,GAAA,CAA4B,GAAGD,EAAW,kBADjCD,GAAqBG,GACyC,CACnF,CAKA,SAASA,GAAa,CAAE,SAAAC,CAAS,EAA0B,CACvD,GAAM,CAAE,SAAAC,EAAU,KAAAC,CAAK,EAAIC,GAAYH,CAAQ,EAE/C,SACI,MAAC,KAAE,MAAM,uEAAuE,QAASC,EAAU,KAAMC,GAAM,cAE/G,CAER,CClEA,IAAAE,GAA+C,kBAuBxC,SAASC,GAAY,CAAE,SAAAC,EAAU,IAAAC,EAAK,GAAAC,EAAI,QAAAC,EAAS,GAAGC,CAAK,EAAkC,CAChG,IAAMC,EAAWC,EAAoBC,GAASA,EAAM,QAAQ,EACtDC,EAAQH,IAAa,WAAa,WAAaA,IAAa,SAAW,OAAS,OAEhFI,EAAaT,aAAoB,MAAQA,EAAW,CAACA,CAAQ,EAEnE,OAAIE,KACO,MACHA,EACA,CACI,GAAIA,IAAO,KAAOD,GAAO,OAAOA,GAAQ,UAAY,QAASA,GAAO,OAAOA,EAAI,KAAQ,SACjF,CACI,KAAMA,EAAI,GACd,EACA,CAAC,EACP,GAAGG,EACH,QAAUM,IACFT,GAAOO,GACPG,EAAQC,GAAOA,EAAI,kBAAkBJ,EAAOP,CAAG,CAAC,EAEpDY,GAAe,EACRV,GAAA,YAAAA,EAAUO,GAEzB,EACA,GAAGD,CACP,KAIA,MAAC,iBACIA,EAAW,IAAI,CAACK,EAAOC,IAAU,CAC9B,GAAID,GAAS,OAAOA,GAAU,UAAY,UAAWA,EAAO,CACxD,IAAMX,EAAyCO,GAAS,CAvD5E,IAAAM,EAwD4Bf,GAAOO,GACPG,EAAQC,GAAOA,EAAI,kBAAkBJ,EAAOP,CAAG,CAAC,EAEpDY,GAAe,EACX,QAAOG,EAAAF,EAAM,QAAN,YAAAE,EAAa,UAAW,YAC/BF,EAAM,MAAM,QAAQJ,CAAK,CAEjC,EAEA,SAAO,iBAAaI,EAAO,CACvB,GAAGA,EAAM,MACT,QAAAX,EACA,IAAKY,CACT,CAAC,CACL,CACA,OAAOD,CACX,CAAC,CACL,CAER,CCpEO,SAASG,GAAYC,EAA4CC,EAA0C,CAC9GC,EAAQC,GAAOA,EAAI,kBAAkBH,EAAMC,CAAG,CAAC,CACnD,CCCO,SAASG,GAAiBC,EAAYC,KAAiBC,EAAyB,CACnF,MAAO,CAAE,GAAAF,EAAI,MAAO,CAAE,KAAAC,EAAM,KAAAC,CAAK,CAAE,CACvC,CCPA,IAAMC,GAAiB,CACnB,OAAQ,QACR,eAAgB,CACpB,EAEaC,GAAyD,CAClE,IAAK,CAAE,OAAQ,QAAS,eAAgB,CAAE,EAC1C,IAAK,CAAE,OAAQ,QAAS,eAAgB,CAAE,EAC1C,IAAK,CAAE,OAAQ,QAAS,eAAgB,CAAE,EAC1C,IAAK,CAAE,OAAQ,QAAS,eAAgB,CAAE,EAC1C,IAAK,CAAE,OAAQ,QAAS,eAAgB,CAAE,CAC9C,EAKO,SAASC,GAAkBC,EAAkBC,EAAgC,CAChFH,GAAgBE,CAAQ,EAAIC,CAChC,CAMO,SAASC,GAAeC,EAAeH,EAAmB,MAAO,CA7BxE,IAAAI,EA8BI,GAAM,CAAE,OAAAC,EAAQ,eAAAC,CAAe,GAAIF,EAAAN,GAAgBE,CAAQ,IAAxB,KAAAI,EAA6BP,GAQhE,OANqB,IAAI,KAAK,aAAaQ,EAAQ,CAC/C,MAAO,WACP,SAAAL,EACA,sBAAuBM,EACvB,sBAAuBA,CAC3B,CAAC,EACmB,OAAOH,CAAK,CACpC,CCrCe,SAARI,GAA4BC,EAAWC,EAA+C,CACzF,OAAOD,EAAK,OAAsB,CAACE,EAAQC,EAAMC,IAAU,CACvD,IAAMC,EAAQJ,EAASE,EAAMC,CAAK,EAC5BE,EAAQJ,EAAOG,CAAK,GAAK,CAAC,EAChC,OAAAC,EAAM,KAAKH,CAAI,EACfD,EAAOG,CAAK,EAAIC,EACTJ,CACX,EAAG,CAAC,CAAC,CACT,CCTA,SAASK,GAAE,CAAE,KAAMC,EAAG,UAAWC,EAAG,KAAMC,CAAE,EAAG,CAC7C,IAAMC,EAAIF,GAAE,EACZ,GAAI,CAACE,EACH,MAAM,IAAI,MAAM,8CAA8C,EAChE,MAAO,WAAWA,EAAE,aAAa,IAAIA,EAAE,OAAO,IAAIH,CAAC,IAAIC,CAAC,IAAIC,CAAC,IAC/D,CACA,SAASE,GAAE,CAAE,KAAMJ,CAAE,EAAG,CACtB,SAASC,EAAEI,EAAGC,EAAG,CACf,GAAIA,EACF,OAAOP,GAAE,CACP,KAAMC,EACN,UAAWK,EACX,KAAMC,CACR,CAAC,CACL,CACA,SAASJ,EAAEG,EAAGC,EAAG,CACf,GAAIA,EACF,OAAOA,EAAE,IAAKC,GAAG,CAlBvB,IAAAC,EAkB2B,OACnB,GAAGD,EACH,UAAUC,EAAAP,EAAEI,EAAGE,EAAE,SAAS,IAAhB,KAAAC,EAAqBD,EAAE,QACnC,EAAE,CACN,CACA,SAASJ,EAAEE,EAAGC,EAAGC,EAAG,CAClB,GAAI,CAACA,EACH,OAAOD,EACT,GAAIA,EACF,OAAOC,EAAE,IACNE,GAAMV,GAAE,CACP,KAAMC,EACN,UAAWK,EACX,KAAMI,CACR,CAAC,CACH,CACJ,CACA,OAAO,SAASH,EAAG,CAnCrB,IAAAE,EAAAE,EAoCI,IAAMH,EAAID,EAAE,UACZ,OAAOC,EAAI,CACT,GAAGD,EACH,UAAUE,EAAAP,EAAEM,EAAGD,EAAE,SAAS,IAAhB,KAAAE,EAAqBF,EAAE,SACjC,UAAUI,EAAAT,EAAEM,EAAGD,EAAE,SAAS,IAAhB,KAAAI,EAAqBJ,EAAE,SACjC,KAAMJ,EAAEK,EAAGD,EAAE,IAAI,EACjB,mBAAoBH,EAAEI,EAAGD,EAAE,mBAAoBA,EAAE,oBAAoB,CACvE,EAAIA,CACN,CACF,CACA,IAAMK,GAAI,oBAAqBC,GAAI,CACjC,EAAG,UACH,EAAG,UACH,EAAG,QACH,EAAG,QACH,EAAG,QACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,SACL,EACA,SAASC,GAAEb,EAAG,CACZ,OAAOA,KAAKY,EACd,CACA,SAASE,GAAE,CAAE,KAAMd,EAAG,SAAUC,EAAKC,GAAMA,CAAE,EAAG,CAC9C,GAAIF,IAAM,OACR,OAAOC,EACT,IAAMC,EAAIU,GAAEZ,CAAC,GAAKA,EAClB,SAASG,EAAEM,EAAG,CACZ,OAAOA,EAAI,IAAI,IAAIA,CAAC,EAAE,SAAS,MAAME,EAAC,EAAI,EAC5C,CACA,SAASN,EAAEI,EAAG,CACZ,OAAOA,EAAIN,EAAEM,CAAC,EAAIA,EAAE,QAAQ,oCAAqC,IAAIP,CAAC,IAAI,EAAIO,EAAI,EACpF,CACA,SAASH,EAAEG,EAAG,CACZ,GAAIA,EACF,OAAOA,EAAE,IAAKM,IAAO,CACnB,GAAGA,EACH,SAAUV,EAAEU,EAAE,QAAQ,CACxB,EAAE,CACN,CACA,SAASR,EAAEE,EAAG,CACZ,GAAIA,EACF,OAAOA,EAAE,IAAKM,GAAMV,EAAEU,CAAC,CAAC,CAC5B,CACA,OAAO,SAASA,EAAG,CACjB,OAAOZ,EAAEY,EAAE,QAAQ,EAAI,CACrB,GAAGA,EACH,SAAUV,EAAEU,EAAE,QAAQ,EACtB,SAAUV,EAAEU,EAAE,QAAQ,EACtB,KAAMT,EAAES,EAAE,IAAI,EACd,mBAAoBR,EAAEQ,EAAE,kBAAkB,CAC5C,EAAId,EAAEc,CAAC,CACT,CACF,CACA,SAASC,IAAI,CACX,IAAIhB,EACJ,OAAQA,EAAI,OAAO,QAAU,KAAO,OAASA,EAAE,aACjD,CACA,SAASiB,GAAE,CAAE,KAAMjB,CAAE,EAAG,CACtB,IAAMC,EAAIG,GAAE,CAAE,KAAMJ,CAAE,CAAC,EACvB,OAAOgB,GAAE,GAAKH,GAAEb,CAAC,EAAIc,GAAE,CAAE,KAAMd,EAAG,SAAUC,CAAE,CAAC,EAAIA,CACrD",
  "names": ["index_exports", "__export", "AbstractSlider", "AutocompleteElement", "AutocompleteElementProvider", "P", "m", "Handle", "HistoryElement", "HistoryElementProvider", "InfiniteScroll", "InfiniteScrollWithLink", "KeywordInCategory", "KeywordWrapper", "Keywords", "KeywordsInCategory", "Marks", "MultiSlider", "RangeSlider", "I", "SerpElement", "Steps", "StoreContext", "Track", "compressFilterParameters_default", "compressSortParameters_default", "configureCurrency", "createSortOption", "createStore", "currencyOptions", "formatCurrency", "groupBy", "init", "initAutocomplete", "mapOffsetToPage_default", "t", "S", "reportClick", "U", "D", "x", "useActions", "useAppState", "useAppStateSelector", "useConfig", "useCurrencyFormatting", "useDispatchEventOnLoad", "useFacet", "useFacets", "useLoadMore", "usePagination", "useProductFilters", "useRange", "useRangeSelector", "useResponse", "useSelectedFiltersCount", "useSimplePagination", "useSizeOptions", "useSort", "ae", "useStore", "waitForElement", "__toCommonJS", "import_preact", "o", "_a", "n", "s", "t", "o", "notImplemented", "tagging", "s", "api", "_a", "registerSearchTermsProvider", "config", "queryValue", "defaultConfig", "tagging", "query", "ConfigContext", "resolveQuery", "config", "queryField", "field", "import_hooks", "useConfig", "ConfigContext", "t", "_a", "o", "u", "i", "a", "t", "i", "r", "s", "e", "t", "f", "n", "c", "o", "u", "a", "o", "f", "n", "c", "s", "i", "t", "s", "i", "t", "c", "d", "u", "m", "r", "a", "n", "l", "p", "o", "h", "w", "e", "r", "t", "r", "c", "e", "n", "k", "s", "E", "a", "c", "i", "f", "u", "_a", "p", "d", "r", "e", "l", "v", "pipe_default", "fns", "value", "prev", "fn", "isObject", "v", "isPlainObject", "value", "constructor", "prototype", "ensureArray", "value", "defaultOptions", "createMapperOptions", "config", "mapParams", "data", "mapping", "a", "b", "parsed", "source", "mapFrom", "mapTo", "value", "objectGetByKey", "objectSetByKey", "objectDeleteByKey", "unmapParams", "prev", "key", "paramsToQueryString", "params", "searchParams", "values", "ensureArray", "v", "queryStringToParams", "query", "paramsToJson", "k", "multikeyToJson", "decodeKey", "jsonToParams", "knownKeys", "makeParams", "updateUrlState", "newUrl", "title", "fullUrl", "getFullUrl", "compareUrl", "bindUrlStateChange", "callback", "url", "otherUrl", "getSearchUrl", "context", "options", "_a", "_b", "_c", "_d", "_e", "mapperOptions", "createMapperOptions", "encoder", "pipe_default", "m", "paramsWithoutDefault", "deepRemove", "KEY_SEPARATOR", "KEY_SEPARATOR_ENCODED", "isInteger", "first", "deeperMultikey", "grouped", "x", "cutFirstKey", "keys", "isPlainObject", "i", "encodeKey", "obj", "objectClone", "index", "len", "pointer", "subkey", "subkeys", "defaultValue", "deepCompare", "removeValue", "result", "setStorage", "name", "value", "storage", "stringValue", "error", "a", "getStorage", "dataString", "setLocalStorageItem", "name", "value", "setStorage", "setSessionStorageItem", "getLocalStorageItem", "getStorage", "getSessionStorageItem", "ERROR_TIMEOUT", "key", "setErrorSession", "errorTimestamp", "getErrorSession", "currentTimestamp", "getCurrentTimestamp", "setSessionStorageItem", "getSessionStorageItem", "isErrorSession", "DOMReady", "resolve", "findAll", "selector", "filterType", "v", "parents", "target", "parentList", "element", "parent", "matches", "matchesFunc", "bindClickOutside", "input", "callback", "onClick", "event", "unhideNativeContent", "cssSelector", "cloneNode", "node", "deep", "scrollPosStorageKey", "savePageScroll", "restoreSavedScroll", "savedScrollPosition", "scrollTo", "interval", "serpContentClassName", "serpContentNativeClassName", "searchFormClassName", "searchFormNativeClassName", "extractNativeContent", "element", "nativeContentContainer", "child", "extractNativeForm", "selector", "delay", "resolve", "el", "_a", "newElement", "cloneNode", "restoreNativeContent", "target", "nativeContentElement", "restoreNativeForm", "unboundForms", "nativeForms", "form", "index", "nativeForm", "import_preact", "import_hooks", "w", "t", "i", "a", "f", "l", "e", "n", "C", "g", "p", "d", "s", "r", "b", "E", "y", "c", "q", "z", "h", "import_hooks", "T", "t", "e", "n", "s", "o", "i", "r", "c", "a", "u", "f", "z", "O", "E", "J", "b", "k", "I", "M", "V", "C", "W", "j", "_a", "_b", "h", "g", "m", "S", "w", "y", "p", "x", "d", "A", "K", "L", "P", "_", "F", "G", "v", "H", "B", "_a", "_b", "E", "w", "K", "b", "l", "m", "h", "k", "S", "o", "i", "c", "a", "s", "u", "g", "v", "y", "D", "P", "M", "N", "O", "n", "f", "j", "z", "T", "d", "G", "X", "import_preact", "v", "t", "f", "_", "u", "c", "l", "p", "n", "o", "r", "e", "i", "import_hooks", "import_preact", "w", "o", "i", "_a", "_b", "_c", "n", "e", "r", "t", "c", "E", "M", "m", "s", "X", "b", "p", "u", "v", "shouldFallback", "error", "newSearch", "context", "query", "options", "b", "updateSearch", "fullOptions", "o", "y", "simulateUpdateSearch", "fullQuery", "getFullUrl", "getSearchUrl", "handleFallback", "config", "end", "h", "isCategoryPage", "categoryFallback", "serpFallback", "setErrorSession", "restoreNativeContent", "restoreNativeForm", "import_preact", "M", "o", "X", "t", "b", "n", "s", "i", "c", "a", "w", "h", "q", "u", "E", "import_hooks", "useStore", "y", "import_hooks", "Y", "o", "_a", "d", "t", "n", "r", "s", "a", "L", "c", "j", "S", "ee", "k", "te", "b", "_b", "F", "w", "A", "u", "R", "l", "i", "f", "p", "g", "v", "m", "h", "q", "n", "_a", "l", "o", "t", "j", "r", "S", "i", "s", "c", "u", "d", "_b", "_c", "_d", "g", "v", "f", "p", "b", "V", "a", "e", "m", "h", "F", "w", "re", "se", "oe", "z", "ie", "B", "ce", "X", "D", "E", "U", "L", "T", "ae", "useActions", "context", "useConfig", "useStore", "toggleProductFilter", "replaceFilter", "j", "query", "options", "updateSearch", "newSearch", "field", "value", "active", "simulateUpdateSearch", "import_hooks", "useAppStateSelector", "selector", "store", "useStore", "slice", "setSlice", "useAppState", "useAppStateSelector", "state", "usePagination", "options", "te", "useProductFilters", "j", "useRangeSelector", "id", "rangeSize", "re", "useRange", "id", "V", "useFacet", "facet", "options", "Y", "useSelectedFiltersCount", "oe", "useSort", "sortOptions", "ce", "useSizeOptions", "sizes", "serpSize", "ie", "useFacets", "ee", "useResponse", "se", "useSimplePagination", "_a", "_b", "query", "response", "useAppStateSelector", "state", "t", "updateSearch", "useActions", "hasNextPage", "from", "pageSize", "hasPrev", "hasNext", "newFrom", "useLoadMore", "pageSize", "from", "size", "state", "_a", "_b", "_c", "_d", "simulateUpdateSearch", "useActions", "loadMoreBase", "X", "href", "G", "loadMore", "event", "import_hooks", "useDispatchEventOnLoad", "type", "payload", "context", "products", "useAppStateSelector", "state", "event", "import_hooks", "p", "d", "g", "i", "o", "u", "c", "_a", "a", "t", "r", "s", "f", "e", "l", "m", "S", "useCurrencyFormatting", "defaultCurrency", "useConfig", "currencyFormatting", "g", "value", "currency", "defaultState", "b", "createStore", "overrides", "w", "StoreContext", "y", "import_hooks", "import_hooks", "import_hooks", "c", "r", "o", "a", "u", "v", "a", "P", "I", "o", "t", "E", "c", "q", "y", "C", "a", "u", "m", "r", "o", "E", "c", "t", "q", "y", "import_hooks", "g", "a", "S", "P", "o", "t", "r", "E", "c", "q", "y", "import_preact", "resolveCssSelector", "selector", "bindInput", "config", "target", "callbacks", "dropdownLocator", "resolveCssSelector", "formContainer", "formEl", "E", "import_preact", "import_hooks", "localStorageKey", "hasGtag", "window", "hasGa", "hasGoogleTagManager", "trackGaPageView", "options", "_a", "delay", "title", "location", "saveToLocalStorage", "accounts", "e", "url", "trackers", "error", "a", "consumeLocalStorageEvent", "eventString", "event", "import_preact", "Context", "AutocompleteElementProvider", "props", "Context", "AutocompleteElement", "_a", "_b", "_c", "_d", "_e", "as", "filter", "children", "activeClass", "url", "hit", "onClick", "rest", "query", "useAppStateSelector", "state", "serpUrlMapping", "serpPath", "useConfig", "onSubmit", "searchOptions", "getTrackUrl", "value", "paramsToQueryString", "error", "a", "handleClick", "s", "api", "trackGaPageView", "event", "import_preact", "import_hooks", "HistoryElementProvider", "props", "Context", "HistoryElement", "children", "query", "className", "onSubmit", "event", "import_preact", "import_hooks", "ErrorBoundary", "children", "error", "a", "debounce_default", "delay", "timeoutId", "callback", "selectorLoaded", "initialized", "loading", "u", "initAutocomplete", "config", "handlers", "isErrorSession", "end", "h", "extractNativeForm", "store", "createStore", "resolveQuery", "debouncer", "debounce_default", "dropdowns", "findAll", "input", "_a", "searchFormNativeClassName", "dropdown", "createDropdown", "history", "createHistory", "locationHelperElement", "ErrorBoundary", "query", "storeHistoryState", "createHandleSubmit", "element", "options", "shouldUpdateSearch", "value", "_b", "newSearch", "k", "bind", "bindInput", "err", "a", "P", "ConfigContext", "HistoryElementProvider", "highlighted", "_value", "key", "selectorLoaded", "initialized", "AutocompleteElementProvider", "outsideDropdown", "bindClickOutside", "outsideHistory", "v", "createElements", "wrapper", "dropdownLocator", "resolveCssSelector", "dropdownParent", "form", "highlightElement", "elementList", "highlightIndex", "getHighlightIndex", "removeHighlight", "elements", "item", "index", "highlightedIndex", "historyKey", "filteredItems", "getLocalStorageItem", "setLocalStorageItem", "historyFromLocalStorage", "c", "ensureSearchQueryNumbers", "products", "rest", "e", "import_preact", "waitForElement", "selector", "timeout", "waitForElements", "resolve", "reject", "elements", "findAll", "observer", "timer", "a", "renderComponent", "config", "store", "cssSelector", "docComponent", "targets", "waitForElements", "target", "a", "extractNativeContent", "end", "h", "pageType", "renderProps", "renderSerpComponent", "renderCategoryComponent", "ComponentToRender", "ErrorBoundary", "I", "ConfigContext", "m", "initSerp", "config", "store", "end", "h", "unhideNativeContent", "selectorLoaded", "initialized", "renderComponent", "restoreSavedScroll", "query", "customParams", "updateUrlState", "getSearchUrl", "trackGaPageView", "handleUrlStateChange", "bindUrlStateChange", "getDataFromUrl", "_a", "_b", "_c", "_d", "parsedParams", "paramsToJson", "queryStringToParams", "queryParamKeys", "encodedQuery", "unmapParams", "encodedCustomParams", "prev", "cur", "mapperOptions", "createMapperOptions", "decoder", "pipe_default", "m", "queryPartial", "ensureSearchQueryNumbers", "o", "isSerp", "isCategory", "isErrorSession", "handleFallback", "newSearch", "expandMapping", "mapping", "expandedMapping", "key", "value", "nestedKeys", "currentLevel", "i", "nestedKey", "lastKey", "flattenMapping", "nestedMapping", "prefix", "result", "key", "value", "nestedKey", "createMapper", "encode", "decode", "query", "options", "decodeValue", "value", "separator", "encodeValue", "regex", "decodeUnit", "unit", "separator", "gte", "lte", "range", "decodeValue", "filterComponent", "filterUrl", "value", "filters", "encodeValue", "rangeComponent", "rangeUrl", "rangeList", "options", "item", "gtE", "ltE", "filterEncoding_default", "field", "decodedValue", "compressFilterParameters_default", "createMapper", "filter", "rest", "options", "compressedFilter", "acc", "filterEntry", "filterEncoding_default", "expandedFields", "expandMapping", "compressedFields", "flattenMapping", "expandedFilter", "field", "value", "compressSortParameters_default", "createMapper", "sort", "rest", "compressed", "field", "order", "expanded", "s", "mapOffsetToPage_default", "createMapper", "from", "size", "rest", "page", "encode", "query", "options", "q1", "mapOffsetToPage_default", "q2", "compressSortParameters_default", "compressFilterParameters_default", "decode", "defaultMappers_default", "makeConfig", "config", "fullConfig", "o", "defaultConfig", "defaultMappers_default", "context", "options", "_a", "isErrorSession", "store", "searchOptions", "error", "query", "_", "pageType", "shouldFallback", "handleFallback", "a", "init", "config", "end", "h", "fullConfig", "makeConfig", "api", "s", "searchEnabled", "categoriesEnabled", "searchActive", "autocompleteActive", "categoriesActive", "registerSearchTermsProvider", "serpStore", "createStore", "resolveQuery", "initSerp", "initAutocomplete", "query", "options", "isErrorSession", "getFullUrl", "getSearchUrl", "newSearch", "DOMReady", "categoryStore", "import_preact", "KeywordInCategory", "category", "children", "import_preact", "import_preact", "import_preact", "KeywordWrapper", "children", "filter", "Wrapper", "KeywordsInCategory", "categoryField", "wrapperComponent", "hit", "keywordComponent", "KeywordInCategoryComponent", "KeywordInCategory", "categorySuggestionCount", "_a", "_b", "facet", "f", "KeywordWrapper", "category", "index", "Keywords", "hits", "Element", "Keyword", "keywordInCategoryComponent", "KeywordInCategory", "categorySuggestion", "categorySuggestionCount", "_a", "_b", "_c", "firstKeyword", "restKeywords", "categoryField", "hit", "facet", "KeywordsInCategory", "keywordComponent", "filter", "index", "import_preact", "import_hooks", "defaultMapper", "v", "classJoin", "classes", "mapper", "k", "noop", "_rest", "clampValue", "value", "min", "max", "isValueOutOfRange", "getPrecision", "step", "stepString", "dotIndex", "precision", "getClosestPoint", "marks", "points", "closestStep", "diffs", "point", "alignValue", "closestPoint", "getHandleCenterPosition", "vertical", "handle", "coords", "getMousePosition", "event", "getTouchPosition", "isEventFromHandle", "handles", "isNotCorrectTouchEvent", "import_preact", "Marks", "min", "max", "lowerBound", "upperBound", "marks", "included", "vertical", "classesPrefix", "marksKeys", "markWidth", "range", "elements", "a", "b", "point", "active", "classes", "classJoin", "cl", "style", "markPoint", "import_preact", "Steps", "min", "max", "step", "lowerBound", "upperBound", "marks", "dots", "included", "vertical", "classesPrefix", "range", "elements", "calcPoints", "point", "offset", "style", "active", "classes", "classJoin", "cl", "points", "MouseButtons", "AbstractSlider", "min", "max", "step", "marks", "dots", "included", "vertical", "disabled", "className", "classesPrefix", "children", "tracks", "handles", "bounds", "lowerBound", "upperBound", "sliderRefCallback", "activeHandle", "handlesRefs", "onStart", "noop", "onEnd", "onMove", "onAfterChange", "dragOffset", "sliderRef", "removeDocumentEvents", "addDocumentMouseEvents", "addDocumentTouchEvents", "classes", "classJoin", "cl", "onMouseDown", "event", "position", "getMousePosition", "isEventFromHandle", "handlePosition", "getHandleCenterPosition", "onTouchStart", "isNotCorrectTouchEvent", "getTouchPosition", "onMouseMove", "onTouchMove", "onEventEnd", "Steps", "Marks", "import_preact", "import_hooks", "Handle", "min", "max", "value", "vertical", "disabled", "dragging", "index", "offset", "classesPrefix", "label", "children", "refFn", "elementRef", "style", "classes", "classJoin", "cl", "saveElement", "element", "import_preact", "import_preact", "Track", "vertical", "included", "index", "offset", "length", "classesPrefix", "style", "import_hooks", "MultiSlider", "props", "count", "allowCross", "pushable", "value", "defaultValue", "min", "max", "classesPrefix", "tipFormatter", "step", "marks", "dots", "included", "vertical", "disabled", "className", "onBeforeChange", "noop", "onAfterChange", "onChange", "children", "pointsCache", "setPointsCache", "bounds", "setBounds", "handle", "setHandle", "recent", "setRecent", "setSliderRef", "element", "sliderRef", "handlesRefs", "initialValue", "values", "clampAlignValue", "previousBounds", "previousProps", "nextBounds", "singleValue", "index", "isValueOutOfRange", "offsets", "calcOffset", "handles", "Handle", "node", "saveHandle", "tracks", "_value", "nextIndex", "Track", "getSliderStart", "slider", "rect", "calcValueByPos", "position", "pixelOffset", "calcValue", "offset", "ratio", "getSliderLength", "handleChange", "newState", "onStart", "closestBound", "getClosestBound", "boundNeedMoving", "getBoundNeedMoving", "prevValue", "onMove", "oldValue", "nextHandle", "originalValue", "pushSurroundingHandles", "a", "b", "onEnd", "nextProps", "mergedProps", "alignValue", "clampValueToSurroundingHandles", "clampValue", "i", "n", "nextBound", "threshold", "direction", "diffToNext", "pushHandle", "amount", "currentValue", "pushHandleOnePoint", "points", "getPoints", "nextPointIndex", "nextValue", "cache", "pointsObject", "point", "AbstractSlider", "import_preact", "RangeSlider", "props", "min", "max", "range", "updateRange", "useRange", "MultiSlider", "from", "to", "import_preact", "InfiniteScroll", "u", "E", "M", "InfiniteScrollWithLink", "loadMoreComponent", "restProps", "b", "LoadMoreLink", "pageSize", "loadMore", "href", "useLoadMore", "import_preact", "SerpElement", "children", "hit", "as", "onClick", "rest", "pageType", "useAppStateSelector", "state", "track", "childArray", "event", "s", "api", "savePageScroll", "child", "index", "_a", "reportClick", "type", "hit", "s", "api", "createSortOption", "id", "name", "sort", "defaultOptions", "currencyOptions", "configureCurrency", "currency", "options", "formatCurrency", "value", "_a", "locale", "fractionDigits", "groupBy", "list", "callback", "groups", "item", "index", "field", "group", "s", "n", "a", "c", "i", "l", "u", "r", "t", "_a", "e", "_b", "p", "f", "g", "U", "o", "d", "x"]
}
